{"file_contents":{"app/(tabs)/index.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { View, Text, StyleSheet, TouchableOpacity, ScrollView, Alert } from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { NEARBY_VESSELS, MAJOR_PORTS, getVesselIcon } from '@/utils/marineData';\nimport { fetchStormGlassWeather, getMockWeatherData } from '@/utils/weatherApi';\nimport { getNearbyTrackedVessels } from '@/utils/trackingService';\nimport * as Location from 'expo-location';\nimport LiveMap from '@/components/LiveMap';\n\nexport default function DashboardScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const [userLocation, setUserLocation] = useState<{ lat: number; lng: number } | null>(null);\n  const [locationPermission, setLocationPermission] = useState(false);\n  const [weatherData, setWeatherData] = useState(getMockWeatherData());\n  const [nearbyPorts, setNearbyPorts] = useState(MAJOR_PORTS.slice(0, 3));\n  const [trackedVessels, setTrackedVessels] = useState<any[]>([]);\n\n  useEffect(() => {\n    requestLocationPermission();\n  }, []);\n\n  useEffect(() => {\n    if (userLocation) {\n      loadWeatherForLocation();\n      updateNearbyPorts();\n      loadTrackedVessels();\n\n      // Auto-refresh every 10 seconds\n      const interval = setInterval(() => {\n        loadWeatherForLocation();\n        loadTrackedVessels();\n      }, 10000);\n\n      return () => clearInterval(interval);\n    }\n  }, [userLocation]);\n\n  const loadTrackedVessels = async () => {\n    if (!userLocation) return;\n    try {\n      const vessels = await getNearbyTrackedVessels(userLocation.lat, userLocation.lng, 10);\n      setTrackedVessels(vessels);\n    } catch (error) {\n      console.error('Error fetching tracked vessels:', error);\n      // Potentially show a user-friendly message here\n    }\n  };\n\n  const requestLocationPermission = async () => {\n    try {\n      const { status } = await Location.requestForegroundPermissionsAsync();\n      if (status === 'granted') {\n        setLocationPermission(true);\n        getCurrentLocation();\n        // Watch position for continuous updates\n        Location.watchPositionAsync(\n          {\n            accuracy: Location.Accuracy.High,\n            timeInterval: 10000,\n            distanceInterval: 50,\n          },\n          (location) => {\n            setUserLocation({\n              lat: location.coords.latitude,\n              lng: location.coords.longitude,\n            });\n          }\n        );\n      } else {\n        Alert.alert(\n          'Location Permission Required',\n          'This app needs location access to show nearby vessels and weather data.',\n          [{ text: 'OK' }]\n        );\n      }\n    } catch (error) {\n      console.error('Error requesting location permission:', error);\n    }\n  };\n\n  const getCurrentLocation = async () => {\n    try {\n      const location = await Location.getCurrentPositionAsync({\n        accuracy: Location.Accuracy.High,\n      });\n      setUserLocation({\n        lat: location.coords.latitude,\n        lng: location.coords.longitude,\n      });\n    } catch (error) {\n      console.error('Error getting location:', error);\n      // Handle cases where location can't be fetched even with permission\n      Alert.alert(\n        'Location Error',\n        'Could not fetch your current location. Please try again or check your device settings.',\n        [{ text: 'OK' }]\n      );\n    }\n  };\n\n  const loadWeatherForLocation = async () => {\n    if (!userLocation) return;\n\n    try {\n      const data = await fetchStormGlassWeather(userLocation.lat, userLocation.lng);\n      if (data) {\n        setWeatherData(data);\n      }\n      // Silently fail if no data - no alerts or console warnings\n    } catch (error) {\n      // Silently fail - no alerts or console errors\n    }\n  };\n\n  const updateNearbyPorts = () => {\n    if (!userLocation) return;\n    // Calculate distance to each port and sort by proximity\n    const portsWithDistance = MAJOR_PORTS.map(port => ({\n      ...port,\n      distance: calculateDistance(userLocation.lat, userLocation.lng, port.lat, port.lng)\n    }));\n    const nearby = portsWithDistance.sort((a, b) => a.distance - b.distance).slice(0, 3);\n    setNearbyPorts(nearby);\n  };\n\n  const calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number): number => {\n    const R = 6371; // Earth's radius in km\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = \n      Math.sin(dLat/2) * Math.sin(dLat/2) +\n      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n      Math.sin(dLon/2) * Math.sin(dLon/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    return R * c;\n  };\n\n  // Combine static vessels with real tracked vessels\n  const nearbyVessels = [\n    ...NEARBY_VESSELS,\n    ...trackedVessels.map(tv => ({\n      id: tv.userId, // Assuming userId is unique for each tracked vessel\n      name: tv.vesselInfo.vesselName,\n      type: tv.vesselInfo.vesselType,\n      distance: `${calculateDistance(userLocation?.lat || 0, userLocation?.lng || 0, tv.location.latitude, tv.location.longitude).toFixed(1)} km`,\n      status: tv.status,\n      speed: `${tv.location.speed?.toFixed(1) || '0'} kn`,\n      heading: `${tv.location.heading?.toFixed(0) || 'N/A'}¬∞`,\n      lastUpdate: new Date(tv.location.timestamp).toLocaleTimeString(),\n    }))\n  ];\n\n  if (!locationPermission) {\n    return (\n      <View style={[styles.container, { backgroundColor: colors.background }]}>\n        <View style={[styles.header, { backgroundColor: colors.primary }]}>\n          <Text style={styles.headerTitle}>‚öì MarineTrack</Text>\n          <Text style={styles.headerSubtitle}>Your Maritime Command Center</Text>\n        </View>\n        <View style={styles.permissionContainer}>\n          <Text style={styles.permissionIcon}>üìç</Text>\n          <Text style={[styles.permissionTitle, { color: colors.text }]}>\n            Location Permission Required\n          </Text>\n          <Text style={[styles.permissionText, { color: colors.icon }]}>\n            Please enable location access to use MarineTrack features like nearby vessels and weather data.\n          </Text>\n          <TouchableOpacity\n            style={[styles.permissionButton, { backgroundColor: colors.primary }]}\n            onPress={requestLocationPermission}\n          >\n            <Text style={styles.permissionButtonText}>Enable Location</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n    );\n  }\n\n  if (!userLocation) {\n    return (\n      <View style={[styles.container, { backgroundColor: colors.background }]}>\n        <View style={[styles.header, { backgroundColor: colors.primary }]}>\n          <Text style={styles.headerTitle}>‚öì MarineTrack</Text>\n          <Text style={styles.headerSubtitle}>Getting your location...</Text>\n        </View>\n        <View style={styles.loadingContainer}>\n          <Text style={styles.loadingIcon}>üåç</Text>\n          <Text style={[styles.loadingText, { color: colors.text }]}>\n            Fetching GPS coordinates...\n          </Text>\n        </View>\n      </View>\n    );\n  }\n\n  return (\n    <View style={[styles.container, { backgroundColor: colors.background }]}>\n      <View style={[styles.header, { backgroundColor: colors.primary }]}>\n        <Text style={styles.headerTitle}>‚öì MarineTrack</Text>\n        <Text style={styles.headerSubtitle}>Your Maritime Command Center</Text>\n        {userLocation && (\n          <View style={styles.locationBadge}>\n            <Text style={styles.locationText}>\n              üìç {userLocation.lat.toFixed(4)}¬∞N, {userLocation.lng.toFixed(4)}¬∞E\n            </Text>\n          </View>\n        )}\n      </View>\n\n      {/* Map Section with improved styling */}\n      <View style={[styles.weatherCard, { backgroundColor: colors.card }]}>\n        {/* LiveMap component should be configured to accept props like userLocation for centering */}\n        {/* Ensure LiveMap is correctly implemented to handle map display on mobile */}\n        <LiveMap userLocation={userLocation} /> \n      </View>\n\n      {/* Weather Bar with improved styling */}\n      <View style={[styles.weatherBar, { backgroundColor: colors.card }]}>\n        <View style={styles.weatherItem}>\n          <Text style={styles.weatherIcon}>üå°Ô∏è</Text>\n          <Text style={[styles.weatherValue, { color: colors.text }]}>{weatherData.temperature !== undefined ? weatherData.temperature.toFixed(1) : 'N/A'}¬∞C</Text>\n          <Text style={[styles.weatherLabel, { color: colors.icon }]}>Temp</Text>\n        </View>\n        <View style={styles.weatherItem}>\n          <Text style={styles.weatherIcon}>üí®</Text>\n          <Text style={[styles.weatherValue, { color: colors.text }]}>{weatherData.windSpeed !== undefined ? weatherData.windSpeed.toFixed(1) : 'N/A'} km/h</Text>\n          <Text style={[styles.weatherLabel, { color: colors.icon }]}>Wind</Text>\n        </View>\n        <View style={styles.weatherItem}>\n          <Text style={styles.weatherIcon}>üåä</Text>\n          <Text style={[styles.weatherValue, { color: colors.text }]}>{weatherData.waveHeight !== undefined ? weatherData.waveHeight.toFixed(1) : 'N/A'} m</Text>\n          <Text style={[styles.weatherLabel, { color: colors.icon }]}>Waves</Text>\n        </View>\n        <View style={styles.weatherItem}>\n          <Text style={styles.weatherIcon}>üëÅÔ∏è</Text>\n          <Text style={[styles.weatherValue, { color: colors.text }]}>{weatherData.visibility !== undefined ? weatherData.visibility.toFixed(1) : 'N/A'} km</Text>\n          <Text style={[styles.weatherLabel, { color: colors.icon }]}>Visibility</Text>\n        </View>\n      </View>\n\n      <ScrollView style={styles.vesselsContainer}>\n        <Text style={[styles.sectionTitle, { color: colors.text }]}>Nearby Vessels ({nearbyVessels.length})</Text>\n        {nearbyVessels.map((vessel) => (\n          <View\n            key={vessel.id}\n            style={[styles.vesselCard, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <View style={styles.vesselInfo}>\n              <Text style={[styles.vesselName, { color: colors.text }]}>\n                {getVesselIcon(vessel.type)} {vessel.name}\n              </Text>\n              <Text style={[styles.vesselId, { color: colors.icon }]}>{vessel.id} ‚Ä¢ {vessel.type}</Text>\n              <Text style={[styles.vesselDetail, { color: colors.icon }]}>\n                Speed: {vessel.speed} ‚Ä¢ Heading: {vessel.heading}\n              </Text>\n            </View>\n            <View style={styles.vesselStats}>\n              <Text style={[styles.vesselDistance, { color: colors.primary }]}>\n                {vessel.distance}\n              </Text>\n              <View\n                style={[\n                  styles.statusBadge,\n                  {\n                    backgroundColor:\n                      vessel.status === 'Active' ? colors.accent : \n                      vessel.status === 'Anchored' ? colors.secondary : colors.border,\n                  },\n                ]}\n              >\n                <Text style={[styles.statusText, { color: colors.text }]}>\n                  {vessel.status}\n                </Text>\n              </View>\n              <Text style={[styles.lastUpdate, { color: colors.icon }]}>\n                {vessel.lastUpdate}\n              </Text>\n            </View>\n          </View>\n        ))}\n\n        <Text style={[styles.sectionTitle, { color: colors.text, marginTop: 20 }]}>Nearby Ports</Text>\n        {nearbyPorts.map((port: any) => (\n          <View\n            key={port.id}\n            style={[styles.portCard, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.portName, { color: colors.text }]}>‚öì {port.name}</Text>\n            <Text style={[styles.portDetails, { color: colors.icon }]}>\n              {port.country} ‚Ä¢ {port.type}\n            </Text>\n            <View style={styles.portStats}>\n              <Text style={[styles.portVessels, { color: colors.primary }]}>\n                {port.vessels} vessels\n              </Text>\n              <Text style={[styles.portCoords, { color: colors.icon }]}>\n                {port.distance ? `${port.distance.toFixed(1)} km away` : `${port.lat.toFixed(4)}¬∞N, ${port.lng.toFixed(4)}¬∞E`}\n              </Text>\n            </View>\n          </View>\n        ))}\n      </ScrollView>\n\n      <View style={styles.actionButtons}>\n        <TouchableOpacity\n          style={[styles.actionButton, { backgroundColor: colors.danger }]}\n        >\n          <Text style={styles.actionIcon}>üö®</Text>\n          <Text style={styles.actionText}>SOS</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.actionButton, { backgroundColor: colors.primary }]}\n        >\n          <Text style={styles.actionIcon}>‚ö†Ô∏è</Text>\n          <Text style={styles.actionText}>Weather</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.actionButton, { backgroundColor: colors.secondary }]}\n        >\n          <Text style={styles.actionIcon}>üé£</Text>\n          <Text style={styles.actionText}>Fishing</Text>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    paddingTop: 50,\n    paddingBottom: 20,\n    paddingHorizontal: 20,\n    borderBottomLeftRadius: 20, // Rounded bottom corners for the header\n    borderBottomRightRadius: 20,\n    // Consider adding a subtle gradient here if desired and feasible with Colors object\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#fff',\n    // Adding icon to title\n  },\n  headerSubtitle: {\n    fontSize: 14,\n    color: '#fff',\n    opacity: 0.9,\n    marginTop: 4,\n  },\n  locationBadge: {\n    backgroundColor: 'rgba(255, 255, 255, 0.2)', // Semi-transparent white background\n    borderRadius: 10,\n    paddingVertical: 5,\n    paddingHorizontal: 12,\n    marginTop: 10,\n    alignSelf: 'flex-start', // Align to the start of the header\n  },\n  locationText: {\n    fontSize: 13,\n    color: '#fff',\n    fontWeight: '500',\n  },\n  permissionContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20,\n  },\n  permissionIcon: {\n    fontSize: 80,\n    marginBottom: 20,\n  },\n  permissionTitle: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    marginBottom: 12,\n    textAlign: 'center',\n  },\n  permissionText: {\n    fontSize: 16,\n    textAlign: 'center',\n    marginBottom: 30,\n  },\n  permissionButton: {\n    paddingVertical: 16,\n    paddingHorizontal: 32,\n    borderRadius: 12,\n  },\n  permissionButtonText: {\n    color: '#fff',\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingIcon: {\n    fontSize: 80,\n    marginBottom: 20,\n  },\n  loadingText: {\n    fontSize: 18,\n    fontWeight: '600',\n  },\n  // Updated Map Section Styling\n  mapSection: {\n    margin: 16,\n    // Additional styling for the map container if needed\n    borderRadius: 12,\n    overflow: 'hidden', // To ensure map respects border radius\n    // Consider adding shadow for depth\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 6,\n  },\n  coordinates: {\n    fontSize: 14,\n    marginTop: 8,\n    textAlign: 'center',\n  },\n  // Enhanced Weather Bar Styling\n  weatherBar: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    paddingVertical: 16,\n    marginHorizontal: 16,\n    borderRadius: 12,\n    marginBottom: 16,\n    // Consider gradient or shadow for better visual appeal\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 6,\n  },\n  weatherItem: {\n    alignItems: 'center',\n    paddingHorizontal: 8, // Added padding for better spacing\n  },\n  weatherIcon: {\n    fontSize: 24,\n    marginBottom: 4,\n  },\n  weatherValue: {\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  weatherLabel: {\n    fontSize: 12,\n    marginTop: 2,\n  },\n  vesselsContainer: {\n    flex: 1,\n    paddingHorizontal: 16,\n  },\n  sectionTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  // Enhanced Vessel Card Styling\n  vesselCard: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginBottom: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.08,\n    shadowRadius: 6,\n    elevation: 4,\n  },\n  vesselInfo: {\n    flex: 1,\n  },\n  vesselName: {\n    fontSize: 16,\n    fontWeight: '600',\n    marginBottom: 4,\n  },\n  vesselId: {\n    fontSize: 12,\n    marginTop: 2,\n  },\n  vesselDetail: {\n    fontSize: 11,\n    marginTop: 4,\n  },\n  vesselStats: {\n    alignItems: 'flex-end',\n  },\n  vesselDistance: {\n    fontSize: 14,\n    fontWeight: '600',\n    marginBottom: 4,\n  },\n  statusBadge: {\n    paddingHorizontal: 8,\n    paddingVertical: 4,\n    borderRadius: 6,\n    marginBottom: 4,\n  },\n  statusText: {\n    fontSize: 11,\n    fontWeight: '600',\n  },\n  lastUpdate: {\n    fontSize: 10,\n  },\n  // Enhanced Port Card Styling\n  portCard: {\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginBottom: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.08,\n    shadowRadius: 6,\n    elevation: 4,\n  },\n  portName: {\n    fontSize: 16,\n    fontWeight: '600',\n    marginBottom: 4,\n  },\n  portDetails: {\n    fontSize: 12,\n    marginBottom: 8,\n  },\n  portStats: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  portVessels: {\n    fontSize: 13,\n    fontWeight: '600',\n  },\n  portCoords: {\n    fontSize: 11,\n  },\n  actionButtons: {\n    flexDirection: 'row',\n    gap: 12,\n    paddingHorizontal: 16,\n    paddingBottom: 20,\n  },\n  actionButton: {\n    flex: 1,\n    paddingVertical: 16,\n    borderRadius: 12,\n    alignItems: 'center',\n  },\n  actionIcon: {\n    fontSize: 24,\n    marginBottom: 4,\n  },\n  actionText: {\n    color: '#fff',\n    fontSize: 12,\n    fontWeight: 'bold',\n  },\n  // Updated Weather Card Style\n  weatherCard: {\n    margin: 16,\n    padding: 24,\n    borderRadius: 20,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 6,\n  },\n  weatherHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n});","size_bytes":18576},"components/ui/IconSymbol.tsx":{"content":"// Fallback for using MaterialIcons on Android and web.\n\nimport MaterialIcons from '@expo/vector-icons/MaterialIcons';\nimport { SymbolWeight, SymbolViewProps } from 'expo-symbols';\nimport { ComponentProps } from 'react';\nimport { OpaqueColorValue, type StyleProp, type TextStyle } from 'react-native';\n\ntype IconMapping = Record<SymbolViewProps['name'], ComponentProps<typeof MaterialIcons>['name']>;\ntype IconSymbolName = keyof typeof MAPPING;\n\n/**\n * Add your SF Symbols to Material Icons mappings here.\n * - see Material Icons in the [Icons Directory](https://icons.expo.fyi).\n * - see SF Symbols in the [SF Symbols](https://developer.apple.com/sf-symbols/) app.\n */\nconst MAPPING = {\n  'house.fill': 'home',\n  'paperplane.fill': 'send',\n  'chevron.left.forwardslash.chevron.right': 'code',\n  'chevron.right': 'chevron-right',\n  'map.fill': 'map',\n  'cloud.fill': 'cloud',\n  'exclamationmark.triangle.fill': 'warning',\n  'bubble.left.and.bubble.right.fill': 'chat',\n  'anchor.fill': 'anchor',\n  'location.fill': 'location-on',\n  'gear': 'settings',\n} as IconMapping;\n\n/**\n * An icon component that uses native SF Symbols on iOS, and Material Icons on Android and web.\n * This ensures a consistent look across platforms, and optimal resource usage.\n * Icon `name`s are based on SF Symbols and require manual mapping to Material Icons.\n */\nexport function IconSymbol({\n  name,\n  size = 24,\n  color,\n  style,\n}: {\n  name: IconSymbolName;\n  size?: number;\n  color: string | OpaqueColorValue;\n  style?: StyleProp<TextStyle>;\n  weight?: SymbolWeight;\n}) {\n  return <MaterialIcons color={color} size={size} name={MAPPING[name]} style={style} />;\n}\n","size_bytes":1644},"components/ui/TabBarBackground.tsx":{"content":"// This is a shim for web and Android where the tab bar is generally opaque.\nexport default undefined;\n\nexport function useBottomTabOverflow() {\n  return 0;\n}\n","size_bytes":159},"components/ParallaxScrollView.tsx":{"content":"import type { PropsWithChildren, ReactElement } from 'react';\nimport { StyleSheet } from 'react-native';\nimport Animated, {\n  interpolate,\n  useAnimatedRef,\n  useAnimatedStyle,\n  useScrollViewOffset,\n} from 'react-native-reanimated';\n\nimport { ThemedView } from '@/components/ThemedView';\nimport { useBottomTabOverflow } from '@/components/ui/TabBarBackground';\nimport { useColorScheme } from '@/hooks/useColorScheme';\n\nconst HEADER_HEIGHT = 250;\n\ntype Props = PropsWithChildren<{\n  headerImage: ReactElement;\n  headerBackgroundColor: { dark: string; light: string };\n}>;\n\nexport default function ParallaxScrollView({\n  children,\n  headerImage,\n  headerBackgroundColor,\n}: Props) {\n  const colorScheme = useColorScheme() ?? 'light';\n  const scrollRef = useAnimatedRef<Animated.ScrollView>();\n  const scrollOffset = useScrollViewOffset(scrollRef);\n  const bottom = useBottomTabOverflow();\n  const headerAnimatedStyle = useAnimatedStyle(() => {\n    return {\n      transform: [\n        {\n          translateY: interpolate(\n            scrollOffset.value,\n            [-HEADER_HEIGHT, 0, HEADER_HEIGHT],\n            [-HEADER_HEIGHT / 2, 0, HEADER_HEIGHT * 0.75]\n          ),\n        },\n        {\n          scale: interpolate(scrollOffset.value, [-HEADER_HEIGHT, 0, HEADER_HEIGHT], [2, 1, 1]),\n        },\n      ],\n    };\n  });\n\n  return (\n    <ThemedView style={styles.container}>\n      <Animated.ScrollView\n        ref={scrollRef}\n        scrollEventThrottle={16}\n        scrollIndicatorInsets={{ bottom }}\n        contentContainerStyle={{ paddingBottom: bottom }}>\n        <Animated.View\n          style={[\n            styles.header,\n            { backgroundColor: headerBackgroundColor[colorScheme] },\n            headerAnimatedStyle,\n          ]}>\n          {headerImage}\n        </Animated.View>\n        <ThemedView style={styles.content}>{children}</ThemedView>\n      </Animated.ScrollView>\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    height: HEADER_HEIGHT,\n    overflow: 'hidden',\n  },\n  content: {\n    flex: 1,\n    padding: 32,\n    gap: 16,\n    overflow: 'hidden',\n  },\n});\n","size_bytes":2143},"components/Collapsible.tsx":{"content":"import { PropsWithChildren, useState } from 'react';\nimport { StyleSheet, TouchableOpacity } from 'react-native';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { ThemedView } from '@/components/ThemedView';\nimport { IconSymbol } from '@/components/ui/IconSymbol';\nimport { Colors } from '@/constants/Colors';\nimport { useColorScheme } from '@/hooks/useColorScheme';\n\nexport function Collapsible({ children, title }: PropsWithChildren & { title: string }) {\n  const [isOpen, setIsOpen] = useState(false);\n  const theme = useColorScheme() ?? 'light';\n\n  return (\n    <ThemedView>\n      <TouchableOpacity\n        style={styles.heading}\n        onPress={() => setIsOpen((value) => !value)}\n        activeOpacity={0.8}>\n        <IconSymbol\n          name=\"chevron.right\"\n          size={18}\n          weight=\"medium\"\n          color={theme === 'light' ? Colors.light.icon : Colors.dark.icon}\n          style={{ transform: [{ rotate: isOpen ? '90deg' : '0deg' }] }}\n        />\n\n        <ThemedText type=\"defaultSemiBold\">{title}</ThemedText>\n      </TouchableOpacity>\n      {isOpen && <ThemedView style={styles.content}>{children}</ThemedView>}\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  heading: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n  },\n  content: {\n    marginTop: 6,\n    marginLeft: 24,\n  },\n});\n","size_bytes":1358},"scripts/reset-project.js":{"content":"#!/usr/bin/env node\n\n/**\n * This script is used to reset the project to a blank state.\n * It deletes or moves the /app, /components, /hooks, /scripts, and /constants directories to /app-example based on user input and creates a new /app directory with an index.tsx and _layout.tsx file.\n * You can remove the `reset-project` script from package.json and safely delete this file after running it.\n */\n\nconst fs = require(\"fs\");\nconst path = require(\"path\");\nconst readline = require(\"readline\");\n\nconst root = process.cwd();\nconst oldDirs = [\"app\", \"components\", \"hooks\", \"constants\", \"scripts\"];\nconst exampleDir = \"app-example\";\nconst newAppDir = \"app\";\nconst exampleDirPath = path.join(root, exampleDir);\n\nconst indexContent = `import { Text, View } from \"react-native\";\n\nexport default function Index() {\n  return (\n    <View\n      style={{\n        flex: 1,\n        justifyContent: \"center\",\n        alignItems: \"center\",\n      }}\n    >\n      <Text>Edit app/index.tsx to edit this screen.</Text>\n    </View>\n  );\n}\n`;\n\nconst layoutContent = `import { Stack } from \"expo-router\";\n\nexport default function RootLayout() {\n  return <Stack />;\n}\n`;\n\nconst rl = readline.createInterface({\n  input: process.stdin,\n  output: process.stdout,\n});\n\nconst moveDirectories = async (userInput) => {\n  try {\n    if (userInput === \"y\") {\n      // Create the app-example directory\n      await fs.promises.mkdir(exampleDirPath, { recursive: true });\n      console.log(`üìÅ /${exampleDir} directory created.`);\n    }\n\n    // Move old directories to new app-example directory or delete them\n    for (const dir of oldDirs) {\n      const oldDirPath = path.join(root, dir);\n      if (fs.existsSync(oldDirPath)) {\n        if (userInput === \"y\") {\n          const newDirPath = path.join(root, exampleDir, dir);\n          await fs.promises.rename(oldDirPath, newDirPath);\n          console.log(`‚û°Ô∏è /${dir} moved to /${exampleDir}/${dir}.`);\n        } else {\n          await fs.promises.rm(oldDirPath, { recursive: true, force: true });\n          console.log(`‚ùå /${dir} deleted.`);\n        }\n      } else {\n        console.log(`‚û°Ô∏è /${dir} does not exist, skipping.`);\n      }\n    }\n\n    // Create new /app directory\n    const newAppDirPath = path.join(root, newAppDir);\n    await fs.promises.mkdir(newAppDirPath, { recursive: true });\n    console.log(\"\\nüìÅ New /app directory created.\");\n\n    // Create index.tsx\n    const indexPath = path.join(newAppDirPath, \"index.tsx\");\n    await fs.promises.writeFile(indexPath, indexContent);\n    console.log(\"üìÑ app/index.tsx created.\");\n\n    // Create _layout.tsx\n    const layoutPath = path.join(newAppDirPath, \"_layout.tsx\");\n    await fs.promises.writeFile(layoutPath, layoutContent);\n    console.log(\"üìÑ app/_layout.tsx created.\");\n\n    console.log(\"\\n‚úÖ Project reset complete. Next steps:\");\n    console.log(\n      `1. Run \\`npx expo start\\` to start a development server.\\n2. Edit app/index.tsx to edit the main screen.${\n        userInput === \"y\"\n          ? `\\n3. Delete the /${exampleDir} directory when you're done referencing it.`\n          : \"\"\n      }`\n    );\n  } catch (error) {\n    console.error(`‚ùå Error during script execution: ${error.message}`);\n  }\n};\n\nrl.question(\n  \"Do you want to move existing files to /app-example instead of deleting them? (Y/n): \",\n  (answer) => {\n    const userInput = answer.trim().toLowerCase() || \"y\";\n    if (userInput === \"y\" || userInput === \"n\") {\n      moveDirectories(userInput).finally(() => rl.close());\n    } else {\n      console.log(\"‚ùå Invalid input. Please enter 'Y' or 'N'.\");\n      rl.close();\n    }\n  }\n);\n","size_bytes":3608},"app/_layout.tsx":{"content":"import { DarkTheme, DefaultTheme, ThemeProvider } from '@react-navigation/native';\nimport { useFonts } from 'expo-font';\nimport { Stack } from 'expo-router';\nimport { StatusBar } from 'expo-status-bar';\n\nimport { useColorScheme } from '@/hooks/useColorScheme';\n\nexport default function RootLayout() {\n  const colorScheme = useColorScheme();\n  const [loaded] = useFonts({\n    SpaceMono: require('../assets/fonts/SpaceMono-Regular.ttf'),\n  });\n\n  if (!loaded) {\n    return null;\n  }\n\n  return (\n    <ThemeProvider value={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\n      <Stack>\n        <Stack.Screen name=\"onboarding\" options={{ headerShown: false }} />\n        <Stack.Screen name=\"auth\" options={{ headerShown: false }} />\n        <Stack.Screen name=\"(tabs)\" options={{ headerShown: false }} />\n        <Stack.Screen name=\"+not-found\" />\n      </Stack>\n      <StatusBar style=\"auto\" />\n    </ThemeProvider>\n  );\n}\n","size_bytes":922},"components/HelloWave.tsx":{"content":"import { useEffect } from 'react';\nimport { StyleSheet } from 'react-native';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withRepeat,\n  withSequence,\n  withTiming,\n} from 'react-native-reanimated';\n\nimport { ThemedText } from '@/components/ThemedText';\n\nexport function HelloWave() {\n  const rotationAnimation = useSharedValue(0);\n\n  useEffect(() => {\n    rotationAnimation.value = withRepeat(\n      withSequence(withTiming(25, { duration: 150 }), withTiming(0, { duration: 150 })),\n      4 // Run the animation 4 times\n    );\n  }, [rotationAnimation]);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ rotate: `${rotationAnimation.value}deg` }],\n  }));\n\n  return (\n    <Animated.View style={animatedStyle}>\n      <ThemedText style={styles.text}>üëã</ThemedText>\n    </Animated.View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  text: {\n    fontSize: 28,\n    lineHeight: 32,\n    marginTop: -6,\n  },\n});\n","size_bytes":939},"app/(tabs)/_layout.tsx":{"content":"import { Tabs } from 'expo-router';\nimport React from 'react';\nimport { Platform } from 'react-native';\n\nimport { HapticTab } from '@/components/HapticTab';\nimport { IconSymbol } from '@/components/ui/IconSymbol';\nimport TabBarBackground from '@/components/ui/TabBarBackground';\nimport { Colors } from '@/constants/Colors';\nimport { useColorScheme } from '@/hooks/useColorScheme';\n\nexport default function TabLayout() {\n  const colorScheme = useColorScheme();\n\n  return (\n    <Tabs\n      screenOptions={{\n        tabBarActiveTintColor: Colors[colorScheme ?? 'light'].tint,\n        headerShown: false,\n        tabBarButton: HapticTab,\n        tabBarBackground: TabBarBackground,\n        tabBarStyle: Platform.select({\n          ios: {\n            position: 'absolute',\n          },\n          default: {},\n        }),\n      }}>\n      <Tabs.Screen\n        name=\"index\"\n        options={{\n          title: 'Dashboard',\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"house.fill\" color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"weather\"\n        options={{\n          title: 'Weather',\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"cloud.fill\" color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"sos\"\n        options={{\n          title: 'SOS',\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"exclamationmark.triangle.fill\" color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"map\"\n        options={{\n          title: 'Map',\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"map.fill\" color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"chat\"\n        options={{\n          title: 'Chat',\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"bubble.left.and.bubble.right.fill\" color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"ports\"\n        options={{\n          title: 'Ports',\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"anchor.fill\" color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"tracker\"\n        options={{\n          title: 'Tracker',\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"location.fill\" color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"settings\"\n        options={{\n          title: 'Settings',\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"gear\" color={color} />,\n        }}\n      />\n    </Tabs>\n  );\n}","size_bytes":2490},"components/ExternalLink.tsx":{"content":"import { Href, Link } from 'expo-router';\nimport { openBrowserAsync } from 'expo-web-browser';\nimport { type ComponentProps } from 'react';\nimport { Platform } from 'react-native';\n\ntype Props = Omit<ComponentProps<typeof Link>, 'href'> & { href: Href & string };\n\nexport function ExternalLink({ href, ...rest }: Props) {\n  return (\n    <Link\n      target=\"_blank\"\n      {...rest}\n      href={href}\n      onPress={async (event) => {\n        if (Platform.OS !== 'web') {\n          // Prevent the default behavior of linking to the default browser on native.\n          event.preventDefault();\n          // Open the link in an in-app browser.\n          await openBrowserAsync(href);\n        }\n      }}\n    />\n  );\n}\n","size_bytes":713},"eslint.config.js":{"content":"// https://docs.expo.dev/guides/using-eslint/\nconst { defineConfig } = require('eslint/config');\nconst expoConfig = require('eslint-config-expo/flat');\n\nmodule.exports = defineConfig([\n  expoConfig,\n  {\n    ignores: ['dist/*'],\n  },\n]);\n","size_bytes":237},"components/ThemedText.tsx":{"content":"import { StyleSheet, Text, type TextProps } from 'react-native';\n\nimport { useThemeColor } from '@/hooks/useThemeColor';\n\nexport type ThemedTextProps = TextProps & {\n  lightColor?: string;\n  darkColor?: string;\n  type?: 'default' | 'title' | 'defaultSemiBold' | 'subtitle' | 'link';\n};\n\nexport function ThemedText({\n  style,\n  lightColor,\n  darkColor,\n  type = 'default',\n  ...rest\n}: ThemedTextProps) {\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\n\n  return (\n    <Text\n      style={[\n        { color },\n        type === 'default' ? styles.default : undefined,\n        type === 'title' ? styles.title : undefined,\n        type === 'defaultSemiBold' ? styles.defaultSemiBold : undefined,\n        type === 'subtitle' ? styles.subtitle : undefined,\n        type === 'link' ? styles.link : undefined,\n        style,\n      ]}\n      {...rest}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  default: {\n    fontSize: 16,\n    lineHeight: 24,\n  },\n  defaultSemiBold: {\n    fontSize: 16,\n    lineHeight: 24,\n    fontWeight: '600',\n  },\n  title: {\n    fontSize: 32,\n    fontWeight: 'bold',\n    lineHeight: 32,\n  },\n  subtitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n  },\n  link: {\n    lineHeight: 30,\n    fontSize: 16,\n    color: '#0a7ea4',\n  },\n});\n","size_bytes":1283},"constants/Colors.ts":{"content":"const tintColorLight = '#0891b2';\nconst tintColorDark = '#06b6d4';\n\nexport const Colors = {\n  light: {\n    text: '#1f2937',\n    background: '#f9fafb',\n    tint: tintColorLight,\n    icon: '#6b7280',\n    tabIconDefault: '#9ca3af',\n    tabIconSelected: tintColorLight,\n    primary: '#0891b2',\n    secondary: '#0e7490',\n    accent: '#06b6d4',\n    success: '#059669',\n    danger: '#dc2626',\n    warning: '#f59e0b',\n    card: '#ffffff',\n    border: '#e5e7eb',\n  },\n  dark: {\n    text: '#f3f4f6',\n    background: '#111827',\n    tint: tintColorDark,\n    icon: '#9ca3af',\n    tabIconDefault: '#6b7280',\n    tabIconSelected: tintColorDark,\n    primary: '#06b6d4',\n    secondary: '#0891b2',\n    accent: '#22d3ee',\n    success: '#10b981',\n    danger: '#f87171',\n    warning: '#fbbf24',\n    card: '#1f2937',\n    border: '#374151',\n  },\n};","size_bytes":825},"app/(tabs)/explore.tsx":{"content":"import { Image } from 'expo-image';\nimport { Platform, StyleSheet } from 'react-native';\n\nimport { Collapsible } from '@/components/Collapsible';\nimport { ExternalLink } from '@/components/ExternalLink';\nimport ParallaxScrollView from '@/components/ParallaxScrollView';\nimport { ThemedText } from '@/components/ThemedText';\nimport { ThemedView } from '@/components/ThemedView';\nimport { IconSymbol } from '@/components/ui/IconSymbol';\n\nexport default function TabTwoScreen() {\n  return (\n    <ParallaxScrollView\n      headerBackgroundColor={{ light: '#D0D0D0', dark: '#353636' }}\n      headerImage={\n        <IconSymbol\n          size={310}\n          color=\"#808080\"\n          name=\"chevron.left.forwardslash.chevron.right\"\n          style={styles.headerImage}\n        />\n      }>\n      <ThemedView style={styles.titleContainer}>\n        <ThemedText type=\"title\">Explore</ThemedText>\n      </ThemedView>\n      <ThemedText>This app includes example code to help you get started.</ThemedText>\n      <Collapsible title=\"File-based routing\">\n        <ThemedText>\n          This app has two screens:{' '}\n          <ThemedText type=\"defaultSemiBold\">app/(tabs)/index.tsx</ThemedText> and{' '}\n          <ThemedText type=\"defaultSemiBold\">app/(tabs)/explore.tsx</ThemedText>\n        </ThemedText>\n        <ThemedText>\n          The layout file in <ThemedText type=\"defaultSemiBold\">app/(tabs)/_layout.tsx</ThemedText>{' '}\n          sets up the tab navigator.\n        </ThemedText>\n        <ExternalLink href=\"https://docs.expo.dev/router/introduction\">\n          <ThemedText type=\"link\">Learn more</ThemedText>\n        </ExternalLink>\n      </Collapsible>\n      <Collapsible title=\"Android, iOS, and web support\">\n        <ThemedText>\n          You can open this project on Android, iOS, and the web. To open the web version, press{' '}\n          <ThemedText type=\"defaultSemiBold\">w</ThemedText> in the terminal running this project.\n        </ThemedText>\n      </Collapsible>\n      <Collapsible title=\"Images\">\n        <ThemedText>\n          For static images, you can use the <ThemedText type=\"defaultSemiBold\">@2x</ThemedText> and{' '}\n          <ThemedText type=\"defaultSemiBold\">@3x</ThemedText> suffixes to provide files for\n          different screen densities\n        </ThemedText>\n        <Image source={require('@/assets/images/react-logo.png')} style={{ alignSelf: 'center' }} />\n        <ExternalLink href=\"https://reactnative.dev/docs/images\">\n          <ThemedText type=\"link\">Learn more</ThemedText>\n        </ExternalLink>\n      </Collapsible>\n      <Collapsible title=\"Custom fonts\">\n        <ThemedText>\n          Open <ThemedText type=\"defaultSemiBold\">app/_layout.tsx</ThemedText> to see how to load{' '}\n          <ThemedText style={{ fontFamily: 'SpaceMono' }}>\n            custom fonts such as this one.\n          </ThemedText>\n        </ThemedText>\n        <ExternalLink href=\"https://docs.expo.dev/versions/latest/sdk/font\">\n          <ThemedText type=\"link\">Learn more</ThemedText>\n        </ExternalLink>\n      </Collapsible>\n      <Collapsible title=\"Light and dark mode components\">\n        <ThemedText>\n          This template has light and dark mode support. The{' '}\n          <ThemedText type=\"defaultSemiBold\">useColorScheme()</ThemedText> hook lets you inspect\n          what the user&apos;s current color scheme is, and so you can adjust UI colors accordingly.\n        </ThemedText>\n        <ExternalLink href=\"https://docs.expo.dev/develop/user-interface/color-themes/\">\n          <ThemedText type=\"link\">Learn more</ThemedText>\n        </ExternalLink>\n      </Collapsible>\n      <Collapsible title=\"Animations\">\n        <ThemedText>\n          This template includes an example of an animated component. The{' '}\n          <ThemedText type=\"defaultSemiBold\">components/HelloWave.tsx</ThemedText> component uses\n          the powerful <ThemedText type=\"defaultSemiBold\">react-native-reanimated</ThemedText>{' '}\n          library to create a waving hand animation.\n        </ThemedText>\n        {Platform.select({\n          ios: (\n            <ThemedText>\n              The <ThemedText type=\"defaultSemiBold\">components/ParallaxScrollView.tsx</ThemedText>{' '}\n              component provides a parallax effect for the header image.\n            </ThemedText>\n          ),\n        })}\n      </Collapsible>\n    </ParallaxScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  headerImage: {\n    color: '#808080',\n    bottom: -90,\n    left: -35,\n    position: 'absolute',\n  },\n  titleContainer: {\n    flexDirection: 'row',\n    gap: 8,\n  },\n});\n","size_bytes":4576},"components/ui/IconSymbol.ios.tsx":{"content":"import { SymbolView, SymbolViewProps, SymbolWeight } from 'expo-symbols';\nimport { StyleProp, ViewStyle } from 'react-native';\n\nexport function IconSymbol({\n  name,\n  size = 24,\n  color,\n  style,\n  weight = 'regular',\n}: {\n  name: SymbolViewProps['name'];\n  size?: number;\n  color: string;\n  style?: StyleProp<ViewStyle>;\n  weight?: SymbolWeight;\n}) {\n  return (\n    <SymbolView\n      weight={weight}\n      tintColor={color}\n      resizeMode=\"scaleAspectFit\"\n      name={name}\n      style={[\n        {\n          width: size,\n          height: size,\n        },\n        style,\n      ]}\n    />\n  );\n}\n","size_bytes":598},"components/ThemedView.tsx":{"content":"import { View, type ViewProps } from 'react-native';\n\nimport { useThemeColor } from '@/hooks/useThemeColor';\n\nexport type ThemedViewProps = ViewProps & {\n  lightColor?: string;\n  darkColor?: string;\n};\n\nexport function ThemedView({ style, lightColor, darkColor, ...otherProps }: ThemedViewProps) {\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\n\n  return <View style={[{ backgroundColor }, style]} {...otherProps} />;\n}\n","size_bytes":468},"components/HapticTab.tsx":{"content":"import { BottomTabBarButtonProps } from '@react-navigation/bottom-tabs';\nimport { PlatformPressable } from '@react-navigation/elements';\nimport * as Haptics from 'expo-haptics';\n\nexport function HapticTab(props: BottomTabBarButtonProps) {\n  return (\n    <PlatformPressable\n      {...props}\n      onPressIn={(ev) => {\n        if (process.env.EXPO_OS === 'ios') {\n          // Add a soft haptic feedback when pressing down on the tabs.\n          Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n        }\n        props.onPressIn?.(ev);\n      }}\n    />\n  );\n}\n","size_bytes":564},"hooks/useThemeColor.ts":{"content":"/**\n * Learn more about light and dark modes:\n * https://docs.expo.dev/guides/color-schemes/\n */\n\nimport { Colors } from '@/constants/Colors';\nimport { useColorScheme } from '@/hooks/useColorScheme';\n\nexport function useThemeColor(\n  props: { light?: string; dark?: string },\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\n) {\n  const theme = useColorScheme() ?? 'light';\n  const colorFromProps = props[theme];\n\n  if (colorFromProps) {\n    return colorFromProps;\n  } else {\n    return Colors[theme][colorName];\n  }\n}\n","size_bytes":536},"app/+not-found.tsx":{"content":"import { Link, Stack } from 'expo-router';\nimport { StyleSheet } from 'react-native';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { ThemedView } from '@/components/ThemedView';\n\nexport default function NotFoundScreen() {\n  return (\n    <>\n      <Stack.Screen options={{ title: 'Oops!' }} />\n      <ThemedView style={styles.container}>\n        <ThemedText type=\"title\">This screen does not exist.</ThemedText>\n        <Link href=\"/\" style={styles.link}>\n          <ThemedText type=\"link\">Go to home screen!</ThemedText>\n        </Link>\n      </ThemedView>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 20,\n  },\n  link: {\n    marginTop: 15,\n    paddingVertical: 15,\n  },\n});\n","size_bytes":793},"hooks/useColorScheme.web.ts":{"content":"import { useEffect, useState } from 'react';\nimport { useColorScheme as useRNColorScheme } from 'react-native';\n\n/**\n * To support static rendering, this value needs to be re-calculated on the client side for web\n */\nexport function useColorScheme() {\n  const [hasHydrated, setHasHydrated] = useState(false);\n\n  useEffect(() => {\n    setHasHydrated(true);\n  }, []);\n\n  const colorScheme = useRNColorScheme();\n\n  if (hasHydrated) {\n    return colorScheme;\n  }\n\n  return 'light';\n}\n","size_bytes":480},"components/ui/TabBarBackground.ios.tsx":{"content":"import { useBottomTabBarHeight } from '@react-navigation/bottom-tabs';\nimport { BlurView } from 'expo-blur';\nimport { StyleSheet } from 'react-native';\n\nexport default function BlurTabBarBackground() {\n  return (\n    <BlurView\n      // System chrome material automatically adapts to the system's theme\n      // and matches the native tab bar appearance on iOS.\n      tint=\"systemChromeMaterial\"\n      intensity={100}\n      style={StyleSheet.absoluteFill}\n    />\n  );\n}\n\nexport function useBottomTabOverflow() {\n  return useBottomTabBarHeight();\n}\n","size_bytes":547},"hooks/useColorScheme.ts":{"content":"export { useColorScheme } from 'react-native';\n","size_bytes":47},"README.md":{"content":"# MarineTrack - Marine Safety & Tracking App üö¢\n\nThis is an [Expo](https://expo.dev) project created with [`create-expo-app`](https://www.npmjs.com/package/create-expo-app).\n\n## üõ∞Ô∏è AIS Location Tracking Feature\n\nMarineTrack now includes a powerful AIS (Automatic Identification System) tracker that turns your phone into a marine beacon:\n\n### Features:\n- **Real-time GPS Tracking**: Broadcasts your vessel's position every 5 seconds\n- **AIS Beacon**: Your phone acts as an AIS transmitter for nearby vessels\n- **Vessel Information**: Store complete vessel details (Name, ID, Type, MMSI, IMO)\n- **Backend Integration**: All tracking data is sent to backend for storage and retrieval\n- **Nearby Vessels**: See other MarineTrack users within 10km radius\n- **Status Updates**: Set your vessel status (Active, Idle, Anchored)\n\n### How to Use:\n1. Go to the **Tracker** tab\n2. Fill in your vessel information (Name and ID are required)\n3. Enable the tracking switch\n4. Your location will be broadcast to nearby vessels\n5. View other tracked vessels in the dashboard\n\n### Backend Integration:\nThe app uses `utils/trackingService.ts` which stores data locally. To connect to your backend:\n\n1. Replace the mock API call in `sendTrackingData()` with your actual endpoint:\n```typescript\nconst response = await fetch('https://your-backend-api.com/api/tracking', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify(data)\n});\n```\n\n2. Update `getNearbyTrackedVessels()` to fetch from your backend API\n\n## Get started\n\n1. Install dependencies\n\n   ```bash\n   npm install\n   ```\n\n2. Start the app\n\n   ```bash\n   npx expo start\n   ```\n\nIn the output, you'll find options to open the app in a\n\n- [development build](https://docs.expo.dev/develop/development-builds/introduction/)\n- [Android emulator](https://docs.expo.dev/workflow/android-studio-emulator/)\n- [iOS simulator](https://docs.expo.dev/workflow/ios-simulator/)\n- [Expo Go](https://expo.dev/go), a limited sandbox for trying out app development with Expo\n\nYou can start developing by editing the files inside the **app** directory. This project uses [file-based routing](https://docs.expo.dev/router/introduction).\n\n## Get a fresh project\n\nWhen you're ready, run:\n\n```bash\nnpm run reset-project\n```\n\nThis command will move the starter code to the **app-example** directory and create a blank **app** directory where you can start developing.\n\n## Learn more\n\nTo learn more about developing your project with Expo, look at the following resources:\n\n- [Expo documentation](https://docs.expo.dev/): Learn fundamentals, or go into advanced topics with our [guides](https://docs.expo.dev/guides).\n- [Learn Expo tutorial](https://docs.expo.dev/tutorial/introduction/): Follow a step-by-step tutorial where you'll create a project that runs on Android, iOS, and the web.\n\n## Join the community\n\nJoin our community of developers creating universal apps.\n\n- [Expo on GitHub](https://github.com/expo/expo): View our open source platform and contribute.\n- [Discord community](https://chat.expo.dev): Chat with Expo users and ask questions.\n","size_bytes":3117},"app/(tabs)/settings.tsx":{"content":"\nimport React, { useEffect, useState } from 'react';\nimport { View, Text, StyleSheet, ScrollView, TouchableOpacity, Switch, Alert } from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { getCurrentUser, signOut } from '@/utils/auth';\nimport { getUserFromDatabase } from '@/utils/database';\nimport { useRouter } from 'expo-router';\n\nexport default function SettingsScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const router = useRouter();\n  const [notificationsEnabled, setNotificationsEnabled] = useState(true);\n  const [locationEnabled, setLocationEnabled] = useState(true);\n  const [userData, setUserData] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadUserData();\n  }, []);\n\n  const loadUserData = async () => {\n    try {\n      const currentUser = await getCurrentUser();\n      if (currentUser) {\n        const dbUser = await getUserFromDatabase(currentUser.id);\n        setUserData(dbUser);\n      }\n      setLoading(false);\n    } catch (error) {\n      console.error('Error loading user data:', error);\n      setLoading(false);\n    }\n  };\n\n  const handleLogout = async () => {\n    Alert.alert(\n      'Logout',\n      'Are you sure you want to logout?',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Logout',\n          style: 'destructive',\n          onPress: async () => {\n            await signOut();\n            router.replace('/auth/login');\n          },\n        },\n      ]\n    );\n  };\n\n  if (loading) {\n    return (\n      <View style={[styles.container, { backgroundColor: colors.background }]}>\n        <Text style={[styles.loadingText, { color: colors.text }]}>Loading...</Text>\n      </View>\n    );\n  }\n\n  const vesselInfo = userData?.vesselInfo;\n  const contactInfo = userData?.contactInfo;\n\n  return (\n    <ScrollView style={[styles.container, { backgroundColor: colors.background }]}>\n      <View style={[styles.header, { backgroundColor: colors.primary }]}>\n        <Text style={styles.headerTitle}>Settings & Profile</Text>\n        <Text style={styles.headerSubtitle}>Manage your account</Text>\n      </View>\n\n      <View style={[styles.profileSection, { backgroundColor: colors.card }]}>\n        <View style={styles.profileAvatar}>\n          <Text style={styles.avatarIcon}>üë§</Text>\n        </View>\n        <Text style={[styles.profileName, { color: colors.text }]}>\n          {userData?.name || 'User'}\n        </Text>\n        <Text style={[styles.profileEmail, { color: colors.icon }]}>\n          {userData?.email || 'No email provided'}\n        </Text>\n        {vesselInfo && (\n          <Text style={[styles.vesselInfo, { color: colors.icon }]}>\n            üö¢ {vesselInfo.vesselName} ‚Ä¢ {vesselInfo.registrationNumber || 'No ID'}\n          </Text>\n        )}\n      </View>\n\n      {vesselInfo && (\n        <View style={styles.section}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>Vessel Information</Text>\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Vessel Name</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {vesselInfo.vesselName}\n            </Text>\n          </View>\n\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Registration Number</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {vesselInfo.registrationNumber || 'N/A'}\n            </Text>\n          </View>\n\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Vessel Type</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {vesselInfo.vesselType}\n            </Text>\n          </View>\n\n          {vesselInfo.imoNumber && (\n            <View\n              style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n            >\n              <Text style={[styles.settingLabel, { color: colors.text }]}>IMO Number</Text>\n              <Text style={[styles.settingValue, { color: colors.icon }]}>\n                {vesselInfo.imoNumber}\n              </Text>\n            </View>\n          )}\n\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Call Sign</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {vesselInfo.callSign}\n            </Text>\n          </View>\n\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Home Port</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {vesselInfo.homePort}\n            </Text>\n          </View>\n\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Dimensions</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              L: {vesselInfo.vesselLength}m √ó B: {vesselInfo.vesselBeam}m\n            </Text>\n          </View>\n\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Gross Tonnage</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {vesselInfo.grossTonnage} GT\n            </Text>\n          </View>\n        </View>\n      )}\n\n      {contactInfo && (\n        <View style={styles.section}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>Contact Information</Text>\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Phone Number</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {contactInfo.phone}\n            </Text>\n          </View>\n\n          {contactInfo.email && (\n            <View\n              style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n            >\n              <Text style={[styles.settingLabel, { color: colors.text }]}>Email</Text>\n              <Text style={[styles.settingValue, { color: colors.icon }]}>\n                {contactInfo.email}\n              </Text>\n            </View>\n          )}\n\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Emergency Contact</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {contactInfo.emergencyContact}\n            </Text>\n          </View>\n\n          <View\n            style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <Text style={[styles.settingLabel, { color: colors.text }]}>Emergency Phone</Text>\n            <Text style={[styles.settingValue, { color: colors.icon }]}>\n              {contactInfo.emergencyPhone}\n            </Text>\n          </View>\n        </View>\n      )}\n\n      <View style={styles.section}>\n        <Text style={[styles.sectionTitle, { color: colors.text }]}>Preferences</Text>\n        <View\n          style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n        >\n          <Text style={[styles.settingLabel, { color: colors.text }]}>\n            Push Notifications\n          </Text>\n          <Switch\n            value={notificationsEnabled}\n            onValueChange={setNotificationsEnabled}\n            trackColor={{ false: colors.border, true: colors.primary }}\n          />\n        </View>\n\n        <View\n          style={[styles.settingItem, { backgroundColor: colors.card, borderColor: colors.border }]}\n        >\n          <Text style={[styles.settingLabel, { color: colors.text }]}>\n            Location Services\n          </Text>\n          <Switch\n            value={locationEnabled}\n            onValueChange={setLocationEnabled}\n            trackColor={{ false: colors.border, true: colors.primary }}\n          />\n        </View>\n      </View>\n\n      <View style={styles.section}>\n        <Text style={[styles.sectionTitle, { color: colors.text }]}>\n          Sustainable Fishing Tips\n        </Text>\n        <View style={[styles.tipsCard, { backgroundColor: colors.card, borderColor: colors.border }]}>\n          <Text style={[styles.tipsTitle, { color: colors.primary }]}>\n            üåä Protect Our Oceans\n          </Text>\n          <Text style={[styles.tipsText, { color: colors.text }]}>\n            ‚Ä¢ Respect minimum size limits for fish{'\\n'}\n            ‚Ä¢ Avoid overfishing in breeding seasons{'\\n'}\n            ‚Ä¢ Use eco-friendly fishing gear{'\\n'}\n            ‚Ä¢ Report illegal fishing activities{'\\n'}\n            ‚Ä¢ Reduce plastic waste at sea\n          </Text>\n        </View>\n      </View>\n\n      <TouchableOpacity\n        style={[styles.logoutButton, { backgroundColor: colors.danger }]}\n        onPress={handleLogout}\n      >\n        <Text style={styles.logoutText}>Logout</Text>\n      </TouchableOpacity>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingText: {\n    textAlign: 'center',\n    marginTop: 100,\n    fontSize: 16,\n  },\n  header: {\n    paddingTop: 50,\n    paddingBottom: 20,\n    paddingHorizontal: 20,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#fff',\n  },\n  headerSubtitle: {\n    fontSize: 14,\n    color: '#fff',\n    opacity: 0.9,\n    marginTop: 4,\n  },\n  profileSection: {\n    padding: 24,\n    alignItems: 'center',\n    marginBottom: 16,\n  },\n  profileAvatar: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    backgroundColor: '#0077BE',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: 12,\n  },\n  avatarIcon: {\n    fontSize: 40,\n  },\n  profileName: {\n    fontSize: 22,\n    fontWeight: 'bold',\n    marginBottom: 4,\n  },\n  profileEmail: {\n    fontSize: 14,\n    marginBottom: 8,\n  },\n  vesselInfo: {\n    fontSize: 14,\n  },\n  section: {\n    paddingHorizontal: 16,\n    marginBottom: 24,\n  },\n  sectionTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  settingItem: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginBottom: 8,\n  },\n  settingLabel: {\n    fontSize: 15,\n    flex: 1,\n  },\n  settingValue: {\n    fontSize: 15,\n    flex: 1,\n    textAlign: 'right',\n  },\n  tipsCard: {\n    padding: 20,\n    borderRadius: 12,\n    borderWidth: 1,\n  },\n  tipsTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  tipsText: {\n    fontSize: 14,\n    lineHeight: 24,\n  },\n  logoutButton: {\n    marginHorizontal: 16,\n    marginBottom: 32,\n    padding: 16,\n    borderRadius: 12,\n    alignItems: 'center',\n  },\n  logoutText: {\n    color: '#fff',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":11843},"components/PortMap.tsx":{"content":"\nimport React, { useState, useEffect } from 'react';\nimport { View, Text, StyleSheet, ScrollView, TouchableOpacity } from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { MAJOR_PORTS } from '@/utils/marineData';\nimport { fetchPortVesselData, getTotalVesselsCount, PortVesselData } from '@/utils/vesselScraper';\n\nexport default function PortMap() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const [selectedPort, setSelectedPort] = useState<string | null>(null);\n  const [portData, setPortData] = useState<PortVesselData | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  const loadPortData = async (portCode: string) => {\n    setLoading(true);\n    const data = await fetchPortVesselData(portCode);\n    setPortData(data);\n    setLoading(false);\n  };\n\n  const handlePortPress = (portId: string) => {\n    if (selectedPort === portId) {\n      setSelectedPort(null);\n      setPortData(null);\n    } else {\n      setSelectedPort(portId);\n      loadPortData(portId);\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <Text style={[styles.title, { color: colors.text }]}>Malaysian Ports</Text>\n      <Text style={[styles.subtitle, { color: colors.icon }]}>Real-time vessel tracking from VesselFinder</Text>\n      \n      <ScrollView style={styles.portsList}>\n        {MAJOR_PORTS.map((port) => (\n          <View key={port.id}>\n            <TouchableOpacity\n              style={[\n                styles.portItem, \n                { \n                  backgroundColor: colors.card, \n                  borderColor: selectedPort === port.id ? colors.primary : colors.border,\n                  borderWidth: selectedPort === port.id ? 2 : 1\n                }\n              ]}\n              onPress={() => handlePortPress(port.id)}\n            >\n              <View style={styles.portHeader}>\n                <Text style={[styles.portName, { color: colors.text }]}>‚öì {port.name}</Text>\n                <View style={[styles.vesselCount, { backgroundColor: colors.primary }]}>\n                  <Text style={styles.vesselCountText}>{port.vessels}</Text>\n                </View>\n              </View>\n              \n              <View style={styles.portInfo}>\n                <Text style={[styles.portDetail, { color: colors.icon }]}>\n                  üìç {port.lat.toFixed(4)}¬∞N, {port.lng.toFixed(4)}¬∞E\n                </Text>\n                <Text style={[styles.portDetail, { color: colors.icon }]}>\n                  üè¢ {port.type}\n                </Text>\n                <Text style={[styles.portDetail, { color: colors.icon }]}>\n                  üåç {port.country}\n                </Text>\n              </View>\n              \n              <View style={styles.portFooter}>\n                <Text style={[styles.footerText, { color: colors.accent }]}>\n                  {selectedPort === port.id ? 'Hide Details ‚ñ≤' : 'View Details ‚Üí'}\n                </Text>\n              </View>\n            </TouchableOpacity>\n\n            {selectedPort === port.id && portData && (\n              <View style={[styles.vesselDetails, { backgroundColor: colors.background }]}>\n                <View style={styles.vesselSection}>\n                  <Text style={[styles.vesselSectionTitle, { color: colors.primary }]}>\n                    üü¢ In Port ({portData.inPort.length})\n                  </Text>\n                  {portData.inPort.map((vessel, idx) => (\n                    <View key={idx} style={[styles.vesselItem, { backgroundColor: colors.card }]}>\n                      <Text style={[styles.vesselName, { color: colors.text }]}>{vessel.name}</Text>\n                      <Text style={[styles.vesselInfo, { color: colors.icon }]}>\n                        {vessel.type} ‚Ä¢ {vessel.flag} ‚Ä¢ IMO: {vessel.imo}\n                      </Text>\n                    </View>\n                  ))}\n                </View>\n\n                <View style={styles.vesselSection}>\n                  <Text style={[styles.vesselSectionTitle, { color: colors.accent }]}>\n                    üì• Expected ({portData.expected.length})\n                  </Text>\n                  {portData.expected.map((vessel, idx) => (\n                    <View key={idx} style={[styles.vesselItem, { backgroundColor: colors.card }]}>\n                      <Text style={[styles.vesselName, { color: colors.text }]}>{vessel.name}</Text>\n                      <Text style={[styles.vesselInfo, { color: colors.icon }]}>\n                        ETA: {new Date(vessel.eta).toLocaleDateString('en-MY')}\n                      </Text>\n                    </View>\n                  ))}\n                </View>\n\n                <View style={styles.vesselSection}>\n                  <Text style={[styles.vesselSectionTitle, { color: colors.secondary }]}>\n                    üö¢ Arrivals ({portData.arrivals.length}) ‚Ä¢ Departures ({portData.departures.length})\n                  </Text>\n                </View>\n              </View>\n            )}\n          </View>\n        ))}\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 16,\n  },\n  title: {\n    fontSize: 22,\n    fontWeight: 'bold',\n    marginBottom: 4,\n  },\n  subtitle: {\n    fontSize: 14,\n    marginBottom: 16,\n  },\n  portsList: {\n    flex: 1,\n  },\n  portItem: {\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginBottom: 12,\n  },\n  portHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 12,\n  },\n  portName: {\n    fontSize: 18,\n    fontWeight: '600',\n    flex: 1,\n  },\n  vesselCount: {\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 20,\n  },\n  vesselCountText: {\n    color: '#fff',\n    fontSize: 14,\n    fontWeight: 'bold',\n  },\n  portInfo: {\n    gap: 6,\n    marginBottom: 12,\n  },\n  portDetail: {\n    fontSize: 13,\n    lineHeight: 20,\n  },\n  portFooter: {\n    borderTopWidth: 1,\n    borderTopColor: '#E0E0E0',\n    paddingTop: 12,\n    marginTop: 4,\n  },\n  footerText: {\n    fontSize: 13,\n    fontWeight: '600',\n  },\n  vesselDetails: {\n    padding: 12,\n    marginHorizontal: 16,\n    marginBottom: 12,\n    borderRadius: 8,\n  },\n  vesselSection: {\n    marginBottom: 16,\n  },\n  vesselSectionTitle: {\n    fontSize: 15,\n    fontWeight: 'bold',\n    marginBottom: 8,\n  },\n  vesselItem: {\n    padding: 10,\n    borderRadius: 8,\n    marginBottom: 6,\n  },\n  vesselName: {\n    fontSize: 14,\n    fontWeight: '600',\n    marginBottom: 2,\n  },\n  vesselInfo: {\n    fontSize: 12,\n  },\n});\n","size_bytes":6613},"app/auth/vessel-registration.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  KeyboardAvoidingView,\n  Platform,\n  Alert,\n} from 'react-native';\nimport { useRouter } from 'expo-router';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { storeUser } from '@/utils/auth';\nimport { saveUserToDatabase } from '@/utils/database';\n\nexport default function VesselRegistrationScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const router = useRouter();\n  const [loading, setLoading] = useState(false);\n\n  const [formData, setFormData] = useState({\n    vesselName: '',\n    vesselType: '',\n    registrationNumber: '',\n    imoNumber: '',\n    callSign: '',\n    captainName: '',\n    phoneNumber: '',\n    email: '',\n    homePort: '',\n    vesselLength: '',\n    vesselBeam: '',\n    grossTonnage: '',\n    emergencyContact: '',\n    emergencyPhone: '',\n  });\n\n  const vesselTypes = [\n    'Fishing Vessel',\n    'Cargo Ship',\n    'Tanker',\n    'Passenger Ship',\n    'Tug Boat',\n    'Yacht',\n    'Ferry',\n    'Other',\n  ];\n\n  const updateField = (field: string, value: string) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const validateForm = () => {\n    if (!formData.vesselName.trim()) {\n      Alert.alert('Required Field', 'Please enter vessel name');\n      return false;\n    }\n    if (!formData.vesselType) {\n      Alert.alert('Required Field', 'Please select vessel type');\n      return false;\n    }\n    if (!formData.registrationNumber.trim()) {\n      Alert.alert('Required Field', 'Please enter vessel registration number');\n      return false;\n    }\n    if (!formData.callSign.trim()) {\n      Alert.alert('Required Field', 'Please enter radio call sign');\n      return false;\n    }\n    if (!formData.captainName.trim()) {\n      Alert.alert('Required Field', 'Please enter captain/operator name');\n      return false;\n    }\n    if (!formData.phoneNumber.trim()) {\n      Alert.alert('Required Field', 'Please enter contact phone number');\n      return false;\n    }\n    if (!formData.homePort.trim()) {\n      Alert.alert('Required Field', 'Please enter home port');\n      return false;\n    }\n    if (!formData.vesselLength.trim()) {\n      Alert.alert('Required Field', 'Please enter vessel length');\n      return false;\n    }\n    if (!formData.vesselBeam.trim()) {\n      Alert.alert('Required Field', 'Please enter vessel beam (width)');\n      return false;\n    }\n    if (!formData.grossTonnage.trim()) {\n      Alert.alert('Required Field', 'Please enter gross tonnage');\n      return false;\n    }\n    if (!formData.emergencyContact.trim()) {\n      Alert.alert('Required Field', 'Please enter emergency contact name');\n      return false;\n    }\n    if (!formData.emergencyPhone.trim()) {\n      Alert.alert('Required Field', 'Please enter emergency contact phone');\n      return false;\n    }\n    return true;\n  };\n\n  const handleSubmit = async () => {\n    if (!validateForm()) return;\n\n    setLoading(true);\n    try {\n      const userId = `vessel_${Date.now()}`;\n      \n      const user = {\n        id: userId,\n        name: formData.captainName,\n        email: formData.email || `${userId}@guest.marine`,\n        isGuest: true,\n        createdAt: new Date().toISOString(),\n      };\n\n      await storeUser(user);\n\n      await saveUserToDatabase({\n        id: userId,\n        email: user.email,\n        name: formData.captainName,\n        isGuest: true,\n        createdAt: user.createdAt,\n        lastLogin: new Date().toISOString(),\n        vesselInfo: {\n          vesselName: formData.vesselName,\n          vesselType: formData.vesselType,\n          registrationNumber: formData.registrationNumber,\n          imoNumber: formData.imoNumber,\n          callSign: formData.callSign,\n          homePort: formData.homePort,\n          vesselLength: formData.vesselLength,\n          vesselBeam: formData.vesselBeam,\n          grossTonnage: formData.grossTonnage,\n        },\n        contactInfo: {\n          phone: formData.phoneNumber,\n          email: formData.email,\n          emergencyContact: formData.emergencyContact,\n          emergencyPhone: formData.emergencyPhone,\n        },\n      });\n\n      setLoading(false);\n      router.replace('/(tabs)');\n    } catch (error) {\n      setLoading(false);\n      Alert.alert('Error', 'Failed to register vessel. Please try again.');\n      console.error('Registration error:', error);\n    }\n  };\n\n  return (\n    <KeyboardAvoidingView\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n      style={[styles.container, { backgroundColor: colors.background }]}\n    >\n      <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>\n        <View style={styles.header}>\n          <Text style={styles.headerIcon}>‚öì</Text>\n          <Text style={[styles.title, { color: colors.primary }]}>Vessel Registration</Text>\n          <Text style={[styles.subtitle, { color: colors.text }]}>\n            Register your vessel to access MarineTrack services\n          </Text>\n        </View>\n\n        <View style={styles.section}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>Vessel Information</Text>\n          \n          <Text style={[styles.label, { color: colors.text }]}>Vessel Name *</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Enter vessel name\"\n            placeholderTextColor={colors.icon}\n            value={formData.vesselName}\n            onChangeText={(text) => updateField('vesselName', text)}\n          />\n\n          <Text style={[styles.label, { color: colors.text }]}>Vessel Type *</Text>\n          <View style={styles.typeGrid}>\n            {vesselTypes.map((type) => (\n              <TouchableOpacity\n                key={type}\n                style={[\n                  styles.typeButton,\n                  { borderColor: colors.border },\n                  formData.vesselType === type && { backgroundColor: colors.primary, borderColor: colors.primary }\n                ]}\n                onPress={() => updateField('vesselType', type)}\n              >\n                <Text style={[\n                  styles.typeButtonText,\n                  { color: formData.vesselType === type ? '#fff' : colors.text }\n                ]}>\n                  {type}\n                </Text>\n              </TouchableOpacity>\n            ))}\n          </View>\n\n          <Text style={[styles.label, { color: colors.text }]}>Registration Number</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"e.g., MY-12345\"\n            placeholderTextColor={colors.icon}\n            value={formData.registrationNumber}\n            onChangeText={(text) => updateField('registrationNumber', text)}\n          />\n\n          <Text style={[styles.label, { color: colors.text }]}>IMO Number (if applicable)</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"International Maritime Organization number\"\n            placeholderTextColor={colors.icon}\n            value={formData.imoNumber}\n            onChangeText={(text) => updateField('imoNumber', text)}\n            keyboardType=\"numeric\"\n          />\n\n          <Text style={[styles.label, { color: colors.text }]}>Call Sign</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Radio call sign\"\n            placeholderTextColor={colors.icon}\n            value={formData.callSign}\n            onChangeText={(text) => updateField('callSign', text.toUpperCase())}\n            autoCapitalize=\"characters\"\n          />\n\n          <Text style={[styles.label, { color: colors.text }]}>Home Port *</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"e.g., Port Klang, Malaysia\"\n            placeholderTextColor={colors.icon}\n            value={formData.homePort}\n            onChangeText={(text) => updateField('homePort', text)}\n          />\n\n          <View style={styles.row}>\n            <View style={styles.halfWidth}>\n              <Text style={[styles.label, { color: colors.text }]}>Length (m)</Text>\n              <TextInput\n                style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n                placeholder=\"0.0\"\n                placeholderTextColor={colors.icon}\n                value={formData.vesselLength}\n                onChangeText={(text) => updateField('vesselLength', text)}\n                keyboardType=\"decimal-pad\"\n              />\n            </View>\n            <View style={styles.halfWidth}>\n              <Text style={[styles.label, { color: colors.text }]}>Beam (m)</Text>\n              <TextInput\n                style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n                placeholder=\"0.0\"\n                placeholderTextColor={colors.icon}\n                value={formData.vesselBeam}\n                onChangeText={(text) => updateField('vesselBeam', text)}\n                keyboardType=\"decimal-pad\"\n              />\n            </View>\n          </View>\n\n          <Text style={[styles.label, { color: colors.text }]}>Gross Tonnage (GT)</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Tonnage\"\n            placeholderTextColor={colors.icon}\n            value={formData.grossTonnage}\n            onChangeText={(text) => updateField('grossTonnage', text)}\n            keyboardType=\"numeric\"\n          />\n        </View>\n\n        <View style={styles.section}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>Captain/Operator Information</Text>\n          \n          <Text style={[styles.label, { color: colors.text }]}>Full Name *</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Captain or operator name\"\n            placeholderTextColor={colors.icon}\n            value={formData.captainName}\n            onChangeText={(text) => updateField('captainName', text)}\n          />\n\n          <Text style={[styles.label, { color: colors.text }]}>Phone Number *</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"+60 12-345 6789\"\n            placeholderTextColor={colors.icon}\n            value={formData.phoneNumber}\n            onChangeText={(text) => updateField('phoneNumber', text)}\n            keyboardType=\"phone-pad\"\n          />\n\n          <Text style={[styles.label, { color: colors.text }]}>Email (optional)</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"your.email@example.com\"\n            placeholderTextColor={colors.icon}\n            value={formData.email}\n            onChangeText={(text) => updateField('email', text)}\n            keyboardType=\"email-address\"\n            autoCapitalize=\"none\"\n          />\n        </View>\n\n        <View style={styles.section}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>Emergency Contact</Text>\n          \n          <Text style={[styles.label, { color: colors.text }]}>Emergency Contact Name</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Shore contact name\"\n            placeholderTextColor={colors.icon}\n            value={formData.emergencyContact}\n            onChangeText={(text) => updateField('emergencyContact', text)}\n          />\n\n          <Text style={[styles.label, { color: colors.text }]}>Emergency Contact Phone</Text>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"+60 12-345 6789\"\n            placeholderTextColor={colors.icon}\n            value={formData.emergencyPhone}\n            onChangeText={(text) => updateField('emergencyPhone', text)}\n            keyboardType=\"phone-pad\"\n          />\n        </View>\n\n        <TouchableOpacity\n          style={[styles.submitButton, { backgroundColor: colors.primary }]}\n          onPress={handleSubmit}\n          disabled={loading}\n        >\n          <Text style={styles.submitButtonText}>\n            {loading ? 'Registering...' : 'Complete Registration'}\n          </Text>\n        </TouchableOpacity>\n\n        <View style={{ height: 40 }} />\n      </ScrollView>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  header: {\n    alignItems: 'center',\n    paddingTop: 60,\n    paddingBottom: 20,\n    paddingHorizontal: 20,\n  },\n  headerIcon: {\n    fontSize: 60,\n    marginBottom: 16,\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    marginBottom: 8,\n  },\n  subtitle: {\n    fontSize: 14,\n    textAlign: 'center',\n    opacity: 0.7,\n  },\n  section: {\n    paddingHorizontal: 20,\n    marginBottom: 24,\n  },\n  sectionTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 16,\n  },\n  label: {\n    fontSize: 14,\n    fontWeight: '600',\n    marginBottom: 8,\n    marginTop: 12,\n  },\n  input: {\n    height: 48,\n    borderRadius: 8,\n    borderWidth: 1,\n    paddingHorizontal: 16,\n    fontSize: 16,\n  },\n  typeGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 8,\n  },\n  typeButton: {\n    paddingVertical: 12,\n    paddingHorizontal: 16,\n    borderRadius: 8,\n    borderWidth: 1,\n  },\n  typeButtonText: {\n    fontSize: 14,\n    fontWeight: '500',\n  },\n  row: {\n    flexDirection: 'row',\n    gap: 12,\n  },\n  halfWidth: {\n    flex: 1,\n  },\n  submitButton: {\n    marginHorizontal: 20,\n    height: 56,\n    borderRadius: 12,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 20,\n  },\n  submitButtonText: {\n    color: '#fff',\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":14614},"utils/database.ts":{"content":"import AsyncStorage from '@react-native-async-storage/async-storage';\n\n// Database keys\nconst DB_USERS_KEY = 'marinetrack_users';\nconst DB_BOATS_KEY = 'marinetrack_boats';\nconst DB_TRACKING_KEY = 'marinetrack_tracking';\n\nexport interface UserData {\n  id: string;\n  email: string | null;\n  name: string;\n  photoUrl?: string;\n  phoneNumber?: string;\n  isGuest: boolean;\n  createdAt: string;\n  lastLogin: string;\n  vesselInfo?: {\n    vesselName: string;\n    vesselType: string;\n    registrationNumber?: string;\n    imoNumber?: string;\n    callSign: string;\n    homePort: string;\n    vesselLength: string;\n    vesselBeam: string;\n    grossTonnage: string;\n  };\n  contactInfo?: {\n    phone: string;\n    email?: string;\n    emergencyContact: string;\n    emergencyPhone: string;\n  };\n}\n\nexport interface BoatData {\n  userId: string;\n  vesselName: string;\n  vesselId: string;\n  vesselType: string;\n  mmsi?: string;\n  imo?: string;\n  length?: number;\n  beam?: number;\n  draft?: number;\n  registrationNumber?: string;\n  homePort?: string;\n  updatedAt: string;\n}\n\nexport interface TrackingData {\n  userId: string;\n  vesselName: string;\n  location: {\n    latitude: number;\n    longitude: number;\n    speed: number;\n    heading: number;\n    timestamp: string;\n  };\n  status: 'Active' | 'Idle' | 'Anchored';\n}\n\n// User operations\nexport const saveUserToDatabase = async (user: UserData): Promise<void> => {\n  try {\n    const usersData = await getAllUsers();\n    const existingIndex = usersData.findIndex(u => u.id === user.id);\n\n    if (existingIndex >= 0) {\n      usersData[existingIndex] = { ...user, lastLogin: new Date().toISOString() };\n    } else {\n      usersData.push(user);\n    }\n\n    await AsyncStorage.setItem(DB_USERS_KEY, JSON.stringify(usersData));\n  } catch (error) {\n    console.error('Error saving user to database:', error);\n  }\n};\n\nexport const getUserFromDatabase = async (userId: string): Promise<UserData | null> => {\n  try {\n    const users = await getAllUsers();\n    return users.find(u => u.id === userId) || null;\n  } catch (error) {\n    console.error('Error getting user from database:', error);\n    return null;\n  }\n};\n\nexport const getAllUsers = async (): Promise<UserData[]> => {\n  try {\n    const data = await AsyncStorage.getItem(DB_USERS_KEY);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.error('Error getting all users:', error);\n    return [];\n  }\n};\n\n// Boat operations\nexport const saveBoatData = async (boat: BoatData): Promise<void> => {\n  try {\n    const boatsData = await getAllBoats();\n    const existingIndex = boatsData.findIndex(b => b.userId === boat.userId);\n\n    const updatedBoat = { ...boat, updatedAt: new Date().toISOString() };\n\n    if (existingIndex >= 0) {\n      boatsData[existingIndex] = updatedBoat;\n    } else {\n      boatsData.push(updatedBoat);\n    }\n\n    await AsyncStorage.setItem(DB_BOATS_KEY, JSON.stringify(boatsData));\n  } catch (error) {\n    console.error('Error saving boat data:', error);\n  }\n};\n\nexport const getBoatData = async (userId: string): Promise<BoatData | null> => {\n  try {\n    const boats = await getAllBoats();\n    return boats.find(b => b.userId === userId) || null;\n  } catch (error) {\n    console.error('Error getting boat data:', error);\n    return null;\n  }\n};\n\nexport const getAllBoats = async (): Promise<BoatData[]> => {\n  try {\n    const data = await AsyncStorage.getItem(DB_BOATS_KEY);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.error('Error getting all boats:', error);\n    return [];\n  }\n};\n\n// Tracking operations\nexport const saveTrackingData = async (data: TrackingData): Promise<void> => {\n  try {\n    const trackingData = await getAllTrackingData();\n    const existingIndex = trackingData.findIndex(t => t.userId === data.userId);\n\n    if (existingIndex >= 0) {\n      trackingData[existingIndex] = data;\n    } else {\n      trackingData.push(data);\n    }\n\n    await AsyncStorage.setItem(DB_TRACKING_KEY, JSON.stringify(trackingData));\n  } catch (error) {\n    console.error('Error saving tracking data:', error);\n  }\n};\n\nexport const getAllTrackingData = async (): Promise<TrackingData[]> => {\n  try {\n    const data = await AsyncStorage.getItem(DB_TRACKING_KEY);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.error('Error getting tracking data:', error);\n    return [];\n  }\n};\n\nexport const getNearbyBoats = async (\n  latitude: number,\n  longitude: number,\n  radiusKm: number = 50\n): Promise<TrackingData[]> => {\n  try {\n    const allTracking = await getAllTrackingData();\n\n    return allTracking.filter(tracking => {\n      const distance = calculateDistance(\n        latitude,\n        longitude,\n        tracking.location.latitude,\n        tracking.location.longitude\n      );\n      return distance <= radiusKm;\n    });\n  } catch (error) {\n    console.error('Error getting nearby boats:', error);\n    return [];\n  }\n};\n\n// Helper function to calculate distance\nconst calculateDistance = (\n  lat1: number,\n  lon1: number,\n  lat2: number,\n  lon2: number\n): number => {\n  const R = 6371; // Earth's radius in km\n  const dLat = ((lat2 - lat1) * Math.PI) / 180;\n  const dLon = ((lon2 - lon1) * Math.PI) / 180;\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos((lat1 * Math.PI) / 180) *\n      Math.cos((lat2 * Math.PI) / 180) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n};\n\n// Delete operations (for user account deletion)\nexport const deleteUserData = async (userId: string): Promise<void> => {\n  try {\n    // Delete user\n    const users = await getAllUsers();\n    const filteredUsers = users.filter(u => u.id !== userId);\n    await AsyncStorage.setItem(DB_USERS_KEY, JSON.stringify(filteredUsers));\n\n    // Delete boat\n    const boats = await getAllBoats();\n    const filteredBoats = boats.filter(b => b.userId !== userId);\n    await AsyncStorage.setItem(DB_BOATS_KEY, JSON.stringify(filteredBoats));\n\n    // Delete tracking\n    const tracking = await getAllTrackingData();\n    const filteredTracking = tracking.filter(t => t.userId !== userId);\n    await AsyncStorage.setItem(DB_TRACKING_KEY, JSON.stringify(filteredTracking));\n  } catch (error) {\n    console.error('Error deleting user data:', error);\n  }\n};","size_bytes":6286},"metro.config.js":{"content":"\nconst { getDefaultConfig } = require('expo/metro-config');\n\nconst config = getDefaultConfig(__dirname);\n\n// Allow requests from Replit domains\nconfig.server = {\n  ...config.server,\n  rewriteRequestUrl: (url) => {\n    if (!url.includes('?')) {\n      return url;\n    }\n    return url;\n  },\n};\n\nmodule.exports = config;\n","size_bytes":318},"utils/weatherApi.ts":{"content":"\n// Weather API Keys\nconst STORMGLASS_API_KEY = '5cf7a41a-b626-11f0-a8f4-0242ac130003-5cf7a492-b626-11f0-a8f4-0242ac130003';\nconst AISTREAM_API_KEY = '786e06e04c50efda09a5075482678ca8b48014fd';\nconst WEATHERAPI_KEY = 'b8662263280e4b65a6864833253110';\n\n// Cache for failed API calls\nlet stormGlassFailedAt: number | null = null;\nconst STORMGLASS_RETRY_DELAY = 10 * 60 * 1000; // 10 minutes in milliseconds\n\nexport interface WeatherData {\n  temperature: number;\n  windSpeed: number;\n  waveHeight: number;\n  visibility: number;\n  condition: string;\n  icon: string;\n}\n\nexport interface HourlyForecast {\n  time: string;\n  temp: string;\n  icon: string;\n  wind: string;\n  condition: string;\n}\n\nexport const fetchStormGlassWeather = async (lat: number, lng: number): Promise<WeatherData | null> => {\n  // Check if we recently failed and should not retry yet\n  if (stormGlassFailedAt) {\n    const timeSinceFailure = Date.now() - stormGlassFailedAt;\n    if (timeSinceFailure < STORMGLASS_RETRY_DELAY) {\n      // Silently return null during cooldown\n      return null;\n    }\n  }\n\n  try {\n    const response = await fetch(\n      `https://api.stormglass.io/v2/weather/point?lat=${lat}&lng=${lng}&params=airTemperature,windSpeed,waveHeight,visibility`,\n      {\n        headers: {\n          'Authorization': STORMGLASS_API_KEY\n        }\n      }\n    );\n    \n    if (!response.ok) {\n      // Silently mark failure and return null - no console errors\n      stormGlassFailedAt = Date.now();\n      return null;\n    }\n    \n    // Reset failure timer on success\n    stormGlassFailedAt = null;\n    \n    const data = await response.json();\n    const current = data.hours[0];\n    \n    return {\n      temperature: Math.round(current.airTemperature.noaa || 28),\n      windSpeed: Math.round(current.windSpeed.noaa || 15),\n      waveHeight: parseFloat((current.waveHeight.noaa || 1.2).toFixed(1)),\n      visibility: Math.round(current.visibility.noaa || 8),\n      condition: 'Partly Cloudy',\n      icon: '‚õÖ'\n    };\n  } catch (error) {\n    // Silently mark failure and return null - no console errors\n    stormGlassFailedAt = Date.now();\n    return null;\n  }\n};\n\nexport const fetchWeatherAPIData = async (lat: number, lng: number): Promise<any> => {\n  try {\n    const response = await fetch(\n      `https://api.weatherapi.com/v1/forecast.json?key=${WEATHERAPI_KEY}&q=${lat},${lng}&days=1&aqi=no&alerts=yes`\n    );\n    \n    if (!response.ok) {\n      console.error('WeatherAPI error:', response.status);\n      return null;\n    }\n    \n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching WeatherAPI data:', error);\n    return null;\n  }\n};\n\nexport const getWeatherIcon = (condition: string): string => {\n  const lowerCondition = condition.toLowerCase();\n  if (lowerCondition.includes('sunny') || lowerCondition.includes('clear')) return '‚òÄÔ∏è';\n  if (lowerCondition.includes('partly cloudy')) return '‚õÖ';\n  if (lowerCondition.includes('cloudy') || lowerCondition.includes('overcast')) return '‚òÅÔ∏è';\n  if (lowerCondition.includes('rain') || lowerCondition.includes('drizzle')) return 'üåßÔ∏è';\n  if (lowerCondition.includes('storm') || lowerCondition.includes('thunder')) return '‚õàÔ∏è';\n  if (lowerCondition.includes('snow')) return '‚ùÑÔ∏è';\n  if (lowerCondition.includes('fog') || lowerCondition.includes('mist')) return 'üå´Ô∏è';\n  return '‚õÖ';\n};\n\nexport const getMockWeatherData = (): WeatherData => {\n  return {\n    temperature: 28,\n    windSpeed: 15,\n    waveHeight: 1.2,\n    visibility: 8,\n    condition: 'Partly Cloudy',\n    icon: '‚õÖ'\n  };\n};\n\nexport const getMockHourlyForecast = (): HourlyForecast[] => {\n  return [\n    { time: '10 AM', temp: '27¬∞C', icon: '‚òÄÔ∏è', wind: '12 km/h', condition: 'Sunny' },\n    { time: '11 AM', temp: '28¬∞C', icon: '‚õÖ', wind: '15 km/h', condition: 'Partly Cloudy' },\n    { time: '12 PM', temp: '29¬∞C', icon: '‚õÖ', wind: '18 km/h', condition: 'Partly Cloudy' },\n    { time: '1 PM', temp: '30¬∞C', icon: '‚òÅÔ∏è', wind: '20 km/h', condition: 'Cloudy' },\n    { time: '2 PM', temp: '29¬∞C', icon: 'üåßÔ∏è', wind: '22 km/h', condition: 'Light Rain' },\n    { time: '3 PM', temp: '28¬∞C', icon: 'üåßÔ∏è', wind: '20 km/h', condition: 'Rain' },\n    { time: '4 PM', temp: '27¬∞C', icon: '‚õÖ', wind: '18 km/h', condition: 'Clearing' },\n    { time: '5 PM', temp: '26¬∞C', icon: '‚õÖ', wind: '16 km/h', condition: 'Partly Cloudy' },\n  ];\n};\n","size_bytes":4396},"utils/realtimeChat.ts":{"content":"\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\ninterface ChatMessage {\n  id: string;\n  chatId: string;\n  senderId: string;\n  senderName: string;\n  text: string;\n  timestamp: string;\n}\n\ninterface ChatRoom {\n  id: string;\n  participants: string[];\n  lastMessage?: ChatMessage;\n}\n\nconst MESSAGES_KEY = '@marinetrack_messages';\nconst CHAT_ROOMS_KEY = '@marinetrack_chat_rooms';\n\n// Send a message\nexport const sendMessage = async (\n  chatId: string,\n  senderId: string,\n  senderName: string,\n  text: string\n): Promise<ChatMessage> => {\n  const message: ChatMessage = {\n    id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n    chatId,\n    senderId,\n    senderName,\n    text,\n    timestamp: new Date().toISOString(),\n  };\n\n  // Store message locally\n  const stored = await AsyncStorage.getItem(MESSAGES_KEY);\n  const messages: ChatMessage[] = stored ? JSON.parse(stored) : [];\n  messages.push(message);\n  await AsyncStorage.setItem(MESSAGES_KEY, JSON.stringify(messages));\n\n  // Update chat room\n  await updateChatRoom(chatId, message);\n\n  // In production, send to backend:\n  // await fetch('https://your-backend/api/messages', {\n  //   method: 'POST',\n  //   body: JSON.stringify(message)\n  // });\n\n  return message;\n};\n\n// Get messages for a chat\nexport const getChatMessages = async (chatId: string): Promise<ChatMessage[]> => {\n  const stored = await AsyncStorage.getItem(MESSAGES_KEY);\n  const messages: ChatMessage[] = stored ? JSON.parse(stored) : [];\n  return messages.filter(m => m.chatId === chatId).sort((a, b) => \n    new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime()\n  );\n};\n\n// Create or get chat room between two users\nexport const getChatRoom = async (user1Id: string, user2Id: string): Promise<string> => {\n  const chatId = [user1Id, user2Id].sort().join('_');\n  \n  const stored = await AsyncStorage.getItem(CHAT_ROOMS_KEY);\n  const rooms: ChatRoom[] = stored ? JSON.parse(stored) : [];\n  \n  const existing = rooms.find(r => r.id === chatId);\n  if (existing) return chatId;\n\n  const newRoom: ChatRoom = {\n    id: chatId,\n    participants: [user1Id, user2Id],\n  };\n  \n  rooms.push(newRoom);\n  await AsyncStorage.setItem(CHAT_ROOMS_KEY, JSON.stringify(rooms));\n  \n  return chatId;\n};\n\n// Update chat room with last message\nconst updateChatRoom = async (chatId: string, message: ChatMessage): Promise<void> => {\n  const stored = await AsyncStorage.getItem(CHAT_ROOMS_KEY);\n  const rooms: ChatRoom[] = stored ? JSON.parse(stored) : [];\n  \n  const room = rooms.find(r => r.id === chatId);\n  if (room) {\n    room.lastMessage = message;\n    await AsyncStorage.setItem(CHAT_ROOMS_KEY, JSON.stringify(rooms));\n  }\n};\n\n// Subscribe to new messages (polling simulation)\nexport const subscribeToMessages = (\n  chatId: string,\n  callback: (message: ChatMessage) => void\n): { unsubscribe: () => void } => {\n  let lastCheck = new Date();\n  \n  const interval = setInterval(async () => {\n    const messages = await getChatMessages(chatId);\n    const newMessages = messages.filter(m => new Date(m.timestamp) > lastCheck);\n    \n    newMessages.forEach(callback);\n    lastCheck = new Date();\n  }, 2000); // Check every 2 seconds\n\n  return {\n    unsubscribe: () => clearInterval(interval),\n  };\n};\n","size_bytes":3249},"app/(tabs)/ports.tsx":{"content":"\nimport React from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport PortMap from '@/components/PortMap';\n\nexport default function PortsScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n\n  return (\n    <View style={[styles.container, { backgroundColor: colors.background }]}>\n      <PortMap />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    paddingTop: 50,\n  },\n});\n","size_bytes":573},"utils/vesselScraper.ts":{"content":"\n// Vessel scraper for Malaysia ports from VesselFinder\n// Note: In production, this should be done server-side to avoid CORS issues\n\nexport interface VesselDetails {\n  name: string;\n  imo: string;\n  mmsi: string;\n  type: string;\n  flag: string;\n  destination: string;\n  eta: string;\n  status: 'Expected' | 'Arrivals' | 'Departures' | 'In Port';\n  lastPosition: {\n    lat: number;\n    lng: number;\n    timestamp: string;\n  };\n}\n\nexport interface PortVesselData {\n  portName: string;\n  portCode: string;\n  expected: VesselDetails[];\n  arrivals: VesselDetails[];\n  departures: VesselDetails[];\n  inPort: VesselDetails[];\n}\n\n// Malaysia major ports\nexport const MALAYSIA_PORTS = [\n  { name: 'Port Klang', code: 'MYPKG', url: 'https://www.vesselfinder.com/ports/MYPKG' },\n  { name: 'Penang Port', code: 'MYPEN', url: 'https://www.vesselfinder.com/ports/MYPEN' },\n  { name: 'Johor Port', code: 'MYPGU', url: 'https://www.vesselfinder.com/ports/MYPGU' },\n  { name: 'Kuantan Port', code: 'MYKUA', url: 'https://www.vesselfinder.com/ports/MYKUA' },\n  { name: 'Bintulu Port', code: 'MYBTU', url: 'https://www.vesselfinder.com/ports/MYBTU' },\n  { name: 'Tanjung Pelepas', code: 'MYTPP', url: 'https://www.vesselfinder.com/ports/MYTPP' },\n  { name: 'Lumut Port', code: 'MYLMU', url: 'https://www.vesselfinder.com/ports/MYLMU' },\n  { name: 'Kemaman Port', code: 'MYKEM', url: 'https://www.vesselfinder.com/ports/MYKEM' },\n];\n\n// This function would need a backend API to avoid CORS\n// For now, we'll use mock data based on real vessel patterns\nexport const fetchPortVesselData = async (portCode: string): Promise<PortVesselData | null> => {\n  try {\n    // In production, this would call your backend API that scrapes VesselFinder\n    // For now, return realistic mock data\n    return getMockPortVesselData(portCode);\n  } catch (error) {\n    console.error('Error fetching vessel data:', error);\n    return null;\n  }\n};\n\nconst getMockPortVesselData = (portCode: string): PortVesselData => {\n  const port = MALAYSIA_PORTS.find(p => p.code === portCode);\n  \n  return {\n    portName: port?.name || 'Unknown Port',\n    portCode,\n    expected: [\n      {\n        name: 'MAERSK ESSEX',\n        imo: '9632495',\n        mmsi: '219635000',\n        type: 'Container Ship',\n        flag: 'Denmark',\n        destination: portCode,\n        eta: new Date(Date.now() + 86400000 * 2).toISOString(),\n        status: 'Expected',\n        lastPosition: { lat: 3.0, lng: 101.5, timestamp: new Date().toISOString() }\n      }\n    ],\n    arrivals: [\n      {\n        name: 'COSCO SHIPPING',\n        imo: '9728294',\n        mmsi: '477123400',\n        type: 'Container Ship',\n        flag: 'Hong Kong',\n        destination: portCode,\n        eta: new Date(Date.now() - 3600000).toISOString(),\n        status: 'Arrivals',\n        lastPosition: { lat: 3.1, lng: 101.4, timestamp: new Date().toISOString() }\n      }\n    ],\n    departures: [\n      {\n        name: 'MSC MEDITERRANEAN',\n        imo: '9456789',\n        mmsi: '372123456',\n        type: 'Container Ship',\n        flag: 'Panama',\n        destination: 'SGSIN',\n        eta: new Date(Date.now() + 43200000).toISOString(),\n        status: 'Departures',\n        lastPosition: { lat: 3.2, lng: 101.3, timestamp: new Date().toISOString() }\n      }\n    ],\n    inPort: [\n      {\n        name: 'EVER GIVEN',\n        imo: '9811000',\n        mmsi: '353136000',\n        type: 'Container Ship',\n        flag: 'Panama',\n        destination: portCode,\n        eta: new Date(Date.now() - 86400000).toISOString(),\n        status: 'In Port',\n        lastPosition: { lat: 3.0, lng: 101.4, timestamp: new Date().toISOString() }\n      },\n      {\n        name: 'PACIFIC TRADER',\n        imo: '9234567',\n        mmsi: '563789012',\n        type: 'Cargo Ship',\n        flag: 'Singapore',\n        destination: portCode,\n        eta: new Date(Date.now() - 172800000).toISOString(),\n        status: 'In Port',\n        lastPosition: { lat: 3.0, lng: 101.4, timestamp: new Date().toISOString() }\n      }\n    ]\n  };\n};\n\nexport const getTotalVesselsCount = (portData: PortVesselData): number => {\n  return portData.expected.length + portData.arrivals.length + \n         portData.departures.length + portData.inPort.length;\n};\n","size_bytes":4210},"app/onboarding.tsx":{"content":"import React, { useState, useRef } from 'react';\nimport { View, Text, StyleSheet, Dimensions, TouchableOpacity, Animated } from 'react-native';\nimport { useRouter } from 'expo-router';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\n\nconst { width } = Dimensions.get('window');\n\nconst slides = [\n  {\n    id: 1,\n    title: 'Track Your Vessel',\n    description: 'Monitor your vessel location in real-time with GPS tracking',\n    icon: 'üö¢',\n  },\n  {\n    id: 2,\n    title: 'Stay Safe',\n    description: 'Receive weather alerts and navigation warnings to ensure safe journeys',\n    icon: '‚õàÔ∏è',\n  },\n  {\n    id: 3,\n    title: 'Send SOS Instantly',\n    description: 'Emergency button to alert authorities and contacts when in danger',\n    icon: 'üö®',\n  },\n];\n\nexport default function OnboardingScreen() {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const scrollX = useRef(new Animated.Value(0)).current;\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const router = useRouter();\n\n  const handleNext = () => {\n    if (currentIndex < slides.length - 1) {\n      setCurrentIndex(currentIndex + 1);\n    } else {\n      router.replace('/auth/login');\n    }\n  };\n\n  const handleSkip = () => {\n    router.replace('/auth/login');\n  };\n\n  return (\n    <View style={[styles.container, { backgroundColor: colors.background }]}>\n      <View style={styles.slide}>\n        <Text style={styles.icon}>{slides[currentIndex].icon}</Text>\n        <Text style={[styles.title, { color: colors.primary }]}>\n          {slides[currentIndex].title}\n        </Text>\n        <Text style={[styles.description, { color: colors.text }]}>\n          {slides[currentIndex].description}\n        </Text>\n      </View>\n\n      <View style={styles.pagination}>\n        {slides.map((_, index) => (\n          <View\n            key={index}\n            style={[\n              styles.dot,\n              {\n                backgroundColor: index === currentIndex ? colors.primary : colors.border,\n                width: index === currentIndex ? 20 : 8,\n              },\n            ]}\n          />\n        ))}\n      </View>\n\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity onPress={handleSkip}>\n          <Text style={[styles.skipText, { color: colors.icon }]}>Skip</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.nextButton, { backgroundColor: colors.primary }]}\n          onPress={handleNext}\n        >\n          <Text style={styles.nextButtonText}>\n            {currentIndex === slides.length - 1 ? 'Get Started' : 'Next'}\n          </Text>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'space-between',\n    padding: 20,\n  },\n  slide: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: 20,\n  },\n  icon: {\n    fontSize: 120,\n    marginBottom: 40,\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    textAlign: 'center',\n    marginBottom: 16,\n  },\n  description: {\n    fontSize: 16,\n    textAlign: 'center',\n    lineHeight: 24,\n  },\n  pagination: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    gap: 8,\n    marginBottom: 40,\n  },\n  dot: {\n    height: 8,\n    borderRadius: 4,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n  skipText: {\n    fontSize: 16,\n  },\n  nextButton: {\n    paddingVertical: 16,\n    paddingHorizontal: 40,\n    borderRadius: 30,\n  },\n  nextButtonText: {\n    color: '#fff',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":3758},"app/(tabs)/tracker.tsx":{"content":"import React, { useState, useEffect, useRef } from 'react';\nimport { View, Text, StyleSheet, TouchableOpacity, Switch, TextInput, ScrollView, Alert, Platform } from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport * as Location from 'expo-location';\nimport { getCurrentUser, updateVesselInfo } from '@/utils/auth';\nimport { sendTrackingData, startTracking, getNearbyTrackedVessels } from '@/utils/trackingService';\nimport { saveBoatData } from '@/utils/database';\n\n// Constants for StormGlass API interaction\nconst STORMGLASS_API_URL = 'https://api.stormglass.io/v2/weather/point';\nconst STORMGLASS_API_KEY = 'YOUR_STORMGLASS_API_KEY'; // Replace with your actual API key\nconst CACHE_EXPIRY_MS = 10 * 60 * 1000; // 10 minutes\n\nlet lastStormGlassFetchTime = 0;\nlet cachedWeatherData: any = null;\n\nexport default function TrackerScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n\n  const [isTracking, setIsTracking] = useState(false);\n  const [currentLocation, setCurrentLocation] = useState<{ latitude: number; longitude: number } | null>(null);\n  const [heading, setHeading] = useState<number>(0);\n  const [speed, setSpeed] = useState<number>(0);\n  const [vesselInfo, setVesselInfo] = useState({\n    vesselName: '',\n    vesselId: '',\n    vesselType: 'Fishing Vessel',\n    mmsi: '',\n    imo: '',\n  });\n  const [status, setStatus] = useState<'Active' | 'Idle' | 'Anchored'>('Idle');\n  const [nearbyVessels, setNearbyVessels] = useState<any[]>([]);\n  const [trackingSubscription, setTrackingSubscription] = useState<any>(null);\n  const [weatherData, setWeatherData] = useState<any>(null);\n\n  // Effect to load initial user data and set up location tracking\n  useEffect(() => {\n    loadUserVesselInfo();\n    loadUserBoatData();\n\n    const requestLocationPermissions = async () => {\n      const { status } = await Location.requestForegroundPermissionsAsync();\n      if (status !== 'granted') {\n        Alert.alert('Permission Denied', 'Location permission is required for tracking and map display.');\n        return;\n      }\n\n      // Get initial location\n      try {\n        const location = await Location.getCurrentPositionAsync({\n          accuracy: Location.Accuracy.High,\n        });\n        setCurrentLocation({ latitude: location.coords.latitude, longitude: location.coords.longitude });\n      } catch (error) {\n        console.error(\"Error getting initial location:\", error);\n        Alert.alert('Location Error', 'Could not retrieve your current location. Please try again.');\n      }\n    };\n\n    requestLocationPermissions();\n\n    return () => {\n      if (trackingSubscription) {\n        trackingSubscription.remove();\n      }\n      // Clear any active intervals if the component unmounts\n      if ((trackingSubscription as any)?.updateInterval) {\n        clearInterval((trackingSubscription as any).updateInterval);\n      }\n    };\n  }, []);\n\n  // Effect to handle location updates and sending data when tracking is active\n  useEffect(() => {\n    if (isTracking && currentLocation) {\n      sendLocationUpdate();\n      loadNearbyVessels();\n      fetchWeatherData(currentLocation.latitude, currentLocation.longitude);\n    }\n  }, [currentLocation, isTracking]);\n\n  \n\n  const loadUserVesselInfo = async () => {\n    const user = await getCurrentUser();\n    if (user?.vesselInfo) {\n      setVesselInfo({\n        vesselName: user.vesselInfo.vesselName,\n        vesselId: user.vesselInfo.vesselId,\n        vesselType: user.vesselInfo.vesselType,\n        mmsi: user.vesselInfo.mmsi || '',\n        imo: user.vesselInfo.imo || '',\n      });\n    }\n  };\n\n  const loadUserBoatData = async () => {\n    const user = await getCurrentUser();\n    if (user) {\n      const { getBoatData, getUserFromDatabase } = await import('@/utils/database');\n      const boat = await getBoatData(user.id);\n      const userData = await getUserFromDatabase(user.id);\n\n      if (boat) {\n        setVesselInfo({\n          vesselName: boat.vesselName || vesselInfo.vesselName,\n          vesselId: boat.vesselId || vesselInfo.vesselId,\n          vesselType: boat.vesselType || vesselInfo.vesselType,\n          mmsi: boat.mmsi || '',\n          imo: boat.imo || '',\n        });\n      } else if (userData?.vesselInfo) {\n        setVesselInfo({\n          vesselName: userData.vesselInfo.vesselName || vesselInfo.vesselName,\n          vesselId: userData.vesselInfo.registrationNumber || vesselInfo.vesselId,\n          vesselType: userData.vesselInfo.vesselType || vesselInfo.vesselType,\n          mmsi: userData.vesselInfo.imoNumber || '',\n          imo: userData.vesselInfo.imoNumber || '',\n        });\n      }\n    }\n  };\n\n  const sendLocationUpdate = async () => {\n    if (!currentLocation) return;\n\n    const user = await getCurrentUser();\n    if (!user) return;\n\n    const trackingData = {\n      userId: user.id,\n      vesselInfo,\n      location: {\n        latitude: currentLocation.latitude,\n        longitude: currentLocation.longitude,\n        heading,\n        speed,\n        timestamp: new Date().toISOString(),\n      },\n      status,\n    };\n\n    try {\n      await sendTrackingData(trackingData);\n    } catch (error) {\n      console.error(\"Error sending location update:\", error);\n      // Potentially show an error to the user if sending fails repeatedly\n    }\n  };\n\n  const loadNearbyVessels = async () => {\n    if (!currentLocation) return;\n\n    try {\n      const vessels = await getNearbyTrackedVessels(\n        currentLocation.latitude,\n        currentLocation.longitude,\n        10 // Search radius in km\n      );\n      setNearbyVessels(vessels);\n    } catch (error) {\n      console.error(\"Error loading nearby vessels:\", error);\n      // Handle error, perhaps inform the user\n    }\n  };\n\n  const fetchWeatherData = async (latitude: number, longitude: number) => {\n    const now = Date.now();\n    // Check if cached data is still valid (within 10 minutes)\n    if (cachedWeatherData && (now - lastStormGlassFetchTime < CACHE_EXPIRY_MS)) {\n      setWeatherData(cachedWeatherData);\n      return;\n    }\n\n    // Prevent fetching too frequently\n    if (now - lastStormGlassFetchTime < CACHE_EXPIRY_MS) {\n      return;\n    }\n\n    lastStormGlassFetchTime = now;\n\n    try {\n      const response = await fetch(\n        `${STORMGLASS_API_URL}?lat=${latitude}&lng=${longitude}&params=waveHeight,windSpeed,airTemperature`,\n        {\n          headers: {\n            'Authorization': STORMGLASS_API_KEY,\n          },\n        }\n      );\n\n      if (!response.ok) {\n        // Handle specific error codes, e.g., 402 for invalid API key or exceeding limits\n        if (response.status === 402) {\n          console.error(\"StormGlass API error: Payment Required or Quota Exceeded. Please check your API key and usage limits.\");\n          Alert.alert('Weather API Error', 'Could not fetch weather data. Please check your API key and usage limits.');\n          cachedWeatherData = null; // Clear cache if there's an API error\n          lastStormGlassFetchTime = 0; // Reset timer to allow retry after 10 mins\n        } else {\n          console.error(`StormGlass API error: ${response.status} ${response.statusText}`);\n          Alert.alert('Weather API Error', `Failed to fetch weather data: ${response.statusText}`);\n          cachedWeatherData = null;\n          lastStormGlassFetchTime = 0;\n        }\n        return;\n      }\n\n      const data = await response.json();\n      cachedWeatherData = data; // Cache the fetched data\n      setWeatherData(data);\n    } catch (error) {\n      console.error(\"Error fetching weather data:\", error);\n      Alert.alert('Network Error', 'Could not fetch weather data. Please check your internet connection.');\n      cachedWeatherData = null;\n      lastStormGlassFetchTime = 0; // Reset timer on network error\n    }\n  };\n\n\n  const toggleTracking = async () => {\n    if (!vesselInfo.vesselName || !vesselInfo.vesselId) {\n      Alert.alert('Missing Info', 'Please fill in vessel name and ID before starting tracking');\n      return;\n    }\n\n    if (!isTracking) {\n      // Request permissions if not already granted\n      const { status: permissionStatus } = await Location.requestForegroundPermissionsAsync();\n      if (permissionStatus !== 'granted') {\n        Alert.alert('Permission Denied', 'Location permission is required for tracking');\n        return;\n      }\n\n      // Save vessel info to both auth and database\n      await updateVesselInfo({\n        vesselName: vesselInfo.vesselName,\n        vesselId: vesselInfo.vesselId,\n        vesselType: vesselInfo.vesselType,\n        mmsi: vesselInfo.mmsi,\n        imo: vesselInfo.imo,\n      });\n\n      const user = await getCurrentUser();\n      if (user) {\n        await saveBoatData({\n          userId: user.id,\n          vesselName: vesselInfo.vesselName,\n          vesselId: vesselInfo.vesselId,\n          vesselType: vesselInfo.vesselType,\n          mmsi: vesselInfo.mmsi,\n          imo: vesselInfo.imo,\n          updatedAt: new Date().toISOString(),\n        });\n      }\n\n      // Get initial location\n      let location;\n      try {\n        location = await Location.getCurrentPositionAsync({\n          accuracy: Location.Accuracy.High,\n        });\n      } catch (error) {\n        console.error(\"Error getting current position:\", error);\n        Alert.alert('Location Error', 'Could not get your current location to start tracking.');\n        return;\n      }\n\n      const newLocation = {\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude,\n      };\n\n      setCurrentLocation(newLocation);\n      setHeading(location.coords.heading || 0);\n      setSpeed(location.coords.speed ? location.coords.speed * 1.94384 : 0); // Convert m/s to knots\n\n      // Start continuous tracking with location updates\n      let subscription;\n      try {\n        subscription = await startTracking((loc) => {\n          setCurrentLocation({\n            latitude: loc.latitude,\n            longitude: loc.longitude,\n          });\n\n          // Update heading and speed more accurately if possible\n          Location.getCurrentPositionAsync({\n            accuracy: Location.Accuracy.BestForNavigation, // Use BestForNavigation for more frequent/accurate updates\n          }).then((currentLoc) => {\n            setHeading(currentLoc.coords.heading || 0);\n            setSpeed(currentLoc.coords.speed ? currentLoc.coords.speed * 1.94384 : 0);\n          }).catch(error => {\n            console.error(\"Error getting current position for heading/speed:\", error);\n          });\n        });\n        setTrackingSubscription(subscription);\n      } catch (error) {\n        console.error(\"Error starting tracking service:\", error);\n        Alert.alert('Tracking Error', 'Could not start location tracking service. Please try again.');\n        return;\n      }\n\n      setIsTracking(true);\n      setStatus('Active');\n\n      // Start periodic updates to send tracking data and fetch nearby vessels\n      const updateInterval = setInterval(async () => {\n        await sendLocationUpdate();\n        await loadNearbyVessels();\n      }, 5000); // Update every 5 seconds for better real-time tracking\n\n      // Store interval for cleanup\n      (subscription as any).updateInterval = updateInterval;\n\n      Alert.alert(\n        'AIS Broadcasting Started',\n        `Your vessel \"${vesselInfo.vesselName}\" is now broadcasting. Your location is being shared with nearby MarineTrack users.`,\n        [{ text: 'OK' }]\n      );\n    } else {\n      // Stop tracking\n      if (trackingSubscription) {\n        // Clear update interval\n        if ((trackingSubscription as any).updateInterval) {\n          clearInterval((trackingSubscription as any).updateInterval);\n        }\n        trackingSubscription.remove();\n        setTrackingSubscription(null); // Clear the subscription reference\n      }\n      setIsTracking(false);\n      setStatus('Idle');\n      setNearbyVessels([]);\n      setWeatherData(null); // Clear weather data when tracking stops\n      cachedWeatherData = null; // Clear cached weather data\n      lastStormGlassFetchTime = 0; // Reset fetch timer\n      Alert.alert('AIS Broadcasting Stopped', 'Your vessel is no longer broadcasting its position.');\n    }\n  };\n\n  const handleSaveVesselInfo = async () => {\n    if (!vesselInfo.vesselName || !vesselInfo.vesselId) {\n      Alert.alert('Error', 'Please fill in vessel name and ID');\n      return;\n    }\n\n    const user = await getCurrentUser();\n    if (user) {\n      await updateVesselInfo({\n        vesselName: vesselInfo.vesselName,\n        vesselId: vesselInfo.vesselId,\n        vesselType: vesselInfo.vesselType,\n        mmsi: vesselInfo.mmsi,\n        imo: vesselInfo.imo,\n      });\n\n      await saveBoatData({\n        userId: user.id,\n        vesselName: vesselInfo.vesselName,\n        vesselId: vesselInfo.vesselId,\n        vesselType: vesselInfo.vesselType,\n        mmsi: vesselInfo.mmsi,\n        imo: vesselInfo.imo,\n        updatedAt: new Date().toISOString(),\n      });\n\n      Alert.alert('Success', 'Vessel information saved to database');\n    }\n  };\n\n  const getWindSpeedUnit = () => {\n    // StormGlass API provides windSpeed in meters per second (m/s)\n    // Convert to knots for display\n    return 'kn';\n  };\n\n  const formatWindSpeed = (speedMs: number) => {\n    if (speedMs === undefined || speedMs === null) return 'N/A';\n    return (speedMs * 1.94384).toFixed(1); // m/s to knots\n  };\n\n  const formatWaveHeight = (heightMeters: number) => {\n    if (heightMeters === undefined || heightMeters === null) return 'N/A';\n    return `${(heightMeters * 3.28084).toFixed(1)} ft`; // meters to feet\n  };\n\n  return (\n    <View style={[styles.container, { backgroundColor: colors.background }]}>\n      <View style={[styles.header, { backgroundColor: colors.primary }]}>\n        <Text style={styles.headerTitle}>üõ∞Ô∏è AIS Location Tracker</Text>\n        <Text style={styles.headerSubtitle}>Broadcast your position to nearby vessels</Text>\n      </View>\n\n      <ScrollView style={styles.content}>\n        {/* Location Display */}\n        {currentLocation && (\n          <View style={[styles.mapContainer, { backgroundColor: colors.card }]}>\n            <Text style={[styles.sectionTitle, { color: colors.text }]}>üìç Your Location</Text>\n            <View style={styles.locationInfo}>\n              <Text style={[styles.coordinates, { color: colors.text }]}>\n                {currentLocation.latitude.toFixed(6)}¬∞N, {currentLocation.longitude.toFixed(6)}¬∞E\n              </Text>\n              <View style={styles.navigationInfo}>\n                <Text style={[styles.navText, { color: colors.icon }]}>\n                  ‚¨ÜÔ∏è Heading: {heading.toFixed(0)}¬∞ | üí® Speed: {speed.toFixed(1)} kn\n                </Text>\n              </View>\n            </View>\n          </View>\n        )}\n\n        {/* Tracking Status */}\n        <View style={[styles.statusCard, { backgroundColor: colors.card }]}>\n          <View style={styles.statusHeader}>\n            <View>\n              <Text style={[styles.statusTitle, { color: colors.text }]}>\n                {isTracking ? 'üü¢ Broadcasting' : 'üî¥ Offline'}\n              </Text>\n              <Text style={[styles.statusSubtitle, { color: colors.icon }]}>\n                {isTracking ? 'Your position is being shared' : 'Enable to broadcast your location'}\n              </Text>\n            </View>\n            <Switch\n              value={isTracking}\n              onValueChange={toggleTracking}\n              trackColor={{ false: colors.border, true: colors.accent }}\n              thumbColor={isTracking ? colors.primary : '#f4f4f4'}\n            />\n          </View>\n        </View>\n\n        {/* Vessel Information */}\n        <View style={[styles.section, { backgroundColor: colors.card }]}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>‚öì Vessel Information</Text>\n\n          <View style={styles.inputGroup}>\n            <Text style={[styles.label, { color: colors.icon }]}>Vessel Name *</Text>\n            <TextInput\n              style={[styles.input, { backgroundColor: colors.background, color: colors.text, borderColor: colors.border }]}\n              value={vesselInfo.vesselName}\n              onChangeText={(text) => setVesselInfo({ ...vesselInfo, vesselName: text })}\n              placeholder=\"e.g., Nelayan Jaya\"\n              placeholderTextColor={colors.icon}\n              editable={!isTracking} // Make inputs not editable while tracking\n            />\n          </View>\n\n          <View style={styles.inputGroup}>\n            <Text style={[styles.label, { color: colors.icon }]}>Vessel ID *</Text>\n            <TextInput\n              style={[styles.input, { backgroundColor: colors.background, color: colors.text, borderColor: colors.border }]}\n              value={vesselInfo.vesselId}\n              onChangeText={(text) => setVesselInfo({ ...vesselInfo, vesselId: text })}\n              placeholder=\"e.g., MYS-12345\"\n              placeholderTextColor={colors.icon}\n              editable={!isTracking}\n            />\n          </View>\n\n          <View style={styles.inputGroup}>\n            <Text style={[styles.label, { color: colors.icon }]}>Vessel Type</Text>\n            <TextInput\n              style={[styles.input, { backgroundColor: colors.background, color: colors.text, borderColor: colors.border }]}\n              value={vesselInfo.vesselType}\n              onChangeText={(text) => setVesselInfo({ ...vesselInfo, vesselType: text })}\n              placeholder=\"e.g., Fishing Vessel\"\n              placeholderTextColor={colors.icon}\n              editable={!isTracking}\n            />\n          </View>\n\n          <View style={styles.inputGroup}>\n            <Text style={[styles.label, { color: colors.icon }]}>MMSI (Optional)</Text>\n            <TextInput\n              style={[styles.input, { backgroundColor: colors.background, color: colors.text, borderColor: colors.border }]}\n              value={vesselInfo.mmsi}\n              onChangeText={(text) => setVesselInfo({ ...vesselInfo, mmsi: text })}\n              placeholder=\"9-digit MMSI number\"\n              placeholderTextColor={colors.icon}\n              keyboardType=\"numeric\"\n              editable={!isTracking}\n            />\n          </View>\n\n          <View style={styles.inputGroup}>\n            <Text style={[styles.label, { color: colors.icon }]}>IMO (Optional)</Text>\n            <TextInput\n              style={[styles.input, { backgroundColor: colors.background, color: colors.text, borderColor: colors.border }]}\n              value={vesselInfo.imo}\n              onChangeText={(text) => setVesselInfo({ ...vesselInfo, imo: text })}\n              placeholder=\"7-digit IMO number\"\n              placeholderTextColor={colors.icon}\n              keyboardType=\"numeric\"\n              editable={!isTracking}\n            />\n          </View>\n\n          <TouchableOpacity\n            style={[styles.saveButton, { backgroundColor: colors.secondary }]}\n            onPress={handleSaveVesselInfo}\n            disabled={isTracking} // Disable save button while tracking\n          >\n            <Text style={styles.saveButtonText}>üíæ Save Vessel Info</Text>\n          </TouchableOpacity>\n        </View>\n\n        {/* Status Selection */}\n        <View style={[styles.section, { backgroundColor: colors.card }]}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>üìä Vessel Status</Text>\n          <View style={styles.statusButtons}>\n            {(['Active', 'Idle', 'Anchored'] as const).map((s) => (\n              <TouchableOpacity\n                key={s}\n                style={[\n                  styles.statusButton,\n                  { borderColor: colors.border },\n                  status === s && { backgroundColor: colors.primary }\n                ]}\n                onPress={() => setStatus(s)}\n                disabled={!isTracking} // Only allow status change when tracking\n              >\n                <Text style={[styles.statusButtonText, { color: status === s ? '#fff' : colors.text }]}>\n                  {s}\n                </Text>\n              </TouchableOpacity>\n            ))}\n          </View>\n        </View>\n\n        {/* Nearby Vessels */}\n        {isTracking && nearbyVessels.length > 0 && (\n          <View style={[styles.section, { backgroundColor: colors.card }]}>\n            <Text style={[styles.sectionTitle, { color: colors.text }]}>\n              üö¢ Nearby Tracked Vessels ({nearbyVessels.length})\n            </Text>\n            {nearbyVessels.map((vessel, index) => (\n              <View key={index} style={[styles.vesselItem, { borderColor: colors.border }]}>\n                <Text style={[styles.vesselName, { color: colors.text }]}>\n                  {vessel.vesselInfo.vesselName}\n                </Text>\n                <Text style={[styles.vesselDetails, { color: colors.icon }]}>\n                  {vessel.vesselInfo.vesselType} ‚Ä¢ {vessel.status}\n                </Text>\n              </View>\n            ))}\n          </View>\n        )}\n\n        {/* Weather Information */}\n        {weatherData && (\n          <View style={[styles.section, { backgroundColor: colors.card }]}>\n            <Text style={[styles.sectionTitle, { color: colors.text }]}>‚òÄÔ∏è Weather Conditions</Text>\n            <View style={styles.weatherInfo}>\n              <Text style={[styles.weatherDetail, { color: colors.icon }]}>\n                Wind: {formatWindSpeed(weatherData.windSpeed?.value)} {getWindSpeedUnit()}\n              </Text>\n              <Text style={[styles.weatherDetail, { color: colors.icon }]}>\n                Wave Height: {formatWaveHeight(weatherData.waveHeight?.value)}\n              </Text>\n              <Text style={[styles.weatherDetail, { color: colors.icon }]}>\n                Air Temp: {weatherData.airTemperature?.value}¬∞C\n              </Text>\n            </View>\n          </View>\n        )}\n\n\n        {/* Information */}\n        <View style={[styles.infoCard, { backgroundColor: colors.card, borderColor: colors.border }]}>\n          <Text style={[styles.infoTitle, { color: colors.text }]}>‚ÑπÔ∏è How It Works</Text>\n          <Text style={[styles.infoText, { color: colors.icon }]}>\n            ‚Ä¢ Your phone acts as an AIS beacon when tracking is enabled{'\\n'}\n            ‚Ä¢ Location is updated frequently for real-time tracking{'\\n'}\n            ‚Ä¢ Other MarineTrack users can see your vessel within a 10km radius{'\\n'}\n            ‚Ä¢ All data is sent securely to the backend for real-time tracking{'\\n'}\n            ‚Ä¢ Tracking stops automatically when you close the app\n          </Text>\n        </View>\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    paddingTop: 50,\n    paddingBottom: 20,\n    paddingHorizontal: 20,\n  },\n  headerTitle: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#fff',\n  },\n  headerSubtitle: {\n    fontSize: 14,\n    color: '#fff',\n    opacity: 0.9,\n    marginTop: 4,\n  },\n  content: {\n    flex: 1,\n    padding: 16,\n  },\n  mapContainer: {\n    padding: 16,\n    borderRadius: 12,\n    marginBottom: 16,\n  },\n  statusCard: {\n    padding: 16,\n    borderRadius: 12,\n    marginBottom: 16,\n  },\n  statusHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  statusTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  statusSubtitle: {\n    fontSize: 12,\n    marginTop: 4,\n  },\n  locationInfo: {\n    marginTop: 16,\n    paddingTop: 16,\n    borderTopWidth: 1,\n    borderTopColor: '#e0e0e0',\n  },\n  coordinates: {\n    fontSize: 14,\n    fontWeight: '600',\n  },\n  navigationInfo: {\n    marginTop: 8,\n  },\n  navText: {\n    fontSize: 12,\n  },\n  section: {\n    padding: 16,\n    borderRadius: 12,\n    marginBottom: 16,\n  },\n  sectionTitle: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  inputGroup: {\n    marginBottom: 12,\n  },\n  label: {\n    fontSize: 12,\n    marginBottom: 6,\n    fontWeight: '600',\n  },\n  input: {\n    borderWidth: 1,\n    borderRadius: 8,\n    padding: 12,\n    fontSize: 14,\n  },\n  saveButton: {\n    paddingVertical: 14,\n    borderRadius: 8,\n    alignItems: 'center',\n    marginTop: 8,\n  },\n  saveButtonText: {\n    color: '#fff',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  statusButtons: {\n    flexDirection: 'row',\n    gap: 12,\n  },\n  statusButton: {\n    flex: 1,\n    paddingVertical: 12,\n    borderRadius: 8,\n    borderWidth: 2,\n    alignItems: 'center',\n  },\n  statusButtonText: {\n    fontSize: 14,\n    fontWeight: '600',\n  },\n  vesselItem: {\n    paddingVertical: 12,\n    borderBottomWidth: 1,\n  },\n  vesselName: {\n    fontSize: 14,\n    fontWeight: '600',\n  },\n  vesselDetails: {\n    fontSize: 12,\n    marginTop: 4,\n  },\n  infoCard: {\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginBottom: 20,\n  },\n  infoTitle: {\n    fontSize: 14,\n    fontWeight: 'bold',\n    marginBottom: 8,\n  },\n  infoText: {\n    fontSize: 12,\n    lineHeight: 18,\n  },\n  weatherInfo: {\n    marginTop: 8,\n  },\n  weatherDetail: {\n    fontSize: 12,\n    marginBottom: 4,\n  },\n});","size_bytes":25063},"replit.md":{"content":"# MarineTrack Mobile Application\n\n**Last Updated:** October 30, 2025\n\n## Overview\nMarineTrack is a cross-platform mobile application designed for fishermen, seafarers, and small vessel operators to enhance safety, communication, and sustainable fishing at sea. Built with React Native and Expo for web, iOS, and Android platforms.\n\n## Project Purpose\nThis is a **functional prototype** demonstrating the complete UI/UX flow and core features of the MarineTrack application. The app uses mock data for demonstration purposes and is ready for backend integration.\n\n## Current State\n‚úÖ **Completed Features:**\n- Ocean-themed UI design (deep navy, ocean blue, seafoam colors)\n- Complete onboarding flow (3 slides)\n- Authentication screens (login/register)\n- Main dashboard with map placeholder and vessel tracking UI\n- Weather & Navigation screen with forecast display\n- SOS Emergency screen with alert functionality\n- Communication/Chat screen for vessel contacts\n- Settings & Profile screen with sustainable fishing tips\n- Tab-based navigation with 5 main sections\n- Responsive design optimized for mobile and web\n\n## Architecture\n\n### Screen Flow\n```\napp/\n‚îú‚îÄ‚îÄ index.tsx                    # Entry point (redirects to onboarding)\n‚îú‚îÄ‚îÄ onboarding.tsx              # 3-slide onboarding\n‚îú‚îÄ‚îÄ auth/\n‚îÇ   ‚îú‚îÄ‚îÄ login.tsx               # Login screen\n‚îÇ   ‚îú‚îÄ‚îÄ register.tsx            # Registration with vessel info\n‚îÇ   ‚îî‚îÄ‚îÄ _layout.tsx             # Auth navigation\n‚îî‚îÄ‚îÄ (tabs)/\n    ‚îú‚îÄ‚îÄ index.tsx               # Dashboard (map, vessels, weather)\n    ‚îú‚îÄ‚îÄ weather.tsx             # Weather forecasts & alerts\n    ‚îú‚îÄ‚îÄ sos.tsx                 # Emergency SOS\n    ‚îú‚îÄ‚îÄ chat.tsx                # Vessel communication\n    ‚îú‚îÄ‚îÄ settings.tsx            # Profile & settings\n    ‚îî‚îÄ‚îÄ _layout.tsx             # Tab navigation\n```\n\n### Tech Stack\n- **Frontend:** React Native + Expo\n- **Navigation:** Expo Router (file-based routing)\n- **Styling:** StyleSheet with themed colors\n- **State:** React Hooks (useState)\n- **Platform:** Web (port 5000), iOS, Android\n\n## Features\n\n### 1. Dashboard\n- Live GPS coordinates display\n- Nearby vessels list with distance and status\n- Weather summary (temperature, wind, waves)\n- Quick action buttons (SOS, Weather, Fishing zones)\n\n### 2. Weather & Navigation\n- Current weather conditions\n- Hourly forecast\n- Weather alerts\n- Safety tips for maritime navigation\n\n### 3. SOS Emergency\n- Large emergency button\n- GPS location sharing\n- Emergency contact list\n- Step-by-step emergency instructions\n\n### 4. Communication\n- Vessel-to-vessel chat\n- Contact list with location tracking\n- Message history\n- \"Last seen\" status\n\n### 5. Settings & Profile\n- User and vessel information\n- Notification preferences\n- Emergency contacts management\n- Sustainable fishing tips and best practices\n\n## Recent Changes\n**October 30, 2025:**\n- Created complete app structure with 13 screens\n- Implemented ocean-themed color scheme\n- Built navigation flow: onboarding ‚Üí auth ‚Üí main app\n- Added mock data for vessels, weather, contacts\n- Configured Expo web workflow on port 5000\n- Fixed deprecated shadow style props\n\n## Next Steps for Production\n\n### Backend Integration\n1. **Authentication:** Integrate Firebase Authentication or Supabase Auth\n   - Implement sign-up/sign-in flows\n   - Add session persistence\n   - Gate tab navigation behind auth state\n\n2. **Real-time Data:**\n   - Add MapView component (react-native-maps)\n   - Integrate OpenWeatherMap or StormGlass API for weather\n   - Set up vessel tracking with GPS\n   - Implement real-time chat with Firebase/Supabase\n\n3. **Emergency Features:**\n   - Connect SOS to Twilio for SMS alerts\n   - Integrate push notifications (FCM)\n   - Add offline data persistence\n\n### Additional Features\n- Fishing zone map overlays\n- Route planning and navigation\n- Vessel history tracking\n- Multi-language support\n- Offline-first data sync\n\n## User Preferences\n- Focus on maritime safety and sustainability\n- Ocean-themed visual design\n- Simple, intuitive interface for use at sea\n- Prototype with mock data for demonstration\n\n## Development Commands\n```bash\nnpm start -- --web --port 5000   # Start web development server\nnpm run android                   # Run on Android\nnpm run ios                       # Run on iOS\n```\n\n## Notes\n- This is a prototype with mock data - backend integration required for production\n- All API integrations are placeholder UI flows\n- Map component is a visual placeholder (ready for MapView integration)\n- Colors defined in `constants/Colors.ts` for easy theming\n","size_bytes":4614},"utils/auth.ts":{"content":"\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nexport interface User {\n  id: string;\n  email: string | null;\n  name: string;\n  photoUrl?: string;\n  isGuest: boolean;\n  vesselInfo?: {\n    vesselName: string;\n    vesselId: string;\n    vesselType: string;\n  };\n  createdAt: string;\n}\n\ninterface StoredCredentials {\n  email: string;\n  password: string;\n  userId: string;\n}\n\nconst STORAGE_KEY = '@marinetrack_user';\nconst GUEST_USER_KEY = '@marinetrack_guest_id';\nconst CREDENTIALS_KEY = '@marinetrack_credentials';\n\n// Store user credentials\nexport const storeCredentials = async (email: string, password: string, userId: string): Promise<void> => {\n  try {\n    const credentials: StoredCredentials = { email, password, userId };\n    await AsyncStorage.setItem(CREDENTIALS_KEY, JSON.stringify(credentials));\n  } catch (error) {\n    console.error('Error storing credentials:', error);\n  }\n};\n\n// Get stored credentials\nexport const getStoredCredentials = async (): Promise<StoredCredentials[]> => {\n  try {\n    const stored = await AsyncStorage.getItem(CREDENTIALS_KEY);\n    return stored ? [JSON.parse(stored)] : [];\n  } catch (error) {\n    console.error('Error getting credentials:', error);\n    return [];\n  }\n};\n\n// Login with email and password\nexport const loginWithEmailPassword = async (email: string, password: string): Promise<boolean> => {\n  try {\n    const credentials = await getStoredCredentials();\n    const match = credentials.find(c => c.email === email && c.password === password);\n    \n    if (match) {\n      const user: User = {\n        id: match.userId,\n        email,\n        name: email.split('@')[0],\n        isGuest: false,\n        createdAt: new Date().toISOString()\n      };\n      await storeUser(user);\n      return true;\n    }\n    return false;\n  } catch (error) {\n    console.error('Error logging in:', error);\n    return false;\n  }\n};\n\n// Register new user\nexport const registerUser = async (email: string, password: string, name: string): Promise<boolean> => {\n  try {\n    const userId = `user_${Date.now()}`;\n    await storeCredentials(email, password, userId);\n    \n    const user: User = {\n      id: userId,\n      email,\n      name,\n      isGuest: false,\n      createdAt: new Date().toISOString()\n    };\n    await storeUser(user);\n    return true;\n  } catch (error) {\n    console.error('Error registering user:', error);\n    return false;\n  }\n};\n\n// Store user data\nexport const storeUser = async (user: User): Promise<void> => {\n  try {\n    await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(user));\n  } catch (error) {\n    console.error('Error storing user:', error);\n  }\n};\n\n// Get current user\nexport const getCurrentUser = async (): Promise<User | null> => {\n  try {\n    const userData = await AsyncStorage.getItem(STORAGE_KEY);\n    return userData ? JSON.parse(userData) : null;\n  } catch (error) {\n    console.error('Error getting user:', error);\n    return null;\n  }\n};\n\n// Create guest user\nexport const createGuestUser = async (): Promise<User> => {\n  let guestId = await AsyncStorage.getItem(GUEST_USER_KEY);\n  \n  if (!guestId) {\n    guestId = `guest_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    await AsyncStorage.setItem(GUEST_USER_KEY, guestId);\n  }\n\n  const guestUser: User = {\n    id: guestId,\n    email: null,\n    name: 'Guest User',\n    isGuest: true,\n    createdAt: new Date().toISOString()\n  };\n\n  await storeUser(guestUser);\n  return guestUser;\n};\n\n// Sign out\nexport const signOut = async (): Promise<void> => {\n  try {\n    await AsyncStorage.removeItem(STORAGE_KEY);\n  } catch (error) {\n    console.error('Error signing out:', error);\n  }\n};\n\n// Check if user is authenticated\nexport const isAuthenticated = async (): Promise<boolean> => {\n  const user = await getCurrentUser();\n  return user !== null;\n};\n\n// Update vessel info\nexport const updateVesselInfo = async (vesselInfo: User['vesselInfo']): Promise<void> => {\n  try {\n    const user = await getCurrentUser();\n    if (user) {\n      user.vesselInfo = vesselInfo;\n      await storeUser(user);\n    }\n  } catch (error) {\n    console.error('Error updating vessel info:', error);\n  }\n};\n","size_bytes":4140},"app/(tabs)/weather.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { View, Text, StyleSheet, ScrollView } from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { fetchWeatherAPIData, getMockHourlyForecast, getMockWeatherData } from '@/utils/weatherApi';\n\nexport default function WeatherScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const [weatherData, setWeatherData] = useState(getMockWeatherData());\n  const [hourlyForecast, setHourlyForecast] = useState(getMockHourlyForecast());\n\n  useEffect(() => {\n    const loadWeather = async () => {\n      const data = await fetchWeatherAPIData(14.5995, 120.9842);\n      if (data && data.current) {\n        setWeatherData({\n          temperature: Math.round(data.current.temp_c),\n          windSpeed: Math.round(data.current.wind_kph),\n          waveHeight: 1.2,\n          visibility: Math.round(data.current.vis_km),\n          condition: data.current.condition.text,\n          icon: '‚õÖ'\n        });\n      }\n    };\n    loadWeather();\n  }, []);\n\n  const alerts = [\n    { id: 1, type: 'warning', message: 'Strong winds expected after 2 PM - up to 25 km/h', severity: 'medium' },\n    { id: 2, type: 'info', message: 'Good fishing conditions in the morning hours', severity: 'low' },\n    { id: 3, type: 'warning', message: 'Wave height increasing to 1.5m in the afternoon', severity: 'medium' },\n    { id: 4, type: 'info', message: 'Visibility excellent for navigation (8+ km)', severity: 'low' },\n  ];\n\n  return (\n    <ScrollView style={[styles.container, { backgroundColor: colors.background }]}>\n      <View style={[styles.header, { backgroundColor: colors.primary }]}>\n        <Text style={styles.headerTitle}>Weather & Navigation</Text>\n        <Text style={styles.headerSubtitle}>Marine Weather Forecast</Text>\n      </View>\n\n      <View style={[styles.currentWeather, { backgroundColor: colors.card }]}>\n        <Text style={styles.currentIcon}>{weatherData.icon}</Text>\n        <Text style={[styles.currentTemp, { color: colors.text }]}>{weatherData.temperature}¬∞C</Text>\n        <Text style={[styles.currentCondition, { color: colors.icon }]}>{weatherData.condition}</Text>\n        <View style={styles.currentDetails}>\n          <View style={styles.detailItem}>\n            <Text style={styles.detailIcon}>üí®</Text>\n            <Text style={[styles.detailText, { color: colors.text }]}>{weatherData.windSpeed} km/h</Text>\n            <Text style={[styles.detailLabel, { color: colors.icon }]}>Wind</Text>\n          </View>\n          <View style={styles.detailItem}>\n            <Text style={styles.detailIcon}>üåä</Text>\n            <Text style={[styles.detailText, { color: colors.text }]}>{weatherData.waveHeight} m</Text>\n            <Text style={[styles.detailLabel, { color: colors.icon }]}>Waves</Text>\n          </View>\n          <View style={styles.detailItem}>\n            <Text style={styles.detailIcon}>üëÅÔ∏è</Text>\n            <Text style={[styles.detailText, { color: colors.text }]}>{weatherData.visibility} km</Text>\n            <Text style={[styles.detailLabel, { color: colors.icon }]}>Visibility</Text>\n          </View>\n        </View>\n      </View>\n\n      {alerts.length > 0 && (\n        <View style={styles.alertsSection}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>‚ö†Ô∏è Alerts</Text>\n          {alerts.map((alert) => (\n            <View\n              key={alert.id}\n              style={[\n                styles.alertCard,\n                {\n                  backgroundColor: alert.severity === 'medium' ? colors.danger : colors.card,\n                  borderColor: colors.border,\n                },\n              ]}\n            >\n              <Text\n                style={[\n                  styles.alertText,\n                  { color: alert.severity === 'medium' ? '#fff' : colors.text },\n                ]}\n              >\n                {alert.message}\n              </Text>\n            </View>\n          ))}\n        </View>\n      )}\n\n      <View style={styles.forecastSection}>\n        <Text style={[styles.sectionTitle, { color: colors.text }]}>Hourly Forecast</Text>\n        <ScrollView horizontal showsHorizontalScrollIndicator={false} style={styles.hourlyScroll}>\n          {hourlyForecast.map((hour, index) => (\n            <View\n              key={index}\n              style={[styles.hourCard, { backgroundColor: colors.card, borderColor: colors.border }]}\n            >\n              <Text style={[styles.hourTime, { color: colors.icon }]}>{hour.time}</Text>\n              <Text style={styles.hourIcon}>{hour.icon}</Text>\n              <Text style={[styles.hourTemp, { color: colors.text }]}>{hour.temp}</Text>\n              <Text style={[styles.hourCondition, { color: colors.icon }]}>{hour.condition}</Text>\n              <Text style={[styles.hourWind, { color: colors.icon }]}>üí® {hour.wind}</Text>\n            </View>\n          ))}\n        </ScrollView>\n      </View>\n\n      <View style={[styles.safetyTips, { backgroundColor: colors.card, borderColor: colors.border }]}>\n        <Text style={[styles.tipsTitle, { color: colors.primary }]}>üß≠ Safety Tips</Text>\n        <Text style={[styles.tipText, { color: colors.text }]}>\n          ‚Ä¢ Check weather updates every 2 hours{'\\n'}\n          ‚Ä¢ Avoid sailing in winds above 25 km/h{'\\n'}\n          ‚Ä¢ Monitor wave heights for safe navigation{'\\n'}\n          ‚Ä¢ Keep emergency contacts ready\n        </Text>\n      </View>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    paddingTop: 50,\n    paddingBottom: 20,\n    paddingHorizontal: 20,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#fff',\n  },\n  headerSubtitle: {\n    fontSize: 14,\n    color: '#fff',\n    opacity: 0.9,\n    marginTop: 4,\n  },\n  currentWeather: {\n    margin: 16,\n    padding: 24,\n    borderRadius: 16,\n    alignItems: 'center',\n  },\n  currentIcon: {\n    fontSize: 80,\n    marginBottom: 12,\n  },\n  currentTemp: {\n    fontSize: 48,\n    fontWeight: 'bold',\n  },\n  currentCondition: {\n    fontSize: 18,\n    marginTop: 8,\n  },\n  currentDetails: {\n    flexDirection: 'row',\n    gap: 32,\n    marginTop: 24,\n  },\n  detailItem: {\n    alignItems: 'center',\n  },\n  detailIcon: {\n    fontSize: 28,\n    marginBottom: 4,\n  },\n  detailText: {\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  detailLabel: {\n    fontSize: 12,\n    marginTop: 4,\n  },\n  alertsSection: {\n    paddingHorizontal: 16,\n    marginBottom: 16,\n  },\n  sectionTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  alertCard: {\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginBottom: 8,\n  },\n  alertText: {\n    fontSize: 14,\n    lineHeight: 20,\n  },\n  forecastSection: {\n    paddingLeft: 16,\n    marginBottom: 16,\n  },\n  hourlyScroll: {\n    marginRight: 16,\n  },\n  hourCard: {\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginRight: 12,\n    alignItems: 'center',\n    width: 100,\n  },\n  hourTime: {\n    fontSize: 12,\n    marginBottom: 8,\n  },\n  hourIcon: {\n    fontSize: 32,\n    marginBottom: 8,\n  },\n  hourTemp: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 4,\n  },\n  hourCondition: {\n    fontSize: 10,\n    marginBottom: 4,\n    textAlign: 'center',\n  },\n  hourWind: {\n    fontSize: 11,\n  },\n  safetyTips: {\n    margin: 16,\n    padding: 20,\n    borderRadius: 12,\n    borderWidth: 1,\n  },\n  tipsTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  tipText: {\n    fontSize: 14,\n    lineHeight: 24,\n  },\n});\n","size_bytes":7630},"app/(tabs)/map.tsx":{"content":"import React, { useState, useEffect, useRef } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  TextInput,\n  ScrollView,\n  Platform,\n  Dimensions,\n  Modal,\n  KeyboardAvoidingView,\n} from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { getNearbyTrackedVessels } from '@/utils/trackingService';\nimport { getCurrentUser } from '@/utils/auth';\nimport { sendMessage, getChatMessages, getChatRoom, subscribeToMessages } from '@/utils/realtimeChat';\nimport * as Location from 'expo-location';\n\nlet MapView: any = null;\nlet Marker: any = null;\nlet PROVIDER_GOOGLE: any = null;\n\nconst { width, height } = Dimensions.get('window');\n\ninterface Vessel {\n  id: string;\n  name: string;\n  type: string;\n  latitude: number;\n  longitude: number;\n  speed: number;\n  heading: number;\n  distance: number;\n  status: string;\n}\n\nexport default function MapScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const [userLocation, setUserLocation] = useState<{ latitude: number; longitude: number } | null>(null);\n  const [vessels, setVessels] = useState<Vessel[]>([]);\n  const [selectedVessel, setSelectedVessel] = useState<Vessel | null>(null);\n  const [showChatModal, setShowChatModal] = useState(false);\n  const [message, setMessage] = useState('');\n  const [messages, setMessages] = useState<any[]>([]);\n  const [currentUser, setCurrentUser] = useState<any>(null);\n  const [chatId, setChatId] = useState<string>('');\n  const [region, setRegion] = useState({\n    latitude: 3.1390,\n    longitude: 101.6869,\n    latitudeDelta: 0.5,\n    longitudeDelta: 0.5,\n  });\n\n  const locationSubscriptionRef = useRef<Location.LocationSubscription | null>(null);\n  const chatUnsubscribeRef = useRef<(() => void) | null>(null);\n  const isMountedRef = useRef<boolean>(true);\n\n  useEffect(() => {\n    isMountedRef.current = true;\n    loadCurrentUser();\n\n    // Dynamically load react-native-maps only on native platforms\n    if (Platform.OS !== 'web') {\n      import('react-native-maps').then((MapModule) => {\n        MapView = MapModule.default;\n        Marker = MapModule.Marker;\n        PROVIDER_GOOGLE = MapModule.PROVIDER_GOOGLE;\n        console.log('react-native-maps loaded successfully');\n      }).catch((error) => {\n        console.error('Failed to load react-native-maps:', error);\n        console.log('Map will use fallback list view');\n      });\n    } else {\n      console.log('Running on web - using fallback map view');\n    }\n\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    let isActive = true;\n\n    const setupLocation = async () => {\n      try {\n        const { status } = await Location.requestForegroundPermissionsAsync();\n        if (status !== 'granted') {\n          console.log('Location permission denied');\n          return;\n        }\n        \n        if (!isActive) return;\n\n        const location = await Location.getCurrentPositionAsync({\n          accuracy: Location.Accuracy.Balanced,\n        });\n        \n        if (!isActive) return;\n\n        const newLocation = {\n          latitude: location.coords.latitude,\n          longitude: location.coords.longitude,\n        };\n        \n        setUserLocation(newLocation);\n        setRegion({\n          ...newLocation,\n          latitudeDelta: 0.1,\n          longitudeDelta: 0.1,\n        });\n\n        console.log('Map centered at:', newLocation.latitude.toFixed(4), newLocation.longitude.toFixed(4));\n\n        const subscription = await Location.watchPositionAsync(\n          {\n            accuracy: Location.Accuracy.High,\n            timeInterval: 10000,\n            distanceInterval: 50,\n          },\n          (location) => {\n            if (isActive) {\n              setUserLocation({\n                latitude: location.coords.latitude,\n                longitude: location.coords.longitude,\n              });\n            }\n          }\n        );\n\n        if (isActive) {\n          locationSubscriptionRef.current = subscription;\n        } else {\n          subscription.remove();\n        }\n      } catch (error) {\n        console.log('Error getting location');\n      }\n    };\n\n    setupLocation();\n\n    return () => {\n      isActive = false;\n      if (locationSubscriptionRef.current) {\n        locationSubscriptionRef.current.remove();\n        locationSubscriptionRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!userLocation) return;\n\n    loadVessels();\n    const interval = setInterval(() => {\n      loadVessels();\n    }, 5000);\n\n    return () => clearInterval(interval);\n  }, [userLocation]);\n\n  useEffect(() => {\n    let isActive = true;\n\n    const setupChatAsync = async () => {\n      if (!selectedVessel || !currentUser || !showChatModal) return;\n\n      const roomId = await getChatRoom(currentUser.id, selectedVessel.id);\n      if (!isActive) return;\n\n      setChatId(roomId);\n\n      const chatMessages = await getChatMessages(roomId);\n      if (!isActive) return;\n\n      setMessages(chatMessages);\n\n      const subscription = subscribeToMessages(roomId, (newMessage) => {\n        if (isActive && newMessage.senderId !== currentUser.id) {\n          setMessages(prev => [...prev, newMessage]);\n        }\n      });\n\n      const unsubscribe = () => subscription?.unsubscribe();\n\n      if (isActive) {\n        chatUnsubscribeRef.current = unsubscribe;\n      } else {\n        unsubscribe();\n      }\n    };\n\n    setupChatAsync();\n\n    return () => {\n      isActive = false;\n      if (chatUnsubscribeRef.current) {\n        chatUnsubscribeRef.current();\n        chatUnsubscribeRef.current = null;\n      }\n    };\n  }, [selectedVessel, currentUser, showChatModal]);\n\n  const loadCurrentUser = async () => {\n    const user = await getCurrentUser();\n    if (isMountedRef.current) {\n      setCurrentUser(user);\n    }\n  };\n\n  const loadVessels = async () => {\n    if (!userLocation) return;\n\n    try {\n      // Get nearby tracked vessels from the tracking service (which now uses database)\n      const trackedVessels = await getNearbyTrackedVessels(\n        userLocation.latitude,\n        userLocation.longitude,\n        100 // 100km radius for better detection\n      );\n\n      if (!isMountedRef.current) return;\n\n      // Convert tracked vessels to the format expected by the map\n      const formattedVessels = trackedVessels.map((vessel, index) => ({\n        id: vessel.id || `vessel-${index}`,\n        name: vessel.vesselInfo?.vesselName || 'Unknown Vessel',\n        type: vessel.vesselInfo?.vesselType || 'Vessel',\n        latitude: vessel.location.latitude,\n        longitude: vessel.location.longitude,\n        speed: vessel.location.speed || 0,\n        heading: vessel.location.heading || 0,\n        status: vessel.status || 'Active',\n        distance: calculateDistance(\n          userLocation.latitude,\n          userLocation.longitude,\n          vessel.location.latitude,\n          vessel.location.longitude\n        ),\n      }));\n\n      setVessels(formattedVessels);\n      if (formattedVessels.length > 0) {\n        console.log(`Map displaying ${formattedVessels.length} active vessels`);\n      }\n    } catch (error) {\n      // Silently fail - no console errors\n      if (isMountedRef.current) {\n        setVessels([]);\n      }\n    }\n  };\n\n  const calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number): number => {\n    const R = 6371;\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = \n      Math.sin(dLat/2) * Math.sin(dLat/2) +\n      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n      Math.sin(dLon/2) * Math.sin(dLon/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    return R * c;\n  };\n\n  const handleVesselPress = (vessel: Vessel) => {\n    setSelectedVessel(vessel);\n    setShowChatModal(true);\n  };\n\n  const setupChat = async () => {\n    if (!selectedVessel || !currentUser) return;\n\n    const roomId = await getChatRoom(currentUser.id, selectedVessel.id);\n    setChatId(roomId);\n\n    const chatMessages = await getChatMessages(roomId);\n    setMessages(chatMessages);\n\n    const subscription = subscribeToMessages(roomId, (newMessage) => {\n      if (newMessage.senderId !== currentUser.id) {\n        setMessages(prev => [...prev, newMessage]);\n      }\n    });\n\n    return () => subscription?.unsubscribe();\n  };\n\n  const handleSendMessage = async () => {\n    if (!message.trim() || !currentUser || !chatId) return;\n\n    const newMessage = await sendMessage(\n      chatId,\n      currentUser.id,\n      currentUser.name,\n      message.trim()\n    );\n\n    if (!isMountedRef.current) return;\n\n    setMessages(prev => [...prev, newMessage]);\n    setMessage('');\n  };\n\n  const closeChat = () => {\n    setShowChatModal(false);\n    setSelectedVessel(null);\n    setMessages([]);\n  };\n\n  if (Platform.OS === 'web') {\n    return (\n      <View style={[styles.container, { backgroundColor: colors.background }]}>\n        <View style={[styles.header, { backgroundColor: colors.primary }]}>\n          <Text style={styles.headerTitle}>Live Vessel Map</Text>\n          <Text style={styles.headerSubtitle}>Real-time tracking of all vessels</Text>\n        </View>\n        <View style={[styles.webMapPlaceholder, { backgroundColor: colors.card }]}>\n          <Text style={[styles.webMapText, { color: colors.text }]}>\n            üó∫Ô∏è Real-Time Vessel Map\n          </Text>\n          <Text style={[styles.webMapSubtext, { color: colors.icon }]}>\n            Interactive map with live vessel tracking and communication is available on mobile devices.\n          </Text>\n          <View style={styles.vesselListContainer}>\n            <Text style={[styles.sectionTitle, { color: colors.text }]}>Nearby Vessels ({vessels.length})</Text>\n            <ScrollView>\n              {vessels.map((vessel) => (\n                <View\n                  key={vessel.id}\n                  style={[styles.vesselCard, { backgroundColor: colors.background, borderColor: colors.border }]}\n                >\n                  <Text style={[styles.vesselName, { color: colors.text }]}>\n                    üö¢ {vessel.name}\n                  </Text>\n                  <Text style={[styles.vesselDetails, { color: colors.icon }]}>\n                    {vessel.type} ‚Ä¢ {vessel.distance.toFixed(1)} km away\n                  </Text>\n                </View>\n              ))}\n            </ScrollView>\n          </View>\n        </View>\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.header, { backgroundColor: colors.primary }]}>\n        <Text style={styles.headerTitle}>Live Vessel Map</Text>\n        <Text style={styles.headerSubtitle}>Tap vessels to communicate ‚Ä¢ {vessels.length} vessels online</Text>\n      </View>\n\n      <View style={styles.mapContainer}>\n        {userLocation && MapView && Marker ? (\n          <MapView\n            style={styles.map}\n            provider={PROVIDER_GOOGLE}\n            region={region}\n            showsUserLocation={true}\n            showsMyLocationButton={true}\n            showsCompass={true}\n            onRegionChangeComplete={setRegion}\n          >\n            {/* User's vessel */}\n            {userLocation && (\n              <Marker\n                coordinate={userLocation}\n                title=\"My Vessel\"\n                description={currentUser?.name || 'You'}\n                pinColor=\"#FF3B30\"\n              >\n                <View style={[styles.markerContainer, { backgroundColor: colors.danger }]}>\n                  <Text style={styles.markerIcon}>üìç</Text>\n                </View>\n              </Marker>\n            )}\n\n            {/* Other vessels */}\n            {vessels.map((vessel) => (\n              <Marker\n                key={vessel.id}\n                coordinate={{\n                  latitude: vessel.latitude,\n                  longitude: vessel.longitude,\n                }}\n                title={vessel.name}\n                description={`${vessel.type} ‚Ä¢ ${vessel.distance.toFixed(1)} km`}\n                onPress={() => handleVesselPress(vessel)}\n              >\n                <View style={[styles.markerContainer, { backgroundColor: colors.primary }]}>\n                  <Text style={styles.markerIcon}>üö¢</Text>\n                </View>\n              </Marker>\n            ))}\n          </MapView>\n        ) : (\n          <View style={[styles.webMapView, { backgroundColor: colors.card }]}>\n            <Text style={[styles.webMapTitle, { color: colors.text }]}>üó∫Ô∏è Live Map</Text>\n            <Text style={[styles.webMapCoords, { color: colors.icon }]}>\n              {userLocation ? `üìç ${userLocation.latitude.toFixed(4)}¬∞N, ${userLocation.longitude.toFixed(4)}¬∞E` : 'Getting location...'}\n            </Text>\n            <ScrollView style={styles.vesselListWeb}>\n              {vessels.map((vessel) => (\n                <TouchableOpacity\n                  key={vessel.id}\n                  style={[styles.vesselCardWeb, { backgroundColor: colors.background, borderColor: colors.border }]}\n                  onPress={() => handleVesselPress(vessel)}\n                >\n                  <Text style={styles.vesselIconWeb}>üö¢</Text>\n                  <View style={styles.vesselInfoWeb}>\n                    <Text style={[styles.vesselNameWeb, { color: colors.text }]}>{vessel.name}</Text>\n                    <Text style={[styles.vesselDetailsWeb, { color: colors.icon }]}>\n                      {vessel.type} ‚Ä¢ {vessel.distance.toFixed(1)} km ‚Ä¢ {vessel.speed.toFixed(1)} kn\n                    </Text>\n                  </View>\n                </TouchableOpacity>\n              ))}\n            </ScrollView>\n          </View>\n        )}\n\n        {/* Legend */}\n        <View style={[styles.legend, { backgroundColor: colors.card }]}>\n          <Text style={[styles.legendTitle, { color: colors.text }]}>\n            Active Vessels: {vessels.length + 1}\n          </Text>\n          <Text style={[styles.legendItem, { color: colors.icon }]}>\n            üìç You ‚Ä¢ üö¢ Others (Tap to chat)\n          </Text>\n        </View>\n      </View>\n\n      {/* Chat Modal */}\n      <Modal\n        visible={showChatModal}\n        animationType=\"slide\"\n        onRequestClose={closeChat}\n      >\n        <KeyboardAvoidingView \n          style={[styles.modalContainer, { backgroundColor: colors.background }]}\n          behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        >\n          <View style={[styles.chatHeader, { backgroundColor: colors.card, borderBottomColor: colors.border }]}>\n            <TouchableOpacity onPress={closeChat}>\n              <Text style={[styles.backButton, { color: colors.primary }]}>‚Üê Back to Map</Text>\n            </TouchableOpacity>\n            {selectedVessel && (\n              <View style={styles.chatHeaderInfo}>\n                <Text style={[styles.chatHeaderName, { color: colors.text }]}>\n                  üö¢ {selectedVessel.name}\n                </Text>\n                <Text style={[styles.chatHeaderStatus, { color: colors.icon }]}>\n                  {selectedVessel.type} ‚Ä¢ {selectedVessel.distance.toFixed(1)} km away ‚Ä¢ {selectedVessel.speed.toFixed(1)} kn\n                </Text>\n              </View>\n            )}\n          </View>\n\n          <ScrollView style={styles.messagesContainer}>\n            {messages.length === 0 ? (\n              <View style={styles.emptyChat}>\n                <Text style={[styles.emptyChatText, { color: colors.icon }]}>\n                  No messages yet. Start a conversation!\n                </Text>\n              </View>\n            ) : (\n              messages.map((msg) => (\n                <View\n                  key={msg.id}\n                  style={[\n                    styles.messageBubble,\n                    {\n                      backgroundColor: msg.senderId === currentUser?.id ? colors.primary : colors.card,\n                      alignSelf: msg.senderId === currentUser?.id ? 'flex-end' : 'flex-start',\n                    },\n                  ]}\n                >\n                  <Text\n                    style={[\n                      styles.messageSender,\n                      { color: msg.senderId === currentUser?.id ? '#fff' : colors.icon },\n                    ]}\n                  >\n                    {msg.senderName}\n                  </Text>\n                  <Text\n                    style={[\n                      styles.messageText,\n                      { color: msg.senderId === currentUser?.id ? '#fff' : colors.text },\n                    ]}\n                  >\n                    {msg.text}\n                  </Text>\n                  <Text\n                    style={[\n                      styles.messageTime,\n                      { color: msg.senderId === currentUser?.id ? '#fff' : colors.icon },\n                    ]}\n                  >\n                    {new Date(msg.timestamp).toLocaleTimeString()}\n                  </Text>\n                </View>\n              ))\n            )}\n          </ScrollView>\n\n          <View style={[styles.inputContainer, { backgroundColor: colors.card, borderTopColor: colors.border }]}>\n            <TextInput\n              style={[styles.input, { backgroundColor: colors.background, color: colors.text }]}\n              placeholder=\"Type a message...\"\n              placeholderTextColor={colors.icon}\n              value={message}\n              onChangeText={setMessage}\n            />\n            <TouchableOpacity\n              style={[styles.sendButton, { backgroundColor: colors.primary }]}\n              onPress={handleSendMessage}\n            >\n              <Text style={styles.sendButtonText}>üì§</Text>\n            </TouchableOpacity>\n          </View>\n        </KeyboardAvoidingView>\n      </Modal>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    paddingTop: 50,\n    paddingBottom: 20,\n    paddingHorizontal: 20,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#fff',\n  },\n  headerSubtitle: {\n    fontSize: 14,\n    color: '#fff',\n    opacity: 0.9,\n    marginTop: 4,\n  },\n  mapContainer: {\n    flex: 1,\n  },\n  map: {\n    width: '100%',\n    height: '100%',\n  },\n  markerContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 3,\n    borderColor: '#fff',\n  },\n  markerIcon: {\n    fontSize: 20,\n  },\n  legend: {\n    position: 'absolute',\n    top: 10,\n    right: 10,\n    padding: 12,\n    borderRadius: 8,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5,\n  },\n  legendTitle: {\n    fontSize: 12,\n    fontWeight: 'bold',\n    marginBottom: 4,\n  },\n  legendItem: {\n    fontSize: 10,\n  },\n  webMapPlaceholder: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20,\n  },\n  webMapText: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    marginBottom: 8,\n    textAlign: 'center',\n  },\n  webMapSubtext: {\n    fontSize: 14,\n    textAlign: 'center',\n    lineHeight: 20,\n    marginBottom: 20,\n  },\n  vesselListContainer: {\n    width: '100%',\n    maxWidth: 400,\n    flex: 1,\n  },\n  sectionTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  vesselCard: {\n    padding: 12,\n    borderRadius: 8,\n    borderWidth: 1,\n    marginBottom: 8,\n  },\n  vesselName: {\n    fontSize: 14,\n    fontWeight: '600',\n  },\n  vesselDetails: {\n    fontSize: 12,\n    marginTop: 4,\n  },\n  modalContainer: {\n    flex: 1,\n  },\n  chatHeader: {\n    padding: 16,\n    paddingTop: 50,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    fontSize: 16,\n    fontWeight: '600',\n    marginBottom: 12,\n  },\n  chatHeaderInfo: {\n    alignItems: 'center',\n  },\n  chatHeaderName: {\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  chatHeaderStatus: {\n    fontSize: 12,\n    marginTop: 4,\n  },\n  messagesContainer: {\n    flex: 1,\n    padding: 16,\n  },\n  emptyChat: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginTop: 100,\n  },\n  emptyChatText: {\n    fontSize: 14,\n  },\n  messageBubble: {\n    maxWidth: '75%',\n    padding: 12,\n    borderRadius: 16,\n    marginBottom: 12,\n  },\n  messageSender: {\n    fontSize: 11,\n    fontWeight: '600',\n    marginBottom: 4,\n    opacity: 0.8,\n  },\n  messageText: {\n    fontSize: 15,\n  },\n  messageTime: {\n    fontSize: 11,\n    marginTop: 4,\n    opacity: 0.7,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    padding: 12,\n    borderTopWidth: 1,\n    gap: 8,\n  },\n  input: {\n    flex: 1,\n    height: 44,\n    borderRadius: 22,\n    paddingHorizontal: 16,\n    fontSize: 15,\n  },\n  sendButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  sendButtonText: {\n    fontSize: 20,\n  },\n  webMapView: {\n    flex: 1,\n    padding: 16,\n    alignItems: 'center',\n  },\n  webMapTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 8,\n  },\n  webMapCoords: {\n    fontSize: 13,\n    marginBottom: 16,\n  },\n  vesselListWeb: {\n    width: '100%',\n  },\n  vesselCardWeb: {\n    flexDirection: 'row',\n    padding: 12,\n    borderRadius: 8,\n    borderWidth: 1,\n    marginBottom: 8,\n    alignItems: 'center',\n  },\n  vesselIconWeb: {\n    fontSize: 28,\n    marginRight: 12,\n  },\n  vesselInfoWeb: {\n    flex: 1,\n  },\n  vesselNameWeb: {\n    fontSize: 15,\n    fontWeight: '600',\n    marginBottom: 4,\n  },\n  vesselDetailsWeb: {\n    fontSize: 12,\n  },\n});","size_bytes":21528},"utils/marineData.ts":{"content":"\nexport interface Port {\n  id: string;\n  name: string;\n  country: string;\n  lat: number;\n  lng: number;\n  vessels: number;\n  type: string;\n}\n\nexport interface Vessel {\n  id: string;\n  name: string;\n  type: string;\n  distance: string;\n  status: 'Active' | 'Idle' | 'Anchored';\n  speed: string;\n  heading: string;\n  lastUpdate: string;\n}\n\n// Major Malaysian Ports\nexport const MAJOR_PORTS: Port[] = [\n  { id: 'MYPKG', name: 'Port Klang', country: 'Malaysia', lat: 3.0000, lng: 101.3833, vessels: 156, type: 'Commercial' },\n  { id: 'MYTPP', name: 'Tanjung Pelepas', country: 'Malaysia', lat: 1.3667, lng: 103.5500, vessels: 142, type: 'Commercial' },\n  { id: 'MYPEN', name: 'Penang Port', country: 'Malaysia', lat: 5.4164, lng: 100.3327, vessels: 98, type: 'Commercial' },\n  { id: 'MYPGU', name: 'Johor Port', country: 'Malaysia', lat: 1.4655, lng: 103.7578, vessels: 87, type: 'Commercial' },\n  { id: 'MYBTU', name: 'Bintulu Port', country: 'Malaysia', lat: 3.2167, lng: 113.0667, vessels: 74, type: 'Commercial/LNG' },\n  { id: 'MYKUA', name: 'Kuantan Port', country: 'Malaysia', lat: 3.9667, lng: 103.4333, vessels: 63, type: 'Commercial' },\n  { id: 'MYLMU', name: 'Lumut Port', country: 'Malaysia', lat: 4.2333, lng: 100.6167, vessels: 45, type: 'Naval/Commercial' },\n  { id: 'MYKEM', name: 'Kemaman Port', country: 'Malaysia', lat: 4.2333, lng: 103.4167, vessels: 52, type: 'Commercial' },\n];\n\nexport const NEARBY_VESSELS: Vessel[] = [\n  { id: 'V001', name: 'Nelayan Jaya', type: 'Fishing Vessel', distance: '1.8 km', status: 'Active', speed: '7.2 kn', heading: '045¬∞', lastUpdate: '2 min ago' },\n  { id: 'V002', name: 'Putra Laut', type: 'Fishing Vessel', distance: '3.5 km', status: 'Active', speed: '6.8 kn', heading: '180¬∞', lastUpdate: '5 min ago' },\n  { id: 'V003', name: 'Maersk Essex', type: 'Cargo Ship', distance: '12.3 km', status: 'Active', speed: '14.5 kn', heading: '270¬∞', lastUpdate: '3 min ago' },\n  { id: 'V004', name: 'Ikan Bilis 5', type: 'Fishing Vessel', distance: '4.7 km', status: 'Idle', speed: '0 kn', heading: 'N/A', lastUpdate: '15 min ago' },\n  { id: 'V005', name: 'MSC Mediterranean', type: 'Container Ship', distance: '18.9 km', status: 'Active', speed: '16.3 kn', heading: '090¬∞', lastUpdate: '4 min ago' },\n  { id: 'V006', name: 'Nelayan Bahagia', type: 'Fishing Vessel', distance: '5.2 km', status: 'Active', speed: '5.5 kn', heading: '315¬∞', lastUpdate: '7 min ago' },\n  { id: 'V007', name: 'Selat Express', type: 'Passenger Ferry', distance: '8.1 km', status: 'Active', speed: '18.2 kn', heading: '225¬∞', lastUpdate: '2 min ago' },\n  { id: 'V008', name: 'Petronas Marine 3', type: 'Tanker', distance: '14.5 km', status: 'Anchored', speed: '0 kn', heading: 'N/A', lastUpdate: '20 min ago' },\n];\n\nexport const FISHING_ZONES = [\n  { id: 'FZ001', name: 'Straits of Malacca - North', lat: 5.5, lng: 100.2, quality: 'Excellent', fish: ['Selar', 'Kembung', 'Cencaru'] },\n  { id: 'FZ002', name: 'South China Sea - East Coast', lat: 4.8, lng: 103.5, quality: 'Good', fish: ['Tenggiri', 'Jenahak', 'Bawal'] },\n  { id: 'FZ003', name: 'Terengganu Waters', lat: 5.3, lng: 103.1, quality: 'Excellent', fish: ['Ikan Merah', 'Kerapu', 'Pari'] },\n];\n\nexport const getVesselIcon = (type: string): string => {\n  switch (type.toLowerCase()) {\n    case 'fishing vessel': return 'üé£';\n    case 'cargo ship': return 'üö¢';\n    case 'container ship': return 'üö¢';\n    case 'passenger ferry': return '‚õ¥Ô∏è';\n    case 'yacht': return '‚õµ';\n    case 'tanker': return 'üõ¢Ô∏è';\n    default: return 'üö¢';\n  }\n};\n","size_bytes":3537},"app/(tabs)/sos.tsx":{"content":"\nimport React, { useState, useEffect } from 'react';\nimport { View, Text, StyleSheet, TouchableOpacity, ScrollView, Alert, Linking } from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport * as Location from 'expo-location';\nimport { getCurrentUser } from '@/utils/auth';\n\nexport default function SOSScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const [sosActive, setSosActive] = useState(false);\n  const [userLocation, setUserLocation] = useState<{ latitude: number; longitude: number } | null>(null);\n  const [currentUser, setCurrentUser] = useState<any>(null);\n\n  useEffect(() => {\n    loadUserData();\n    getCurrentLocation();\n  }, []);\n\n  const loadUserData = async () => {\n    const user = await getCurrentUser();\n    setCurrentUser(user);\n  };\n\n  const getCurrentLocation = async () => {\n    const { status } = await Location.requestForegroundPermissionsAsync();\n    if (status === 'granted') {\n      const location = await Location.getCurrentPositionAsync({});\n      setUserLocation({\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude,\n      });\n    }\n  };\n\n  const emergencyContacts = [\n    { \n      id: 1, \n      name: 'Malaysian Maritime Enforcement Agency (MMEA)', \n      phone: '+60380008000', \n      type: 'Authority',\n      description: '24/7 Maritime Emergency Hotline'\n    },\n    { \n      id: 2, \n      name: 'MMEA Emergency Hotline', \n      phone: '999', \n      type: 'Authority',\n      description: 'Emergency Services Malaysia'\n    },\n    { \n      id: 3, \n      name: 'Marine Police', \n      phone: '+60322662222', \n      type: 'Authority',\n      description: 'Royal Malaysian Marine Police'\n    },\n    { \n      id: 4, \n      name: 'MERS 999', \n      phone: '999', \n      type: 'Authority',\n      description: 'Malaysia Emergency Response Services'\n    },\n  ];\n\n  const makeEmergencyCall = (phone: string, name: string) => {\n    Alert.alert(\n      `Call ${name}?`,\n      `This will dial ${phone} for emergency assistance.`,\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Call Now',\n          style: 'destructive',\n          onPress: () => {\n            Linking.openURL(`tel:${phone}`);\n          },\n        },\n      ]\n    );\n  };\n\n  const handleSOS = async () => {\n    if (!userLocation) {\n      Alert.alert('Location Required', 'Please enable location services to send SOS.');\n      return;\n    }\n\n    Alert.alert(\n      'Send SOS Alert?',\n      'This will:\\n‚Ä¢ Send your location to emergency services\\n‚Ä¢ Alert nearby vessels\\n‚Ä¢ Notify registered contacts\\n‚Ä¢ Activate emergency beacon',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Send SOS',\n          style: 'destructive',\n          onPress: async () => {\n            setSosActive(true);\n            \n            // In production, send to backend API:\n            // await fetch('https://your-backend/api/sos', {\n            //   method: 'POST',\n            //   body: JSON.stringify({\n            //     userId: currentUser?.id,\n            //     location: userLocation,\n            //     timestamp: new Date().toISOString(),\n            //     vesselInfo: currentUser?.vesselInfo\n            //   })\n            // });\n\n            // Simulate SMS to emergency services\n            const message = `MARITIME EMERGENCY: ${currentUser?.vesselInfo?.vesselName || 'Unknown Vessel'} at ${userLocation.latitude.toFixed(6)}¬∞N, ${userLocation.longitude.toFixed(6)}¬∞E. Immediate assistance required.`;\n            \n            // Auto-dial MMEA\n            setTimeout(() => {\n              Alert.alert(\n                'SOS Activated!',\n                'Emergency services have been notified.\\n\\nDo you want to call MMEA now?',\n                [\n                  { text: 'No', style: 'cancel' },\n                  { \n                    text: 'Call MMEA',\n                    onPress: () => Linking.openURL('tel:999')\n                  },\n                ]\n              );\n            }, 1000);\n          },\n        },\n      ]\n    );\n  };\n\n  const cancelSOS = () => {\n    Alert.alert(\n      'Cancel SOS?',\n      'Are you sure you want to cancel the emergency alert?',\n      [\n        { text: 'No', style: 'cancel' },\n        {\n          text: 'Yes, Cancel',\n          onPress: () => {\n            setSosActive(false);\n            Alert.alert('SOS Cancelled', 'Emergency alert has been deactivated.');\n          },\n        },\n      ]\n    );\n  };\n\n  return (\n    <ScrollView style={[styles.container, { backgroundColor: colors.background }]}>\n      <View style={[styles.header, { backgroundColor: colors.danger }]}>\n        <Text style={styles.headerTitle}>Emergency SOS</Text>\n        <Text style={styles.headerSubtitle}>Quick Emergency Response</Text>\n      </View>\n\n      <View style={styles.sosSection}>\n        {sosActive && (\n          <View style={[styles.activeAlert, { backgroundColor: colors.danger }]}>\n            <Text style={styles.activeAlertText}>üö® SOS ACTIVE</Text>\n            <Text style={styles.activeAlertSubtext}>\n              Emergency services notified ‚Ä¢ Help is on the way\n            </Text>\n            <TouchableOpacity\n              style={styles.cancelButton}\n              onPress={cancelSOS}\n            >\n              <Text style={styles.cancelButtonText}>Cancel SOS</Text>\n            </TouchableOpacity>\n          </View>\n        )}\n\n        <TouchableOpacity\n          style={[\n            styles.sosButton, \n            { backgroundColor: sosActive ? '#FF3B30' : colors.danger }\n          ]}\n          onPress={sosActive ? cancelSOS : handleSOS}\n          activeOpacity={0.8}\n        >\n          <Text style={styles.sosIcon}>üö®</Text>\n          <Text style={styles.sosText}>{sosActive ? 'SOS ACTIVE' : 'SEND SOS'}</Text>\n          <Text style={styles.sosSubtext}>\n            {sosActive ? 'Tap to cancel' : 'Press and hold for emergency'}\n          </Text>\n        </TouchableOpacity>\n\n        <View style={[styles.infoCard, { backgroundColor: colors.card, borderColor: colors.border }]}>\n          <Text style={[styles.infoTitle, { color: colors.text }]}>üìç Current Location</Text>\n          {userLocation ? (\n            <>\n              <Text style={[styles.infoText, { color: colors.icon }]}>\n                {userLocation.latitude.toFixed(6)}¬∞N, {userLocation.longitude.toFixed(6)}¬∞E\n              </Text>\n              {currentUser?.vesselInfo && (\n                <Text style={[styles.infoSubtext, { color: colors.icon }]}>\n                  Vessel: {currentUser.vesselInfo.vesselName}\n                </Text>\n              )}\n            </>\n          ) : (\n            <Text style={[styles.infoText, { color: colors.icon }]}>\n              Fetching location...\n            </Text>\n          )}\n        </View>\n      </View>\n\n      <View style={styles.contactsSection}>\n        <Text style={[styles.sectionTitle, { color: colors.text }]}>Emergency Contacts</Text>\n        {emergencyContacts.map((contact) => (\n          <View\n            key={contact.id}\n            style={[styles.contactCard, { backgroundColor: colors.card, borderColor: colors.border }]}\n          >\n            <View style={styles.contactInfo}>\n              <Text style={[styles.contactName, { color: colors.text }]}>\n                {contact.type === 'Authority' ? 'üöì' : 'üë§'} {contact.name}\n              </Text>\n              <Text style={[styles.contactType, { color: colors.icon }]}>\n                {contact.description}\n              </Text>\n              <Text style={[styles.contactPhone, { color: colors.primary }]}>\n                {contact.phone}\n              </Text>\n            </View>\n            <TouchableOpacity\n              style={[styles.callButton, { backgroundColor: colors.primary }]}\n              onPress={() => makeEmergencyCall(contact.phone, contact.name)}\n            >\n              <Text style={styles.callText}>üìû Call</Text>\n            </TouchableOpacity>\n          </View>\n        ))}\n      </View>\n\n      <View style={[styles.instructionsCard, { backgroundColor: colors.card, borderColor: colors.border }]}>\n        <Text style={[styles.instructionsTitle, { color: colors.danger }]}>\n          ‚ö†Ô∏è Emergency Instructions\n        </Text>\n        <Text style={[styles.instructionsText, { color: colors.text }]}>\n          1. Press the SOS button to send your location to emergency services{'\\n'}\n          2. Your GPS coordinates will be broadcast to MMEA and nearby vessels{'\\n'}\n          3. Stay calm and secure your vessel{'\\n'}\n          4. Monitor VHF Channel 16 for rescue coordination{'\\n'}\n          5. Keep your phone charged and accessible{'\\n'}\n          6. Prepare life jackets and emergency equipment{'\\n'}\n          7. Wait for confirmation from rescue services\n        </Text>\n      </View>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    paddingTop: 50,\n    paddingBottom: 20,\n    paddingHorizontal: 20,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#fff',\n  },\n  headerSubtitle: {\n    fontSize: 14,\n    color: '#fff',\n    opacity: 0.9,\n    marginTop: 4,\n  },\n  sosSection: {\n    padding: 16,\n    alignItems: 'center',\n  },\n  activeAlert: {\n    width: '100%',\n    padding: 16,\n    borderRadius: 12,\n    alignItems: 'center',\n    marginBottom: 16,\n  },\n  activeAlertText: {\n    color: '#fff',\n    fontSize: 20,\n    fontWeight: 'bold',\n  },\n  activeAlertSubtext: {\n    color: '#fff',\n    fontSize: 14,\n    marginTop: 4,\n    textAlign: 'center',\n  },\n  cancelButton: {\n    marginTop: 12,\n    paddingVertical: 8,\n    paddingHorizontal: 16,\n    backgroundColor: 'rgba(255,255,255,0.3)',\n    borderRadius: 8,\n  },\n  cancelButtonText: {\n    color: '#fff',\n    fontWeight: 'bold',\n  },\n  sosButton: {\n    width: 200,\n    height: 200,\n    borderRadius: 100,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginVertical: 24,\n    elevation: 8,\n  },\n  sosIcon: {\n    fontSize: 60,\n    marginBottom: 8,\n  },\n  sosText: {\n    color: '#fff',\n    fontSize: 24,\n    fontWeight: 'bold',\n  },\n  sosSubtext: {\n    color: '#fff',\n    fontSize: 12,\n    marginTop: 8,\n    opacity: 0.9,\n  },\n  infoCard: {\n    width: '100%',\n    padding: 20,\n    borderRadius: 12,\n    borderWidth: 1,\n    alignItems: 'center',\n  },\n  infoTitle: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    marginBottom: 8,\n  },\n  infoText: {\n    fontSize: 18,\n    fontWeight: '600',\n  },\n  infoSubtext: {\n    fontSize: 14,\n    marginTop: 4,\n  },\n  contactsSection: {\n    padding: 16,\n  },\n  sectionTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  contactCard: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginBottom: 12,\n  },\n  contactInfo: {\n    flex: 1,\n  },\n  contactName: {\n    fontSize: 16,\n    fontWeight: '600',\n    marginBottom: 4,\n  },\n  contactType: {\n    fontSize: 12,\n    marginBottom: 4,\n  },\n  contactPhone: {\n    fontSize: 13,\n    fontWeight: '600',\n  },\n  callButton: {\n    paddingVertical: 10,\n    paddingHorizontal: 20,\n    borderRadius: 8,\n  },\n  callText: {\n    color: '#fff',\n    fontSize: 14,\n    fontWeight: 'bold',\n  },\n  instructionsCard: {\n    margin: 16,\n    padding: 20,\n    borderRadius: 12,\n    borderWidth: 1,\n  },\n  instructionsTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  instructionsText: {\n    fontSize: 14,\n    lineHeight: 24,\n  },\n});\n","size_bytes":11609},"app/(tabs)/chat.tsx":{"content":"import React, { useState, useEffect, useRef } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  TextInput,\n  KeyboardAvoidingView,\n  Platform,\n} from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { getNearbyTrackedVessels } from '@/utils/trackingService';\nimport { getCurrentUser } from '@/utils/auth';\nimport { sendMessage, getChatMessages, getChatRoom, subscribeToMessages } from '@/utils/realtimeChat';\nimport * as Location from 'expo-location';\n\ninterface Contact {\n  id: string;\n  name: string;\n  vessel: string;\n  distance: number;\n  lastMessage?: string;\n  unread?: number;\n}\n\nexport default function ChatScreen() {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const [selectedContact, setSelectedContact] = useState<Contact | null>(null);\n  const [message, setMessage] = useState('');\n  const [contacts, setContacts] = useState<Contact[]>([]);\n  const [messages, setMessages] = useState<any[]>([]);\n  const [currentUser, setCurrentUser] = useState<any>(null);\n  const [chatId, setChatId] = useState<string>('');\n\n  const chatUnsubscribeRef = useRef<(() => void) | null>(null);\n  const isMountedRef = useRef<boolean>(true);\n\n  useEffect(() => {\n    isMountedRef.current = true;\n    loadCurrentUser();\n    loadNearbyContacts();\n\n    const interval = setInterval(loadNearbyContacts, 10000); // Refresh every 10s\n    return () => {\n      isMountedRef.current = false;\n      clearInterval(interval);\n    };\n  }, []);\n\n  useEffect(() => {\n    let isActive = true;\n\n    const setupChatAsync = async () => {\n      if (!selectedContact || !currentUser) return;\n\n      const roomId = await getChatRoom(currentUser.id, selectedContact.id);\n      if (!isActive) return;\n\n      setChatId(roomId);\n\n      const chatMessages = await getChatMessages(roomId);\n      if (!isActive) return;\n\n      setMessages(chatMessages);\n\n      const subscription = subscribeToMessages(roomId, (newMessage) => {\n        if (isActive && newMessage.senderId !== currentUser.id) {\n          setMessages(prev => [...prev, newMessage]);\n        }\n      });\n\n      const unsubscribe = () => subscription?.unsubscribe();\n\n      if (isActive) {\n        chatUnsubscribeRef.current = unsubscribe;\n      } else {\n        unsubscribe();\n      }\n    };\n\n    setupChatAsync();\n\n    return () => {\n      isActive = false;\n      if (chatUnsubscribeRef.current) {\n        chatUnsubscribeRef.current();\n        chatUnsubscribeRef.current = null;\n      }\n    };\n  }, [selectedContact, currentUser]);\n\n  const loadCurrentUser = async () => {\n    const user = await getCurrentUser();\n    if (isMountedRef.current) {\n      setCurrentUser(user);\n    }\n  };\n\n  const loadNearbyContacts = async () => {\n    const { status } = await Location.requestForegroundPermissionsAsync();\n    if (status !== 'granted') return;\n\n    const location = await Location.getCurrentPositionAsync({});\n\n    if (!isMountedRef.current) return;\n\n    try {\n      const vessels = await getNearbyTrackedVessels(location.coords.latitude, location.coords.longitude, 100);\n\n      if (!isMountedRef.current) return;\n\n      const contactList: Contact[] = vessels.map(v => ({\n        id: v.userId,\n        name: v.vesselInfo.vesselName,\n        vessel: v.vesselInfo.vesselType,\n        distance: calculateDistance(\n          location.coords.latitude,\n          location.coords.longitude,\n          v.location.latitude,\n          v.location.longitude\n        ),\n      }));\n\n      setContacts(contactList);\n    } catch (error) {\n      // Silently fail - no console errors\n      setContacts([]);\n    }\n  };\n\n  const calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number): number => {\n    const R = 6371;\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = \n      Math.sin(dLat/2) * Math.sin(dLat/2) +\n      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n      Math.sin(dLon/2) * Math.sin(dLon/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    return R * c;\n  };\n\n  const setupChat = async () => {\n    if (!selectedContact || !currentUser) return;\n\n    const roomId = await getChatRoom(currentUser.id, selectedContact.id);\n    setChatId(roomId);\n\n    const chatMessages = await getChatMessages(roomId);\n    setMessages(chatMessages);\n\n    // Subscribe to new messages\n    const subscription = subscribeToMessages(roomId, (newMessage) => {\n      if (newMessage.senderId !== currentUser.id) {\n        setMessages(prev => [...prev, newMessage]);\n      }\n    });\n\n    return () => subscription?.unsubscribe();\n  };\n\n  const handleSendMessage = async () => {\n    if (!message.trim() || !currentUser || !chatId) return;\n\n    const newMessage = await sendMessage(\n      chatId,\n      currentUser.id,\n      currentUser.name,\n      message.trim()\n    );\n\n    if (!isMountedRef.current) return;\n\n    setMessages(prev => [...prev, newMessage]);\n    setMessage('');\n  };\n\n  return (\n    <KeyboardAvoidingView \n      style={[styles.container, { backgroundColor: colors.background }]}\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n    >\n      <View style={[styles.header, { backgroundColor: colors.primary }]}>\n        <Text style={styles.headerTitle}>Communication</Text>\n        <Text style={styles.headerSubtitle}>Connect with nearby vessels (50km radius)</Text>\n      </View>\n\n      {selectedContact ? (\n        <View style={styles.chatView}>\n          <View style={[styles.chatHeader, { backgroundColor: colors.card, borderBottomColor: colors.border }]}>\n            <TouchableOpacity onPress={() => setSelectedContact(null)}>\n              <Text style={[styles.backButton, { color: colors.primary }]}>‚Üê Back</Text>\n            </TouchableOpacity>\n            <View style={styles.chatHeaderInfo}>\n              <Text style={[styles.chatHeaderName, { color: colors.text }]}>\n                üö¢ {selectedContact.name}\n              </Text>\n              <Text style={[styles.chatHeaderStatus, { color: colors.icon }]}>\n                {selectedContact.distance.toFixed(1)} km away ‚Ä¢ {selectedContact.vessel}\n              </Text>\n            </View>\n          </View>\n\n          <ScrollView style={styles.messagesContainer}>\n            {messages.length === 0 ? (\n              <View style={styles.emptyState}>\n                <Text style={[styles.emptyText, { color: colors.icon }]}>\n                  No messages yet. Start a conversation!\n                </Text>\n              </View>\n            ) : (\n              messages.map((msg) => (\n                <View\n                  key={msg.id}\n                  style={[\n                    styles.messageBubble,\n                    {\n                      backgroundColor: msg.senderId === currentUser?.id ? colors.primary : colors.card,\n                      alignSelf: msg.senderId === currentUser?.id ? 'flex-end' : 'flex-start',\n                    },\n                  ]}\n                >\n                  <Text\n                    style={[\n                      styles.messageSender,\n                      { color: msg.senderId === currentUser?.id ? '#fff' : colors.icon },\n                    ]}\n                  >\n                    {msg.senderName}\n                  </Text>\n                  <Text\n                    style={[\n                      styles.messageText,\n                      { color: msg.senderId === currentUser?.id ? '#fff' : colors.text },\n                    ]}\n                  >\n                    {msg.text}\n                  </Text>\n                  <Text\n                    style={[\n                      styles.messageTime,\n                      { color: msg.senderId === currentUser?.id ? '#fff' : colors.icon },\n                    ]}\n                  >\n                    {new Date(msg.timestamp).toLocaleTimeString()}\n                  </Text>\n                </View>\n              ))\n            )}\n          </ScrollView>\n\n          <View style={[styles.inputContainer, { backgroundColor: colors.card, borderTopColor: colors.border }]}>\n            <TextInput\n              style={[styles.input, { backgroundColor: colors.background, color: colors.text }]}\n              placeholder=\"Type a message...\"\n              placeholderTextColor={colors.icon}\n              value={message}\n              onChangeText={setMessage}\n            />\n            <TouchableOpacity\n              style={[styles.sendButton, { backgroundColor: colors.primary }]}\n              onPress={handleSendMessage}\n            >\n              <Text style={styles.sendButtonText}>üì§</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      ) : (\n        <ScrollView style={styles.contactsList}>\n          <Text style={[styles.sectionTitle, { color: colors.text }]}>\n            Nearby Vessels ({contacts.length})\n          </Text>\n          {contacts.length === 0 ? (\n            <View style={styles.emptyState}>\n              <Text style={[styles.emptyText, { color: colors.icon }]}>\n                No vessels within 50km radius\n              </Text>\n              <Text style={[styles.emptySubtext, { color: colors.icon }]}>\n                Enable tracking to be visible to others\n              </Text>\n            </View>\n          ) : (\n            contacts.map((contact) => (\n              <TouchableOpacity\n                key={contact.id}\n                style={[styles.contactCard, { backgroundColor: colors.card, borderColor: colors.border }]}\n                onPress={() => setSelectedContact(contact)}\n              >\n                <View style={styles.contactAvatar}>\n                  <Text style={styles.avatarText}>üö¢</Text>\n                </View>\n                <View style={styles.contactInfo}>\n                  <Text style={[styles.contactName, { color: colors.text }]}>\n                    {contact.name}\n                  </Text>\n                  <Text style={[styles.vesselName, { color: colors.icon }]}>\n                    {contact.vessel}\n                  </Text>\n                  <Text style={[styles.location, { color: colors.primary }]}>\n                    üìç {contact.distance.toFixed(1)} km away\n                  </Text>\n                </View>\n                <View style={styles.chatBadge}>\n                  <Text style={styles.chatIcon}>üí¨</Text>\n                </View>\n              </TouchableOpacity>\n            ))\n          )}\n        </ScrollView>\n      )}\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    paddingTop: 50,\n    paddingBottom: 20,\n    paddingHorizontal: 20,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#fff',\n  },\n  headerSubtitle: {\n    fontSize: 14,\n    color: '#fff',\n    opacity: 0.9,\n    marginTop: 4,\n  },\n  contactsList: {\n    flex: 1,\n    padding: 16,\n  },\n  sectionTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  emptyState: {\n    alignItems: 'center',\n    marginTop: 60,\n  },\n  emptyText: {\n    fontSize: 16,\n    marginBottom: 8,\n  },\n  emptySubtext: {\n    fontSize: 14,\n  },\n  contactCard: {\n    flexDirection: 'row',\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    marginBottom: 12,\n    alignItems: 'center',\n  },\n  contactAvatar: {\n    width: 50,\n    height: 50,\n    borderRadius: 25,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: 12,\n  },\n  avatarText: {\n    fontSize: 28,\n  },\n  contactInfo: {\n    flex: 1,\n  },\n  contactName: {\n    fontSize: 16,\n    fontWeight: '600',\n  },\n  vesselName: {\n    fontSize: 12,\n    marginTop: 2,\n  },\n  location: {\n    fontSize: 12,\n    marginTop: 6,\n  },\n  chatBadge: {\n    padding: 8,\n  },\n  chatIcon: {\n    fontSize: 24,\n  },\n  chatView: {\n    flex: 1,\n  },\n  chatHeader: {\n    padding: 16,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    fontSize: 16,\n    fontWeight: '600',\n    marginBottom: 8,\n  },\n  chatHeaderInfo: {\n    alignItems: 'center',\n  },\n  chatHeaderName: {\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  chatHeaderStatus: {\n    fontSize: 12,\n    marginTop: 2,\n  },\n  messagesContainer: {\n    flex: 1,\n    padding: 16,\n  },\n  messageBubble: {\n    maxWidth: '75%',\n    padding: 12,\n    borderRadius: 16,\n    marginBottom: 12,\n  },\n  messageSender: {\n    fontSize: 11,\n    fontWeight: '600',\n    marginBottom: 4,\n    opacity: 0.8,\n  },\n  messageText: {\n    fontSize: 15,\n  },\n  messageTime: {\n    fontSize: 11,\n    marginTop: 4,\n    opacity: 0.7,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    padding: 12,\n    borderTopWidth: 1,\n    gap: 8,\n  },\n  input: {\n    flex: 1,\n    height: 44,\n    borderRadius: 22,\n    paddingHorizontal: 16,\n    fontSize: 15,\n  },\n  sendButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  sendButtonText: {\n    fontSize: 20,\n  },\n});","size_bytes":12965},"app/auth/register.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  KeyboardAvoidingView,\n  Platform,\n} from 'react-native';\nimport { useRouter } from 'expo-router';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\n\nexport default function RegisterScreen() {\n  const [name, setName] = useState('');\n  const [email, setEmail] = useState('');\n  const [phone, setPhone] = useState('');\n  const [vesselName, setVesselName] = useState('');\n  const [vesselId, setVesselId] = useState('');\n  const [role, setRole] = useState('Fisherman');\n  const [password, setPassword] = useState('');\n  \n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const router = useRouter();\n\n  const roles = ['Fisherman', 'Vessel Operator', 'Authority Contact'];\n\n  const handleRegister = () => {\n    router.replace('/(tabs)');\n  };\n\n  return (\n    <KeyboardAvoidingView\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n      style={[styles.container, { backgroundColor: colors.background }]}\n    >\n      <ScrollView style={styles.scrollView} contentContainerStyle={styles.content}>\n        <Text style={[styles.title, { color: colors.primary }]}>Create Account</Text>\n        <Text style={[styles.subtitle, { color: colors.text }]}>\n          Join MarineTrack community\n        </Text>\n\n        <View style={styles.form}>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Full Name\"\n            placeholderTextColor={colors.icon}\n            value={name}\n            onChangeText={setName}\n          />\n\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Email\"\n            placeholderTextColor={colors.icon}\n            value={email}\n            onChangeText={setEmail}\n            keyboardType=\"email-address\"\n            autoCapitalize=\"none\"\n          />\n\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Phone Number\"\n            placeholderTextColor={colors.icon}\n            value={phone}\n            onChangeText={setPhone}\n            keyboardType=\"phone-pad\"\n          />\n\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Vessel Name\"\n            placeholderTextColor={colors.icon}\n            value={vesselName}\n            onChangeText={setVesselName}\n          />\n\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Vessel ID\"\n            placeholderTextColor={colors.icon}\n            value={vesselId}\n            onChangeText={setVesselId}\n          />\n\n          <Text style={[styles.label, { color: colors.text }]}>Select Role:</Text>\n          <View style={styles.roleContainer}>\n            {roles.map((r) => (\n              <TouchableOpacity\n                key={r}\n                style={[\n                  styles.roleButton,\n                  {\n                    backgroundColor: role === r ? colors.primary : colors.card,\n                    borderColor: colors.border,\n                  },\n                ]}\n                onPress={() => setRole(r)}\n              >\n                <Text style={[styles.roleText, { color: role === r ? '#fff' : colors.text }]}>\n                  {r}\n                </Text>\n              </TouchableOpacity>\n            ))}\n          </View>\n\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Password\"\n            placeholderTextColor={colors.icon}\n            value={password}\n            onChangeText={setPassword}\n            secureTextEntry\n          />\n\n          <TouchableOpacity\n            style={[styles.registerButton, { backgroundColor: colors.primary }]}\n            onPress={handleRegister}\n          >\n            <Text style={styles.registerButtonText}>Create Account</Text>\n          </TouchableOpacity>\n\n          <TouchableOpacity onPress={() => router.back()}>\n            <Text style={[styles.loginText, { color: colors.icon }]}>\n              Already have an account? <Text style={{ color: colors.primary }}>Login</Text>\n            </Text>\n          </TouchableOpacity>\n        </View>\n      </ScrollView>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  content: {\n    padding: 20,\n    paddingTop: 60,\n  },\n  title: {\n    fontSize: 32,\n    fontWeight: 'bold',\n    textAlign: 'center',\n    marginBottom: 8,\n  },\n  subtitle: {\n    fontSize: 16,\n    textAlign: 'center',\n    marginBottom: 30,\n  },\n  form: {\n    gap: 16,\n  },\n  input: {\n    height: 56,\n    borderWidth: 1,\n    borderRadius: 12,\n    paddingHorizontal: 16,\n    fontSize: 16,\n  },\n  label: {\n    fontSize: 16,\n    fontWeight: '600',\n    marginTop: 8,\n  },\n  roleContainer: {\n    flexDirection: 'row',\n    gap: 8,\n    flexWrap: 'wrap',\n  },\n  roleButton: {\n    paddingVertical: 12,\n    paddingHorizontal: 16,\n    borderRadius: 8,\n    borderWidth: 1,\n  },\n  roleText: {\n    fontSize: 14,\n    fontWeight: '600',\n  },\n  registerButton: {\n    height: 56,\n    borderRadius: 12,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 8,\n  },\n  registerButtonText: {\n    color: '#fff',\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  loginText: {\n    textAlign: 'center',\n    marginTop: 16,\n    fontSize: 14,\n  },\n});\n","size_bytes":5883},"app/auth/_layout.tsx":{"content":"import { Stack } from 'expo-router';\n\nexport default function AuthLayout() {\n  return (\n    <Stack screenOptions={{ headerShown: false }}>\n      <Stack.Screen name=\"login\" />\n      <Stack.Screen name=\"register\" />\n    </Stack>\n  );\n}\n","size_bytes":234},"app/auth/email-login.tsx":{"content":"\nimport React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  KeyboardAvoidingView,\n  Platform,\n  Alert,\n} from 'react-native';\nimport { useRouter } from 'expo-router';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { loginWithEmailPassword } from '@/utils/auth';\n\nexport default function EmailLoginScreen() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const router = useRouter();\n\n  const handleLogin = async () => {\n    if (!email || !password) {\n      Alert.alert('Error', 'Please enter email and password');\n      return;\n    }\n\n    setLoading(true);\n    const success = await loginWithEmailPassword(email, password);\n    setLoading(false);\n\n    if (success) {\n      router.replace('/(tabs)');\n    } else {\n      Alert.alert('Error', 'Invalid email or password');\n    }\n  };\n\n  return (\n    <KeyboardAvoidingView\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n      style={[styles.container, { backgroundColor: colors.background }]}\n    >\n      <View style={styles.content}>\n        <TouchableOpacity onPress={() => router.back()} style={styles.backButton}>\n          <Text style={[styles.backText, { color: colors.primary }]}>‚Üê Back</Text>\n        </TouchableOpacity>\n\n        <Text style={styles.logo}>üåä</Text>\n        <Text style={[styles.title, { color: colors.primary }]}>Email Sign In</Text>\n\n        <View style={styles.form}>\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Email\"\n            placeholderTextColor={colors.icon}\n            value={email}\n            onChangeText={setEmail}\n            keyboardType=\"email-address\"\n            autoCapitalize=\"none\"\n            editable={!loading}\n          />\n\n          <TextInput\n            style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}\n            placeholder=\"Password\"\n            placeholderTextColor={colors.icon}\n            value={password}\n            onChangeText={setPassword}\n            secureTextEntry\n            editable={!loading}\n          />\n\n          <TouchableOpacity\n            style={[styles.loginButton, { backgroundColor: colors.primary }]}\n            onPress={handleLogin}\n            disabled={loading}\n          >\n            <Text style={styles.loginButtonText}>\n              {loading ? 'Signing in...' : 'Sign In'}\n            </Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  content: {\n    flex: 1,\n    justifyContent: 'center',\n    padding: 20,\n  },\n  backButton: {\n    position: 'absolute',\n    top: 50,\n    left: 20,\n  },\n  backText: {\n    fontSize: 16,\n    fontWeight: '600',\n  },\n  logo: {\n    fontSize: 80,\n    textAlign: 'center',\n    marginBottom: 20,\n  },\n  title: {\n    fontSize: 36,\n    fontWeight: 'bold',\n    textAlign: 'center',\n    marginBottom: 40,\n  },\n  form: {\n    gap: 16,\n  },\n  input: {\n    height: 56,\n    borderWidth: 1,\n    borderRadius: 12,\n    paddingHorizontal: 16,\n    fontSize: 16,\n  },\n  loginButton: {\n    height: 56,\n    borderRadius: 12,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 8,\n  },\n  loginButtonText: {\n    color: '#fff',\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":3663},"components/LiveMap.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { View, Text, StyleSheet, ScrollView } from 'react-native';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport * as Location from 'expo-location';\n\ninterface LiveMapProps {\n  userLocation?: { lat: number; lng: number } | null;\n}\n\nexport default function LiveMap({ userLocation: propLocation }: LiveMapProps) {\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const [location, setLocation] = useState<{ lat: number; lng: number } | null>(propLocation || null);\n\n  useEffect(() => {\n    if (propLocation) {\n      setLocation(propLocation);\n    } else {\n      getCurrentLocation();\n    }\n  }, [propLocation]);\n\n  const getCurrentLocation = async () => {\n    try {\n      const { status } = await Location.requestForegroundPermissionsAsync();\n      if (status === 'granted') {\n        const loc = await Location.getCurrentPositionAsync({});\n        setLocation({\n          lat: loc.coords.latitude,\n          lng: loc.coords.longitude,\n        });\n      }\n    } catch (error) {\n      console.error('Error getting location:', error);\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.mapView, { backgroundColor: colors.background }]}>\n        <View style={styles.header}>\n          <Text style={[styles.title, { color: colors.text }]}>üìç Your Location</Text>\n        </View>\n\n        {location ? (\n          <View style={styles.locationContainer}>\n            <View style={[styles.marker, { backgroundColor: colors.primary }]}>\n              <Text style={styles.markerIcon}>üìç</Text>\n            </View>\n\n            <View style={styles.coordsContainer}>\n              <Text style={[styles.coordsLabel, { color: colors.icon }]}>Latitude</Text>\n              <Text style={[styles.coordsValue, { color: colors.text }]}>\n                {location.lat.toFixed(6)}¬∞N\n              </Text>\n            </View>\n\n            <View style={styles.coordsContainer}>\n              <Text style={[styles.coordsLabel, { color: colors.icon }]}>Longitude</Text>\n              <Text style={[styles.coordsValue, { color: colors.text }]}>\n                {location.lng.toFixed(6)}¬∞E\n              </Text>\n            </View>\n\n            <View style={[styles.infoBox, { backgroundColor: colors.card }]}>\n              <Text style={[styles.infoText, { color: colors.icon }]}>\n                ‚ÑπÔ∏è Full interactive map available on mobile app\n              </Text>\n            </View>\n          </View>\n        ) : (\n          <View style={styles.loadingContainer}>\n            <Text style={[styles.loadingText, { color: colors.icon }]}>\n              Getting your location...\n            </Text>\n          </View>\n        )}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    width: '100%',\n    height: 300,\n  },\n  mapView: {\n    flex: 1,\n    borderRadius: 12,\n    padding: 20,\n    alignItems: 'center',\n  },\n  header: {\n    marginBottom: 20,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    textAlign: 'center',\n  },\n  locationContainer: {\n    width: '100%',\n    alignItems: 'center',\n    gap: 16,\n  },\n  marker: {\n    width: 60,\n    height: 60,\n    borderRadius: 30,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: 10,\n  },\n  markerIcon: {\n    fontSize: 30,\n  },\n  coordsContainer: {\n    width: '100%',\n    alignItems: 'center',\n  },\n  coordsLabel: {\n    fontSize: 12,\n    fontWeight: '600',\n    marginBottom: 4,\n  },\n  coordsValue: {\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  infoBox: {\n    marginTop: 20,\n    padding: 12,\n    borderRadius: 8,\n    width: '100%',\n  },\n  infoText: {\n    fontSize: 12,\n    textAlign: 'center',\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingText: {\n    fontSize: 14,\n  },\n});","size_bytes":3931},"utils/trackingService.ts":{"content":"interface VesselTrackingData {\n  userId: string;\n  vesselInfo: {\n    vesselName: string;\n    vesselId: string;\n    vesselType: string;\n    mmsi?: string;\n    imo?: string;\n  };\n  location: {\n    latitude: number;\n    longitude: number;\n    heading?: number;\n    speed?: number;\n    timestamp: string;\n  };\n  status: 'Active' | 'Idle' | 'Anchored';\n}\n\ninterface TrackedVessel extends VesselTrackingData {\n  id: string;\n  lastUpdate: string;\n}\n\n// Store tracking data locally (in production, replace with actual backend API)\nconst TRACKING_STORAGE_KEY = '@marinetrack_vessel_tracking';\nconst TRACKED_VESSELS_KEY = '@marinetrack_tracked_vessels';\n\n// Send tracking data to backend\nexport const sendTrackingData = async (data: VesselTrackingData): Promise<boolean> => {\n  try {\n    // Store locally in AsyncStorage as backup\n    const AsyncStorage = (await import('@react-native-async-storage/async-storage')).default;\n    await AsyncStorage.setItem(TRACKING_STORAGE_KEY, JSON.stringify(data));\n\n    // Also store in local database for offline support\n    const { saveTrackingData } = await import('./database');\n    await saveTrackingData({\n      userId: data.userId,\n      vesselName: data.vesselInfo.vesselName,\n      location: {\n        latitude: data.location.latitude,\n        longitude: data.location.longitude,\n        speed: data.location.speed || 0,\n        heading: data.location.heading || 0,\n        timestamp: data.location.timestamp,\n      },\n      status: data.status,\n    });\n\n    // Send to backend server\n    const { getBackendUrl } = await import('../config');\n    const backendUrl = getBackendUrl();\n    \n    const response = await fetch(`${backendUrl}/api/tracking`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(data)\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Backend responded with status: ${response.status}`);\n    }\n\n    console.log('AIS Broadcasting:', data.vesselInfo.vesselName, 'at', data.location.latitude.toFixed(4), data.location.longitude.toFixed(4));\n    return true;\n  } catch (error) {\n    console.error('Error sending tracking data:', error);\n    // Return true anyway since we stored locally\n    return true;\n  }\n};\n\n// Get current tracking data\nexport const getTrackingData = async (): Promise<VesselTrackingData | null> => {\n  try {\n    const AsyncStorage = (await import('@react-native-async-storage/async-storage')).default;\n    const data = await AsyncStorage.getItem(TRACKING_STORAGE_KEY);\n    return data ? JSON.parse(data) : null;\n  } catch (error) {\n    console.error('Error getting tracking data:', error);\n    return null;\n  }\n};\n\n// Get nearby tracked vessels from backend server\nexport const getNearbyTrackedVessels = async (\n  userLat: number,\n  userLng: number,\n  radiusKm: number = 100 // Increased default radius to 100km for better detection\n): Promise<TrackedVessel[]> => {\n  try {\n    // Try to fetch from backend server first\n    const { getBackendUrl } = await import('../config');\n    const backendUrl = getBackendUrl();\n    \n    const response = await fetch(\n      `${backendUrl}/api/vessels/nearby?lat=${userLat}&lng=${userLng}&radius=${radiusKm}`,\n      {\n        method: 'GET',\n        headers: { 'Content-Type': 'application/json' },\n      }\n    );\n    \n    if (!response.ok) {\n      throw new Error(`Backend responded with status: ${response.status}`);\n    }\n    \n    const vessels = await response.json();\n    return vessels;\n  } catch (error) {\n    console.error('Error fetching nearby vessels from backend:', error);\n    \n    // Fallback to local database if backend is unavailable\n    try {\n      const { getAllTrackingData } = await import('./database');\n      const allVessels = await getAllTrackingData();\n\n      const nearby = allVessels.filter(vessel => {\n        const distance = calculateDistance(\n          userLat,\n          userLng,\n          vessel.location.latitude,\n          vessel.location.longitude\n        );\n        return distance <= radiusKm;\n      });\n\n      // Convert TrackingData to TrackedVessel format\n      return nearby.map(vessel => ({\n        id: vessel.userId,\n        userId: vessel.userId,\n        vesselInfo: {\n          vesselName: vessel.vesselName,\n          vesselId: vessel.userId,\n          vesselType: 'Vessel',\n        },\n        location: vessel.location,\n        status: vessel.status,\n        lastUpdate: vessel.location.timestamp,\n      }));\n    } catch (fallbackError) {\n      console.error('Error fetching from local database:', fallbackError);\n      return [];\n    }\n  }\n};\n\n// Calculate distance between two coordinates (Haversine formula)\nconst calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number): number => {\n  const R = 6371; // Earth's radius in km\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLon = (lon2 - lon1) * Math.PI / 180;\n  const a = \n    Math.sin(dLat/2) * Math.sin(dLat/2) +\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n    Math.sin(dLon/2) * Math.sin(dLon/2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n  return R * c;\n};\n\n// Start continuous tracking\nexport const startTracking = (\n  onLocationUpdate: (location: { latitude: number; longitude: number }) => void\n) => {\n  const Location = require('expo-location');\n\n  return Location.watchPositionAsync(\n    {\n      accuracy: Location.Accuracy.High,\n      timeInterval: 5000, // Update every 5 seconds\n      distanceInterval: 10, // Or when moved 10 meters\n    },\n    (location: any) => {\n      onLocationUpdate({\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude,\n      });\n    }\n  );\n};","size_bytes":5664},"app/auth/login.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  KeyboardAvoidingView,\n  Platform,\n  Alert,\n} from 'react-native';\nimport { useRouter } from 'expo-router';\nimport { useColorScheme } from '@/hooks/useColorScheme';\nimport { Colors } from '@/constants/Colors';\nimport { createGuestUser, storeUser, User } from '@/utils/auth';\nimport * as WebBrowser from 'expo-web-browser';\nimport * as Google from 'expo-auth-session/providers/google';\n\n// Import database service\nimport { saveUserToDatabase } from '@/utils/database';\n\nWebBrowser.maybeCompleteAuthSession();\n\nexport default function LoginScreen() {\n  const [loading, setLoading] = useState(false);\n  const colorScheme = useColorScheme();\n  const colors = Colors[colorScheme ?? 'light'];\n  const router = useRouter();\n\n  // Google Sign-In configuration with actual credentials\n  const GOOGLE_WEB_CLIENT_ID = '960630751878-tpdhcrjg031td64gt1r0ae59ht856en9.apps.googleusercontent.com';\n  const GOOGLE_ANDROID_CLIENT_ID = '960630751878-rmkfkc6pfjutt2qo9n5rguqjc96mncsk.apps.googleusercontent.com';\n\n  const [request, response, promptAsync] = Google.useAuthRequest({\n    webClientId: GOOGLE_WEB_CLIENT_ID,\n    androidClientId: GOOGLE_ANDROID_CLIENT_ID,\n  });\n\n  React.useEffect(() => {\n    if (response?.type === 'success') {\n      const { authentication } = response;\n      handleGoogleSignInSuccess(authentication);\n    }\n  }, [response]);\n\n  const handleGoogleSignInSuccess = async (authentication: any) => {\n    setLoading(true);\n    try {\n      // Fetch user info from Google\n      const userInfoResponse = await fetch(\n        'https://www.googleapis.com/userinfo/v2/me',\n        {\n          headers: { Authorization: `Bearer ${authentication.accessToken}` },\n        }\n      );\n      const userInfo = await userInfoResponse.json();\n\n      const user: User = {\n        id: `google_${userInfo.id}`,\n        email: userInfo.email,\n        name: userInfo.name,\n        photoUrl: userInfo.picture,\n        isGuest: false,\n        createdAt: new Date().toISOString()\n      };\n\n      // Store user in AsyncStorage and database\n      await storeUser(user);\n\n      await saveUserToDatabase({\n        id: user.id,\n        email: user.email,\n        name: user.name,\n        photoUrl: user.photoUrl,\n        isGuest: false,\n        createdAt: user.createdAt,\n        lastLogin: new Date().toISOString(),\n      });\n\n      setLoading(false);\n      router.replace('/(tabs)');\n    } catch (error) {\n      setLoading(false);\n      Alert.alert('Error', 'Failed to sign in with Google. Please try another method.');\n    }\n  };\n\n  const handleGoogleSignIn = async () => {\n    try {\n      setLoading(true);\n      await promptAsync();\n    } catch (error) {\n      setLoading(false);\n      Alert.alert('Error', 'Failed to initiate Google sign-in. Please try another method.');\n    }\n  };\n\n  const handleEmailPasswordSignIn = () => {\n    router.push('/auth/email-login');\n  };\n\n  const handleGuestMode = () => {\n    router.push('/auth/vessel-registration');\n  };\n\n  const handleRegister = () => {\n    router.push('/auth/register');\n  };\n\n  return (\n    <KeyboardAvoidingView\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n      style={[styles.container, { backgroundColor: colors.background }]}\n    >\n      <View style={styles.content}>\n        <Text style={styles.logo}>üåä</Text>\n        <Text style={[styles.title, { color: colors.primary }]}>MarineTrack</Text>\n        <Text style={[styles.subtitle, { color: colors.text }]}>\n          Your Safety Companion at Sea - Malaysia\n        </Text>\n\n        <View style={styles.form}>\n          <TouchableOpacity\n            style={[styles.googleButton, { backgroundColor: '#fff', borderColor: colors.border }]}\n            onPress={handleGoogleSignIn}\n            disabled={loading || !request}\n          >\n            <Text style={styles.googleIcon}>G</Text>\n            <Text style={[styles.googleButtonText, { color: '#000' }]}>\n              Continue with Google\n            </Text>\n          </TouchableOpacity>\n\n          <View style={styles.divider}>\n            <View style={[styles.dividerLine, { backgroundColor: colors.border }]} />\n            <Text style={[styles.dividerText, { color: colors.icon }]}>OR</Text>\n            <View style={[styles.dividerLine, { backgroundColor: colors.border }]} />\n          </View>\n\n          <TouchableOpacity\n            style={[styles.emailButton, { backgroundColor: colors.primary }]}\n            onPress={handleEmailPasswordSignIn}\n            disabled={loading}\n          >\n            <Text style={styles.emailButtonText}>Sign in with Email</Text>\n          </TouchableOpacity>\n\n          <TouchableOpacity\n            style={[styles.guestButton, { borderColor: colors.border }]}\n            onPress={handleGuestMode}\n            disabled={loading}\n          >\n            <Text style={[styles.guestButtonText, { color: colors.primary }]}>\n              Continue as Guest\n            </Text>\n          </TouchableOpacity>\n\n          <TouchableOpacity onPress={handleRegister} disabled={loading}>\n            <Text style={[styles.registerText, { color: colors.icon }]}>\n              Don't have an account? <Text style={{ color: colors.primary }}>Register</Text>\n            </Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  content: {\n    flex: 1,\n    justifyContent: 'center',\n    padding: 20,\n  },\n  logo: {\n    fontSize: 80,\n    textAlign: 'center',\n    marginBottom: 20,\n  },\n  title: {\n    fontSize: 36,\n    fontWeight: 'bold',\n    textAlign: 'center',\n    marginBottom: 8,\n  },\n  subtitle: {\n    fontSize: 16,\n    textAlign: 'center',\n    marginBottom: 40,\n  },\n  form: {\n    gap: 16,\n  },\n  googleButton: {\n    height: 56,\n    borderRadius: 12,\n    borderWidth: 1,\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    gap: 12,\n  },\n  googleIcon: {\n    fontSize: 24,\n    fontWeight: 'bold',\n  },\n  googleButtonText: {\n    fontSize: 16,\n    fontWeight: '600',\n  },\n  divider: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n    marginVertical: 8,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n  },\n  dividerText: {\n    fontSize: 14,\n    fontWeight: '600',\n  },\n  emailButton: {\n    height: 56,\n    borderRadius: 12,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  emailButtonText: {\n    color: '#fff',\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  guestButton: {\n    height: 56,\n    borderRadius: 12,\n    borderWidth: 2,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'transparent',\n  },\n  guestButtonText: {\n    fontSize: 16,\n    fontWeight: '600',\n  },\n  registerText: {\n    textAlign: 'center',\n    marginTop: 16,\n    fontSize: 14,\n  },\n});","size_bytes":6873},"app/index.tsx":{"content":"import { Redirect } from 'expo-router';\n\nexport default function Index() {\n  return <Redirect href=\"/onboarding\" />;\n}\n","size_bytes":119},"backend/server.js":{"content":"const express = require('express');\nconst cors = require('cors');\nconst http = require('http');\nconst { Server } = require('socket.io');\nconst fs = require('fs').promises;\nconst path = require('path');\n\nconst app = express();\nconst server = http.createServer(app);\nconst io = new Server(server, {\n  cors: {\n    origin: '*',\n    methods: ['GET', 'POST']\n  }\n});\n\nconst PORT = process.env.PORT || 3000;\nconst DATA_DIR = path.join(__dirname, 'data');\nconst VESSELS_FILE = path.join(DATA_DIR, 'vessels.json');\nconst USERS_FILE = path.join(DATA_DIR, 'users.json');\nconst MESSAGES_FILE = path.join(DATA_DIR, 'messages.json');\n\napp.use(cors());\napp.use(express.json());\n\n// Ensure data directory and files exist\nasync function ensureDataFiles() {\n  try {\n    await fs.mkdir(DATA_DIR, { recursive: true });\n    \n    // Initialize vessels file if it doesn't exist\n    try {\n      await fs.access(VESSELS_FILE);\n    } catch {\n      await fs.writeFile(VESSELS_FILE, JSON.stringify([], null, 2));\n    }\n    \n    // Initialize users file if it doesn't exist\n    try {\n      await fs.access(USERS_FILE);\n    } catch {\n      await fs.writeFile(USERS_FILE, JSON.stringify([], null, 2));\n    }\n    \n    // Initialize messages file if it doesn't exist\n    try {\n      await fs.access(MESSAGES_FILE);\n    } catch {\n      await fs.writeFile(MESSAGES_FILE, JSON.stringify([], null, 2));\n    }\n    \n    console.log('Data files initialized');\n  } catch (error) {\n    console.error('Error ensuring data files:', error);\n  }\n}\n\n// Read JSON file helper\nasync function readJsonFile(filePath) {\n  try {\n    const data = await fs.readFile(filePath, 'utf8');\n    return JSON.parse(data);\n  } catch (error) {\n    console.error(`Error reading ${filePath}:`, error);\n    return [];\n  }\n}\n\n// Write JSON file helper\nasync function writeJsonFile(filePath, data) {\n  try {\n    await fs.writeFile(filePath, JSON.stringify(data, null, 2));\n    return true;\n  } catch (error) {\n    console.error(`Error writing ${filePath}:`, error);\n    return false;\n  }\n}\n\n// API Routes\n\n// Health check\napp.get('/api/health', (req, res) => {\n  res.json({ status: 'ok', message: 'MarineTrack backend server running' });\n});\n\n// Get all vessels\napp.get('/api/vessels', async (req, res) => {\n  try {\n    const vessels = await readJsonFile(VESSELS_FILE);\n    res.json(vessels);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch vessels' });\n  }\n});\n\n// Get nearby vessels\napp.get('/api/vessels/nearby', async (req, res) => {\n  try {\n    const { lat, lng, radius = 100 } = req.query;\n    \n    if (!lat || !lng) {\n      return res.status(400).json({ error: 'Latitude and longitude required' });\n    }\n    \n    const vessels = await readJsonFile(VESSELS_FILE);\n    const userLat = parseFloat(lat);\n    const userLng = parseFloat(lng);\n    const radiusKm = parseFloat(radius);\n    \n    const nearbyVessels = vessels.filter(vessel => {\n      const distance = calculateDistance(\n        userLat,\n        userLng,\n        vessel.location.latitude,\n        vessel.location.longitude\n      );\n      return distance <= radiusKm;\n    });\n    \n    res.json(nearbyVessels);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch nearby vessels' });\n  }\n});\n\n// Save vessel tracking data\napp.post('/api/tracking', async (req, res) => {\n  try {\n    const trackingData = req.body;\n    \n    if (!trackingData.userId || !trackingData.vesselInfo || !trackingData.location) {\n      return res.status(400).json({ error: 'Invalid tracking data' });\n    }\n    \n    const vessels = await readJsonFile(VESSELS_FILE);\n    const existingIndex = vessels.findIndex(v => v.userId === trackingData.userId);\n    \n    const vesselData = {\n      id: trackingData.userId, // Add id field for frontend compatibility\n      ...trackingData,\n      lastUpdate: new Date().toISOString()\n    };\n    \n    if (existingIndex >= 0) {\n      vessels[existingIndex] = vesselData;\n    } else {\n      vessels.push(vesselData);\n    }\n    \n    await writeJsonFile(VESSELS_FILE, vessels);\n    \n    // Broadcast to all connected clients\n    io.emit('vessel_update', vesselData);\n    \n    res.json({ success: true, message: 'Tracking data saved' });\n  } catch (error) {\n    console.error('Error saving tracking data:', error);\n    res.status(500).json({ error: 'Failed to save tracking data' });\n  }\n});\n\n// Save user data\napp.post('/api/users', async (req, res) => {\n  try {\n    const userData = req.body;\n    \n    if (!userData.id) {\n      return res.status(400).json({ error: 'User ID required' });\n    }\n    \n    const users = await readJsonFile(USERS_FILE);\n    const existingIndex = users.findIndex(u => u.id === userData.id);\n    \n    if (existingIndex >= 0) {\n      users[existingIndex] = { ...userData, lastLogin: new Date().toISOString() };\n    } else {\n      users.push({ ...userData, createdAt: new Date().toISOString() });\n    }\n    \n    await writeJsonFile(USERS_FILE, users);\n    \n    res.json({ success: true, message: 'User data saved' });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to save user data' });\n  }\n});\n\n// Get messages\napp.get('/api/messages', async (req, res) => {\n  try {\n    const messages = await readJsonFile(MESSAGES_FILE);\n    res.json(messages);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch messages' });\n  }\n});\n\n// Save message\napp.post('/api/messages', async (req, res) => {\n  try {\n    const message = req.body;\n    const messages = await readJsonFile(MESSAGES_FILE);\n    \n    const newMessage = {\n      ...message,\n      id: Date.now().toString(),\n      timestamp: new Date().toISOString()\n    };\n    \n    messages.push(newMessage);\n    await writeJsonFile(MESSAGES_FILE, messages);\n    \n    // Broadcast to all connected clients\n    io.emit('new_message', newMessage);\n    \n    res.json({ success: true, message: newMessage });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to save message' });\n  }\n});\n\n// Calculate distance helper (Haversine formula)\nfunction calculateDistance(lat1, lon1, lat2, lon2) {\n  const R = 6371; // Earth's radius in km\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLon = (lon2 - lon1) * Math.PI / 180;\n  const a = \n    Math.sin(dLat/2) * Math.sin(dLat/2) +\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n    Math.sin(dLon/2) * Math.sin(dLon/2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n  return R * c;\n}\n\n// Socket.IO connection handling\nio.on('connection', (socket) => {\n  console.log('Client connected:', socket.id);\n  \n  socket.on('vessel_location', async (data) => {\n    try {\n      // Save vessel location\n      const vessels = await readJsonFile(VESSELS_FILE);\n      const existingIndex = vessels.findIndex(v => v.userId === data.userId);\n      \n      const vesselData = {\n        id: data.userId, // Add id field for frontend compatibility\n        ...data,\n        lastUpdate: new Date().toISOString()\n      };\n      \n      if (existingIndex >= 0) {\n        vessels[existingIndex] = vesselData;\n      } else {\n        vessels.push(vesselData);\n      }\n      \n      await writeJsonFile(VESSELS_FILE, vessels);\n      \n      // Broadcast to all other clients\n      socket.broadcast.emit('vessel_update', vesselData);\n    } catch (error) {\n      console.error('Error handling vessel location:', error);\n    }\n  });\n  \n  socket.on('chat_message', async (data) => {\n    try {\n      const messages = await readJsonFile(MESSAGES_FILE);\n      const newMessage = {\n        ...data,\n        id: Date.now().toString(),\n        timestamp: new Date().toISOString()\n      };\n      \n      messages.push(newMessage);\n      await writeJsonFile(MESSAGES_FILE, messages);\n      \n      // Broadcast to all clients\n      io.emit('new_message', newMessage);\n    } catch (error) {\n      console.error('Error handling chat message:', error);\n    }\n  });\n  \n  socket.on('disconnect', () => {\n    console.log('Client disconnected:', socket.id);\n  });\n});\n\n// Start server\nasync function startServer() {\n  await ensureDataFiles();\n  \n  server.listen(PORT, '0.0.0.0', () => {\n    console.log(`MarineTrack backend server running on port ${PORT}`);\n    console.log(`Health check: http://localhost:${PORT}/api/health`);\n    console.log(`Data directory: ${DATA_DIR}`);\n  });\n}\n\nstartServer();\n","size_bytes":8275},".local/state/replit/agent/progress_tracker.md":{"content":"[x] 1. Install the required packages - Completed: Installed all npm dependencies successfully\n[x] 2. Restart the workflow to see if the project is working - Completed: Workflow is running successfully on port 5000\n[x] 3. Verify the project is working using the screenshot tool - Completed: App loads correctly showing \"Track Your Vessel\" onboarding screen\n[x] 4. Inform user the import is completed and they can start building, mark the import as completed using the complete_project_import tool - Completed\n[x] 5. Create backend server with JSON storage for vessel tracking - Completed: Backend running on port 3000\n[x] 6. Fix vessel data storage issue and enable multi-device tracking - Completed: Vessels now share data through backend server","size_bytes":745},"backend/README.md":{"content":"# MarineTrack Backend Server\n\nThis is the backend server for the MarineTrack application. It stores vessel tracking data in JSON files and provides real-time updates via Socket.IO.\n\n## Features\n\n- **JSON File Storage**: All data is stored in local JSON files (not in Replit database)\n- **RESTful API**: Endpoints for saving and retrieving vessel data\n- **Socket.IO**: Real-time vessel location and chat updates\n- **Cross-Device Support**: Multiple devices can connect and share vessel data\n\n## Data Storage\n\nAll data is stored in the `backend/data/` directory:\n- `vessels.json` - Vessel tracking data\n- `users.json` - User account data\n- `messages.json` - Chat messages\n\n## API Endpoints\n\n### Health Check\n```\nGET /api/health\n```\n\n### Get All Vessels\n```\nGET /api/vessels\n```\n\n### Get Nearby Vessels\n```\nGET /api/vessels/nearby?lat={latitude}&lng={longitude}&radius={radiusKm}\n```\n\n### Save Vessel Tracking Data\n```\nPOST /api/tracking\nBody: {\n  userId: string,\n  vesselInfo: { vesselName, vesselId, vesselType },\n  location: { latitude, longitude, heading, speed, timestamp },\n  status: 'Active' | 'Idle' | 'Anchored'\n}\n```\n\n### Save User Data\n```\nPOST /api/users\nBody: { id, email, name, ... }\n```\n\n### Get Messages\n```\nGET /api/messages\n```\n\n### Save Message\n```\nPOST /api/messages\nBody: { userId, userName, message, ... }\n```\n\n## Socket.IO Events\n\n### Client to Server\n- `vessel_location` - Send vessel location update\n- `chat_message` - Send chat message\n\n### Server to Client\n- `vessel_update` - Receive vessel location update\n- `new_message` - Receive new chat message\n\n## Running Locally\n\n1. **Start the backend server**:\n   ```bash\n   cd backend\n   npm start\n   ```\n   The server will run on port 3000 by default.\n\n2. **Find your local IP address**:\n   - Windows: `ipconfig`\n   - Mac/Linux: `ifconfig` or `ip addr show`\n   Look for your local IP (e.g., 192.168.1.100)\n\n3. **Update the frontend configuration**:\n   Edit `config.ts` in the root directory and set:\n   ```typescript\n   BACKEND_URL: 'http://YOUR_LOCAL_IP:3000',\n   SOCKET_URL: 'http://YOUR_LOCAL_IP:3000',\n   ```\n   For example:\n   ```typescript\n   BACKEND_URL: 'http://192.168.1.100:3000',\n   SOCKET_URL: 'http://192.168.1.100:3000',\n   ```\n\n4. **Connect your devices**:\n   - Make sure your PC and mobile devices are on the same WiFi network\n   - Start the backend server on your PC\n   - Run the Expo app on your mobile devices\n   - The devices will now share vessel data through the backend server\n\n## Environment Variables\n\nYou can configure the backend using environment variables:\n- `PORT` - Server port (default: 3000)\n- `EXPO_PUBLIC_BACKEND_URL` - Frontend backend URL\n- `EXPO_PUBLIC_SOCKET_URL` - Frontend socket URL\n\n## Testing\n\nTo test if the backend is working:\n\n1. Open your browser and go to: `http://localhost:3000/api/health`\n   You should see: `{\"status\":\"ok\",\"message\":\"MarineTrack backend server running\"}`\n\n2. Check the data files in `backend/data/` directory after using the app\n\n## Troubleshooting\n\n### \"Network request failed\" error\n- Make sure the backend server is running\n- Verify your local IP address is correct in `config.ts`\n- Ensure your firewall allows connections on port 3000\n- Check that all devices are on the same WiFi network\n\n### No vessels appearing\n- Check if vessel data is being saved in `backend/data/vessels.json`\n- Verify the backend server logs for any errors\n- Make sure location permissions are granted on mobile devices\n\n### Chat not working\n- Check `backend/data/messages.json` for saved messages\n- Verify Socket.IO connection in browser console\n- Ensure the socket URL matches your backend URL\n","size_bytes":3615},"config.ts":{"content":"// Backend API Configuration\n// Update this with your actual backend server URL when running\nexport const API_CONFIG = {\n  // For local development on physical device, use your computer's local IP address\n  // Example: 'http://192.168.1.100:3000'\n  // For Android emulator, use: 'http://10.0.2.2:3000'\n  // For iOS simulator, use: 'http://localhost:3000'\n  BACKEND_URL: process.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:3000',\n  \n  // Socket.IO URL (usually same as backend URL)\n  SOCKET_URL: process.env.EXPO_PUBLIC_SOCKET_URL || 'http://localhost:3000',\n};\n\n// Helper function to get the correct backend URL\nexport function getBackendUrl(): string {\n  return API_CONFIG.BACKEND_URL;\n}\n\nexport function getSocketUrl(): string {\n  return API_CONFIG.SOCKET_URL;\n}\n","size_bytes":770},"SETUP_INSTRUCTIONS.md":{"content":"# MarineTrack Setup Instructions for Local Network\n\n## Quick Start Guide\n\nYour MarineTrack app is now configured with a backend server that stores vessel data in JSON files. Follow these steps to run the app on multiple devices connected to the same WiFi network.\n\n## Step 1: Find Your Computer's Local IP Address\n\n### On Windows:\n1. Open Command Prompt\n2. Type: `ipconfig`\n3. Look for \"IPv4 Address\" under your WiFi adapter (usually looks like `192.168.1.100`)\n\n### On Mac:\n1. Open Terminal\n2. Type: `ifconfig` or `ip addr show`\n3. Look for your local IP address (usually starts with `192.168.` or `10.0.`)\n\n### On Linux:\n1. Open Terminal\n2. Type: `hostname -I` or `ip addr show`\n3. Look for your local IP address\n\n**Example IP:** `192.168.1.100` (your actual IP will be different)\n\n## Step 2: Update the Backend Configuration\n\n1. Open the file `config.ts` in the root directory of this project\n2. Replace `localhost` with your actual local IP address:\n\n```typescript\nexport const API_CONFIG = {\n  BACKEND_URL: 'http://YOUR_LOCAL_IP:3000',  // Replace YOUR_LOCAL_IP\n  SOCKET_URL: 'http://YOUR_LOCAL_IP:3000',   // Replace YOUR_LOCAL_IP\n};\n```\n\n**Example:**\n```typescript\nexport const API_CONFIG = {\n  BACKEND_URL: 'http://192.168.1.100:3000',\n  SOCKET_URL: 'http://192.168.1.100:3000',\n};\n```\n\n## Step 3: Start the Backend Server\n\nThe backend server should already be running in Replit. If not, start it manually:\n\n```bash\ncd backend\nnpm start\n```\n\nYou should see:\n```\nMarineTrack backend server running on port 3000\n```\n\n## Step 4: Run the App on Your Devices\n\n### For Android Devices:\n1. Make sure your device is connected to the same WiFi network as your computer\n2. Open Expo Go app on your device\n3. Scan the QR code from the Expo development server\n4. The app will load and connect to the backend server\n\n### For iOS Devices:\n1. Make sure your device is connected to the same WiFi network as your computer\n2. Open the Camera app\n3. Scan the QR code from the Expo development server\n4. The app will load and connect to the backend server\n\n## Step 5: Test Vessel Tracking\n\n1. **On Device 1:**\n   - Sign in or continue as guest\n   - Complete the onboarding\n   - Enter vessel information\n   - Allow location permissions\n   - Start tracking your vessel\n\n2. **On Device 2:**\n   - Sign in or continue as guest\n   - Complete the onboarding\n   - Enter a different vessel name\n   - Allow location permissions\n   - Start tracking\n\n3. **Check if vessels appear:**\n   - Both devices should now see each other's vessels on the map\n   - The vessels should appear in the \"Nearby Vessels\" list\n   - Real-time location updates should be reflected on both devices\n\n## Data Storage Location\n\nAll vessel data is stored in JSON files at:\n```\nbackend/data/vessels.json    - Vessel tracking data\nbackend/data/users.json      - User information\nbackend/data/messages.json   - Chat messages\n```\n\nYou can view these files to see the stored data.\n\n## Troubleshooting\n\n### Issue: \"Network request failed\" error\n\n**Solutions:**\n1. ‚úÖ Verify the backend server is running (check Replit console)\n2. ‚úÖ Confirm your IP address in `config.ts` is correct\n3. ‚úÖ Make sure all devices are on the same WiFi network\n4. ‚úÖ Check your firewall allows connections on port 3000\n5. ‚úÖ Try pinging your computer from your mobile device\n\n### Issue: No vessels appearing on the map\n\n**Solutions:**\n1. ‚úÖ Check `backend/data/vessels.json` to see if data is being saved\n2. ‚úÖ Verify location permissions are granted on your device\n3. ‚úÖ Make sure you've started tracking on at least one device\n4. ‚úÖ Check the console logs for any errors\n5. ‚úÖ Ensure the backend URL in `config.ts` is correct\n\n### Issue: Devices can't connect to backend\n\n**Solutions:**\n1. ‚úÖ Make sure you're using your local IP, not `localhost`\n2. ‚úÖ Verify your WiFi network allows device-to-device communication\n3. ‚úÖ Try accessing `http://YOUR_IP:3000/api/health` from your phone's browser\n4. ‚úÖ Disable any VPN or network isolation features on your router\n\n### Issue: Chat messages not appearing\n\n**Solutions:**\n1. ‚úÖ Check `backend/data/messages.json` to see if messages are being saved\n2. ‚úÖ Verify Socket.IO is connecting properly (check console logs)\n3. ‚úÖ Ensure the socket URL in `config.ts` matches your backend URL\n\n## Testing the Backend\n\nYou can test the backend API directly:\n\n1. **Health Check** (from any browser):\n   ```\n   http://YOUR_LOCAL_IP:3000/api/health\n   ```\n   Should return: `{\"status\":\"ok\",\"message\":\"MarineTrack backend server running\"}`\n\n2. **View All Vessels**:\n   ```\n   http://YOUR_LOCAL_IP:3000/api/vessels\n   ```\n\n3. **View Nearby Vessels**:\n   ```\n   http://YOUR_LOCAL_IP:3000/api/vessels/nearby?lat=40.7128&lng=-74.0060&radius=100\n   ```\n\n## Recording Video\n\nWhen recording your demo video:\n1. Start the backend server on your PC\n2. Connect at least 2 devices to the same WiFi\n3. Show vessel tracking working between devices\n4. Demonstrate the real-time chat feature\n5. Show the vessels appearing on the map\n\n## Port Configuration\n\n- **Backend Server:** Port 3000\n- **Expo Dev Server:** Port 5000 (for web preview)\n- **Metro Bundler:** Automatically assigned\n\n## Next Steps\n\nOnce everything is working:\n1. The vessel data is automatically saved to JSON files\n2. Multiple devices can see each other's locations\n3. Chat messages are shared between all connected devices\n4. All data persists even after restarting the backend server\n\nGood luck with your video recording! üö¢\n","size_bytes":5456}},"version":2}